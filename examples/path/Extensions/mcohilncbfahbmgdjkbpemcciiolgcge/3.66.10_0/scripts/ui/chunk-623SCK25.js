import{a as d}from"./chunk-STU536TK.js";import{ta as P,va as H}from"./chunk-QRHYK2TW.js";import{k as D,l as tt}from"./chunk-ZDOH3CEJ.js";import{c as F,e as et}from"./chunk-AS4Z3FNS.js";import{H as V,R as p,ra as X}from"./chunk-CYTB2B6Q.js";import{a as Z}from"./chunk-2EEW2VNF.js";import{f as Q,o as s,q as a}from"./chunk-SHG7TIBL.js";s();a();X();et();var j="txHistoryRejectValues",rt={hideValuelessNft:"hideValuelessNft"},ut={NORMAL:0,RISKY:1,VALUELESS:2},M={[rt.hideValuelessNft]:!0},E=async()=>{try{return await F().getSelectedWallet()}catch{return null}},G=()=>{try{let t=localStorage.getItem(j);return t?JSON.parse(t)??{}??{}:{}}catch{return{}}},N=(t={})=>{try{let e=JSON.stringify(t);return localStorage.setItem(j,e),!0}catch{return!1}},dt=async(t,e)=>{try{let r=await E();if(!r)return!1;let o=G(),i={[r]:{[t]:e}};return N(p({},o,i))}catch{return!1}},C=async()=>{let t=await E();if(!t)return{};let e=G(),r=e?.[t]??{};if(V(r)){let o={[t]:M};return N(p({},e,o)),M}return r};s();a();var K=Q(Z());s();a();s();a();tt();s();a();function ot(t){return async(e,r)=>{await e(A({...t,dates:d().stringDates})),await e(f(!0));let o=r();e(y(O(o)))}}var n=D({name:"txHistory",initialState:{filters:{dates:d().stringDates,chainId:"",groupType:0,coinId:void 0},txList:[],txGroupList:[],initLoading:!0,scrollLoading:!1,filterLoading:!1,lastRowId:"",historyPageSearchValue:""},reducers:{setHistoryPageSearchValue:(t,e)=>{t.historyPageSearchValue=e.payload},setInitLoading:(t,e)=>{t.initLoading=e.payload},setScrollLoading:(t,e)=>{t.scrollLoading=e.payload},setFilterLoading:(t,e)=>{t.filterLoading=e.payload},setFilters:(t,e)=>{t.filters={...t.filters,...e.payload,init:!1}},setLastRowId:(t,e)=>{t.lastRowId=e.payload},setTxList:(t,e)=>{t.txList=e.payload},setTxGroupList:(t,e)=>{t.txGroupList=e.payload},mergeTxList:(t,e)=>{t.txList=[...t.txList,...e.payload]},resetFilters(t){t.filters={dates:d().stringDates,chainId:"",groupType:0,coinId:void 0}},resetTxHistory:t=>{t.txList=[],t.initLoading=!1,t.scrollLoading=!1,t.filterLoading=!1,t.lastRowId="",t.historyPageSearchValue=""}}}),{actions:st,reducer:at}=n,St=at,Rt=t=>t[n.name].txList,it=t=>t[n.name].filters,Vt=t=>t[n.name].txGroupList,O=t=>{let e=it(t),{dates:[r,o],chainId:i,groupType:l,coinId:c}=e;return{startTime:new Date(`${r} 00:00:00`).getTime(),endTime:new Date(`${o} 23:59:59`).getTime(),chainId:i,groupType:l,coinId:c}},W=t=>t[n.name].initLoading,v=t=>t[n.name].scrollLoading,k=t=>t[n.name].lastRowId,Dt=t=>t[n.name].filterLoading,Ft=t=>t[n.name].historyPageSearchValue,{setFilters:A,setTxList:I,mergeTxList:w,setInitLoading:T,setScrollLoading:L,setFilterLoading:f,resetTxHistory:Pt,setLastRowId:h,resetFilters:Ht,setTxGroupList:Mt,setHistoryPageSearchValue:jt}=st;var q=({scrollLoad:t,lastRowId:e,scrollLoading:r,initLoading:o})=>!(t&&(!e||r||o)),J=async(t,{reqParams:e,lastRowId:r,scrollLoad:o,fromCoinDetail:i})=>{if(o&&(t(L(!0)),e.lastRowId=r),!i)try{let l=await C();e.hideRisk=l?.hideValuelessNft??!0}catch{}return e};var y=(t,e={initLoad:!1,scrollLoad:!1,autoRefresh:!1,fromCoinDetail:!1,hasMoreData:!0,hasInitData:!0})=>async(r,o)=>{let i={...t},{initLoad:l,scrollLoad:c,fromCoinDetail:S,hasMoreData:Y,hasInitData:$}=e,B=S?H:P,m=o(),R=k(m),U=W(m),_=v(m);if(!(!Y&&$||!q({scrollLoad:c,lastRowId:R,scrollLoading:_,initLoading:U}))){l&&(r(T(!0)),r(h(""))),await J(r,{reqParams:i,lastRowId:R,scrollLoad:c,fromCoinDetail:S});try{let x=await B(i),u=x?.content;(0,K.isEmpty)(u)&&(u=[]),r(c?w(u):I(u));let b=u.length,z=x.hasViewMore?u[b-1]?.rowId:"";r(h(z))}catch{r(c?w([]):I([]))}l&&r(T(!1)),c&&r(L(!1)),r(f(!1))}};export{rt as a,ut as b,dt as c,C as d,y as e,ot as f,St as g,Rt as h,it as i,Vt as j,O as k,W as l,v as m,k as n,Dt as o,Ft as p,A as q,I as r,T as s,Pt as t,h as u,Ht as v,Mt as w,jt as x};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-623SCK25.js.map
