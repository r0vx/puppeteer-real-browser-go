import{a as In}from"./chunk-6SVTIGKW.js";import{a as gn}from"./chunk-J6QJFZTY.js";import{a as Tn}from"./chunk-7DDBBEVP.js";import{a as yn}from"./chunk-RF6MZE6O.js";import{a as Cn}from"./chunk-ECC5IHEE.js";import{a as mn}from"./chunk-WWBMCUD5.js";import{i as pn,j as un,k as dn,l as fn,m as _n,n as xn}from"./chunk-OREEKEEP.js";import"./chunk-MXXOWCRN.js";import"./chunk-WBTR3RX4.js";import"./chunk-UYHZVWJV.js";import{a as Ue,b as We}from"./chunk-Q5M243XX.js";import{a as zt}from"./chunk-JRNVHROF.js";import{a as De}from"./chunk-JIT4MLY3.js";import{a as ln}from"./chunk-A4QA4J4S.js";import"./chunk-W6JKZXLB.js";import{a as cn}from"./chunk-W3MRBSTV.js";import"./chunk-HPJHY2AY.js";import"./chunk-CK7Z2DAQ.js";import{a as an}from"./chunk-OQZ6UOCK.js";import"./chunk-IFQLVQH6.js";import"./chunk-5TLDWKXV.js";import{a as de}from"./chunk-7GRDW7ZD.js";import{a as Oe,b as ve}from"./chunk-OMNHCLSU.js";import"./chunk-HY7LAUD2.js";import"./chunk-C6HPT3PU.js";import"./chunk-ZZH7FUZX.js";import{b as $t,g as Le,i as tn,j as en,k as Fe,m as Me,p as on,q as nn,r as rn}from"./chunk-CQWP5UAS.js";import"./chunk-Y6T5M4AD.js";import{a as Pe}from"./chunk-UWCOP3B7.js";import"./chunk-6DUYAS7R.js";import"./chunk-NLKYL456.js";import"./chunk-CEM2RCMY.js";import{a as q,b as ue,c as no,d as H}from"./chunk-7X4DXTSI.js";import{a as pe}from"./chunk-LURPYTXM.js";import"./chunk-OADPFYBO.js";import{a as et}from"./chunk-CIEH2J25.js";import{a as sn,b as Vt}from"./chunk-64LKONIY.js";import"./chunk-VVJ6BK3Q.js";import"./chunk-FUVVPSUI.js";import{B as Qo,a as Ko,l as Y,o as Jo}from"./chunk-NKIUEXOA.js";import"./chunk-EP23RRSK.js";import"./chunk-4YDY4B6P.js";import"./chunk-CGFS6AE4.js";import"./chunk-DDT324RS.js";import"./chunk-2TQXMDYZ.js";import"./chunk-RNMISV22.js";import"./chunk-A267SEFJ.js";import"./chunk-VR7OPIR6.js";import"./chunk-HBWTVKRO.js";import{a as me}from"./chunk-4ZGOJDNI.js";import"./chunk-ZPQXBUKT.js";import"./chunk-35Y7QMWN.js";import"./chunk-VIT5MDY4.js";import"./chunk-RH6WPBEZ.js";import"./chunk-CDNJY7Z3.js";import"./chunk-DBWXHHZT.js";import"./chunk-VVKAQ7K5.js";import{d as Gt,g as jo}from"./chunk-7JSJY3SQ.js";import{c as xt}from"./chunk-NWY3GPDX.js";import"./chunk-6JEFG7DQ.js";import"./chunk-B6YXJZUF.js";import"./chunk-4I2JSOYJ.js";import"./chunk-GTN3RCGH.js";import"./chunk-3VKPY2QL.js";import"./chunk-AOSRFQ4E.js";import"./chunk-ULL77AIR.js";import"./chunk-PJYSMRRW.js";import"./chunk-GKQQDLVP.js";import"./chunk-7YKP5374.js";import"./chunk-KGG7DXMS.js";import"./chunk-FGIHS4ZF.js";import"./chunk-U65R4NF3.js";import"./chunk-OTUJWRS5.js";import"./chunk-WIW5JVRP.js";import"./chunk-7CXUJS4C.js";import"./chunk-ULXZERAJ.js";import"./chunk-PJ5X5CUU.js";import"./chunk-TSVRDRPO.js";import"./chunk-PPTAKQQT.js";import"./chunk-IFQDHP3Z.js";import"./chunk-DA5RJYYW.js";import"./chunk-HUC3JPS2.js";import"./chunk-MYNDXPHU.js";import"./chunk-ZTIVM5ML.js";import"./chunk-2E2OBQTS.js";import"./chunk-VICEBZ4G.js";import"./chunk-WO6OHGU2.js";import"./chunk-3S4BGA37.js";import"./chunk-POP3LIKS.js";import"./chunk-PMRTKWFS.js";import"./chunk-G44PPNNQ.js";import"./chunk-K2BSCLBF.js";import"./chunk-PZY7HRHV.js";import"./chunk-Z2L2F5M5.js";import"./chunk-IPLOJJIA.js";import"./chunk-RLPRDJ34.js";import"./chunk-2ASICJQL.js";import"./chunk-TQWSBAXG.js";import"./chunk-6JVCYB7O.js";import"./chunk-GR42TVIZ.js";import"./chunk-QMSSDBOR.js";import"./chunk-5RCFYEZ6.js";import"./chunk-XIHJL4UW.js";import{b as Zo}from"./chunk-NPQMAAOH.js";import{b as Ct}from"./chunk-B3SXRDEQ.js";import"./chunk-7HRNNJBX.js";import"./chunk-F6UVHIJV.js";import{S as oo}from"./chunk-ZLJJZYPU.js";import"./chunk-5TNLDTW5.js";import"./chunk-H5EE6AS6.js";import"./chunk-34JXWTF5.js";import{f as Ho}from"./chunk-JSOLAK4X.js";import{h as tt,i as ct}from"./chunk-R7LZSAVU.js";import"./chunk-LTLRDXME.js";import"./chunk-RMI6BAM3.js";import"./chunk-AADHEW4J.js";import"./chunk-OK4242CI.js";import"./chunk-6MVL4I6V.js";import"./chunk-E7MGN3V4.js";import"./chunk-YGIVEMKT.js";import"./chunk-T4RFDN7D.js";import"./chunk-NQAVUB4Q.js";import"./chunk-IEGAVAV7.js";import"./chunk-V4P2E4SN.js";import"./chunk-DYL77QBO.js";import{e as $o}from"./chunk-5A3RJQCM.js";import"./chunk-73HPZW2B.js";import"./chunk-MN3UHDTX.js";import"./chunk-IJW6HFV5.js";import"./chunk-N2MMFEEK.js";import"./chunk-MKDQBVRZ.js";import{a as Vo}from"./chunk-DA2FCNEZ.js";import"./chunk-TLZRRG7J.js";import"./chunk-ZFFAX2YS.js";import"./chunk-7UDMBSMI.js";import"./chunk-7C7MBE2C.js";import"./chunk-KJWX5V23.js";import"./chunk-KDVER5QK.js";import"./chunk-5CHE7P4E.js";import"./chunk-PD44C7EF.js";import"./chunk-6K6UF6OE.js";import"./chunk-OKXHAJNT.js";import"./chunk-CBHKW7LL.js";import"./chunk-67F2WFQO.js";import"./chunk-QYDRYMWS.js";import{l as le,m as ce}from"./chunk-AZNX5TUC.js";import"./chunk-JU4HVVJ2.js";import"./chunk-NKWTNXAD.js";import"./chunk-XZE3C5KK.js";import"./chunk-XZE3L7K7.js";import{a as Rt}from"./chunk-Y5K5NJ6U.js";import"./chunk-UR7XESQE.js";import"./chunk-JABAEAEN.js";import"./chunk-VY2VK2OT.js";import{a as ae}from"./chunk-Q7FGM7BT.js";import{b as st}from"./chunk-TKE74ERX.js";import"./chunk-MONRGJFN.js";import"./chunk-RYT7JDQV.js";import"./chunk-CZZFLX67.js";import"./chunk-IK72BO4I.js";import{a as Go}from"./chunk-QMENNGDH.js";import"./chunk-KANXVZ35.js";import{f as Xo,r as w}from"./chunk-WGVA2GGS.js";import{a as yr}from"./chunk-APGT6UVG.js";import"./chunk-V34MB2FG.js";import{o as Yt}from"./chunk-XP3TNE3R.js";import{$ as Uo,A as ke,C as vo,D as Do,jc as ie,z as Qe}from"./chunk-QRHYK2TW.js";import"./chunk-PODZSVO7.js";import"./chunk-QO4JMOUQ.js";import{a as qo}from"./chunk-7N263AYH.js";import{a as zo}from"./chunk-532YJKK4.js";import{j as rt,p as se}from"./chunk-Q4YLD24R.js";import"./chunk-K5ZGZULR.js";import"./chunk-M6J3OOFH.js";import"./chunk-ZDOH3CEJ.js";import{c as Wo,e as gr}from"./chunk-AS4Z3FNS.js";import"./chunk-KW2XDOEY.js";import"./chunk-2FDQIA7D.js";import"./chunk-L524QXHA.js";import"./chunk-ZFTHPYIG.js";import"./chunk-N6DAHVYW.js";import{e as Yo,g as Ro}from"./chunk-YCFHPQAJ.js";import{I as Q,W as Oo,_ as Wt,c as U,d as Fo,j as Mo,ja as Bt}from"./chunk-4EIUGT5A.js";import"./chunk-7FRDKLRJ.js";import"./chunk-P7VKC6DQ.js";import"./chunk-D7FW64MN.js";import"./chunk-6ZZOO2CD.js";import"./chunk-JPTLCZ2Y.js";import"./chunk-COS5CL3D.js";import"./chunk-VL2YBSHB.js";import{d as eo}from"./chunk-AVC4ODUV.js";import"./chunk-RJ3YTAFM.js";import"./chunk-OCAFSBNZ.js";import{c as u}from"./chunk-62ZAND24.js";import{a as to}from"./chunk-SIITVWZR.js";import{Ab as Eo,J as je,Jb as xr,Ma as No,Na as _r,Pd as Tr,Va as So,_d as Zt,ed as be,ia as fr,id as Ut,ie as Bo,jd as Nt,ke as ko,le as Po,md as Ao,me as Lo,od as re,oe as Be,qd as bo}from"./chunk-QHXUL3YM.js";import{H as nt,n as E,y as i}from"./chunk-MOTAOJVG.js";import"./chunk-FYTT4U7M.js";import{G as Co,H as Io,P as Je,Q as wo,Y as ho,d as Ht,e as To,o as ne,p as Ke,y as yo}from"./chunk-XR4SQWL7.js";import"./chunk-NCGYY6X6.js";import"./chunk-LMBQGBLO.js";import"./chunk-QWIXUG3W.js";import"./chunk-Z3JMRMVO.js";import"./chunk-CYTB2B6Q.js";import"./chunk-CAFKDDXA.js";import"./chunk-CTOTVO2J.js";import"./chunk-T2ETCKOI.js";import"./chunk-6P63CWAB.js";import"./chunk-RJPAKY6O.js";import"./chunk-ZCK5UHUS.js";import"./chunk-ANUO2YYF.js";import{aa as xo,fa as go,ka as lt}from"./chunk-6M3PZK2X.js";import"./chunk-TPIKSUHH.js";import{b as D}from"./chunk-OL67KS7C.js";import"./chunk-TVBFJITU.js";import"./chunk-D2YP6KBJ.js";import"./chunk-2EEW2VNF.js";import"./chunk-TLR6EQX6.js";import"./chunk-S5ACFHVS.js";import"./chunk-FQLRWF7X.js";import"./chunk-NLMDM2WF.js";import"./chunk-BJAL3374.js";import"./chunk-KDUIZVRC.js";import"./chunk-VYKQ62AB.js";import"./chunk-263G66VF.js";import"./chunk-SUANL2KV.js";import"./chunk-KTFU3F6C.js";import"./chunk-2OVRHWIW.js";import"./chunk-32ZJ4F2J.js";import"./chunk-WIP2REO7.js";import"./chunk-JBHIVXO6.js";import"./chunk-LECESFCD.js";import"./chunk-NW4HKKTQ.js";import"./chunk-EBMX24YQ.js";import"./chunk-3C4MEE67.js";import"./chunk-R4BHRBC7.js";import{f as x,o as a,p as C,q as l}from"./chunk-SHG7TIBL.js";a();l();var Lt=x(D());a();l();var Ye=x(D());nt();a();l();var wn=({unapproved:t})=>Ye.default.createElement(u.Container,null,Ye.default.createElement(Rt,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),Ye.default.createElement(mn,{unapproved:t}));a();l();var h=x(D()),hn=x(ie()),Re=x(Yt());nt();gr();se();Be();re();var Cr=({unapproved:t})=>{let e=t?.localType,o=t?.method,r=xt({localType:e})?.coinId;r===void 0&&(r=Nt(e));let s=Gt(r),c=(0,hn.useDispatch)(),f=t.walletId,_=t.params.transaction.from,M=ce(f),T=t.params.transaction.amount||2,[,S]=Pe({coinId:r,address:_,chainId:s?.chainId}),m=S?.transferReminder,d=S?.dummyOutput,[g,O]=(0,h.useState)({level:Wt.STANDARD,satBytes:S?.normal}),B=g?.satBytes;(0,h.useEffect)(()=>{if(!B&&S?.normal&&O({level:Wt.STANDARD,satBytes:S?.normal}),B&&g?.level!==Wt.CUSTOM){let J=S[Oe[g?.level]?.satBytes];O({...g,satBytes:J})}},[S]);let[P,{toggle:L}]=(0,Re.useBoolean)(!1),[F,{set:I}]=(0,Re.useBoolean)(!1),[b,{set:G}]=(0,Re.useBoolean)(!1),[z,pt]=(0,h.useState)(),[$,N]=Fe({coinId:r,walletId:f,address:_,batchDummyNum:T,utxoType:$t.SPLIT_UTXO}),[X,W,St]=en({coinId:r,walletId:f,address:_,networkFee:z,utxoType:$t.SPLIT_UTXO,batchDummyNum:T,coinAmount:E.mul(d,T)},{ready:!!d}),yt=(0,h.useMemo)(()=>W.findIndex(({dummy:J})=>J!==!0),[W]),ut=(0,h.useMemo)(()=>yt===-1?[]:W.slice(yt),[yt,W]),it=(0,h.useMemo)(()=>yt===-1?0:Math.max(T-yt,0),[T,yt]),Ft=E.gt(it,0),Kt=E.mul(d,it),V=on({coinId:r,fromAddr:_,satBytes:B}),at=(0,h.useCallback)(async()=>{try{if(!B)return;I(!0);let J=await V({inputs:ut,outputs:Array.from({length:it}).map(()=>({address:_,amount:d}))});G(!1),pt(J)}catch{G(!0)}finally{I(!1)}},[d,V,_,ut,it,B,G,I]);(0,h.useEffect)(()=>{at()},[at]);let Et=(0,h.useMemo)(()=>N===void 0||!z?!0:E.gt(N,z),[N,z]),Jt=le(f),[wt,ht]=(0,h.useState)(!1),Mt=(0,h.useCallback)(async()=>{await c(tt(t.id)),await c(Ct()),await rt(c),ht(!1)},[c,t.id]),{addressCheckError:ot,addressCheckLoading:Ot}=zt({chainIndex:s?.chainId||be,method:o,from:_,handleCancel:Mt}),Qt=(0,h.useMemo)(()=>M?{type:H.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:b?{type:H.TIP_TYPE.FEE_ERROR}:Et?ot?{type:H.TIP_TYPE.COMMON_ERROR,message:ot}:{type:Ht.TYPE.warn,message:m}:{coinId:r,type:H.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[r,b,M,Et,m,ot]),te=Qo({coinId:r,walletId:f,coinAmount:0,fromAddr:_,toAddr:_,localType:s?.localType,networkFee:z,extJson:JSON.stringify({}),txSource:Zt.DAPP,txType:U.BTC_SPLIT_UTXO}),K=Me({coinId:r,txType:U.BTC_SPLIT_UTXO,address:_}),vt=(0,h.useCallback)(async()=>{if(Ft)try{if(!await me({walletId:f,callback:async()=>{await c(tt(t.id))}}))return;await K(ut),ht(!0);let{signed:At,utxos:Ne}=await Wo().splitUtxo({splitAmount:it,inputs:Le(ut),amount:d,feePerB:g.satBytes},_,f),Se=await Ko(s?.localType,At);await te(At,{txHash:Se});let Ve=W.filter(ge=>ge.dummy),Ee=[...Le(Ve),...Ne.map(ge=>({...ge,rawTransaction:At}))];await c(ct(t.id,{utxos:Ee,txHash:Se}))}catch{}finally{ht(!1)}else{let J=W.slice(0,T);await c(ct(t.id,{utxos:Le(J)}))}},[T,c,d,W,_,Ft,ut,te,it,g.satBytes,t.id,K,f]),{loading:Dt,onClick:Te}=et(Mt),{loading:Ie,onClick:we}=et(vt),he=(0,h.useMemo)(()=>{let J={loading:Dt,actionType:Y.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:Te},At={actionType:Y.ACTION_TYPE.CONFIRM,disabled:$||F||X||b||St||!Number(z)||M||ot,onClick:we,loading:Ie||Ot};return Et||(At={coinId:r,walletId:f,address:_,actionType:Y.ACTION_TYPE.FILL_UP}),[J,At]},[r,z,b,F,_,M,Et,$,Te,we,St,X,f,Dt,Ie]);return h.default.createElement(u.Container,null,h.default.createElement(Rt,{backable:!1,closeable:!1,title:i("wallet_extension_send_title_send")}),h.default.createElement(q,null,h.default.createElement(ue,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:r,coinAmount:Kt}]})),h.default.createElement(q,null,h.default.createElement(Vt,{walletId:f,address:_,title:i("wallet_extension_network_address_title_walletused")},!!N&&h.default.createElement(Ue,{coinBalance:N,tooltip:i("extension_defi_bot_popuptext_avail_amount"),coinId:r}))),h.default.createElement(q,{bordered:!1},h.default.createElement(pe,{coinId:r,loading:F,feeError:b,networkFee:z,onClick:L})),h.default.createElement(ae,{placeholder:!0,offsetBottom:0,borderTop:!0},h.default.createElement(H,{coinId:r,...Qt}),h.default.createElement(Y,{buttonGroup:he})),h.default.createElement(ve,{coinId:r,visible:P,signInfo:S,value:g,estimatedFee:z,onChange:O,onToggleVisible:L}),h.default.createElement(We,{visible:Jt&&wt}))},Nn=Cr;a();l();var Sn=x(D());var En=({unapproved:t})=>{let e=t.params?.message,o=In({unapproved:t});return Sn.default.createElement(Cn,{needCheckMpc:!0,message:e,unapproved:t,tipMessage:o})};a();l();var It=x(D()),An=x(ie()),bn=x(zo()),Bn=x(Yt());se();Be();Tr();re();a();l();var jt={AMOUNT:1,CONFIRM:2};var ro=jt.AMOUNT;function Ir({unapproved:t}){let{from:e,type:o=U.BRC20_INSCRIBE,tick:n="",tid:r,amount:s,txSource:c=Zt.DAPP}=t?.params?.transaction||{},f=t?.localType||bo,[_,M]=(0,It.useState)(ro),T=(0,An.useDispatch)(),S=(0,bn.useHistory)(),d=xt({localType:f})?.netWorkId;d===void 0?d=Ut(f):d=+d;let g=(0,Bn.useCreation)(()=>o===U.BRC20_INSCRIBE?{chainId:d,coinType:ke(d),symbol:n}:null,[o,r,n,d]),B=Gt(void 0,{},g)?.coinId,P=(0,It.useCallback)(async()=>{await T(tt(t.id)),await T(Ct()),await rt(T)},[T,t.id]),L=zt({from:e,chainIndex:Ut(f),handleCancel:P,method:t?.method}),F=(0,It.useCallback)(()=>{M(jt.CONFIRM),ro=jt.CONFIRM},[]),I=(0,It.useCallback)(async({txIds:G,commitTx:z,revealTxs:pt})=>{await T(ct(t.id,{txIds:G,commitTx:z,revealTxs:pt})),await T(Ct()),S.push(Go)},[T,S,t.id]),b=(0,It.useCallback)(()=>{M(jt.AMOUNT),ro=jt.AMOUNT},[]);return It.default.createElement(xn,{fromAddress:e,coinId:B},_===jt.AMOUNT?It.default.createElement(fn,{amount:s,walletId:t.walletId,onCancel:P,onConfirm:F,headerProps:{closeable:!1,backable:!1}}):It.default.createElement(_n,{addressCheckRet:L,txSource:c,onCancel:P,onConfirm:I,walletId:t.walletId,headerProps:{onBack:b,closeable:!1,backable:!0}}))}var kn=Ir;a();l();var p=x(D()),Jn=x(ie()),Qn=x(zo());nt();a();l();var so=x(D()),Ln=x(Yt());a();l();function Pn(t=[]){if(!Array.isArray(t))throw new Error("assetChange should be an array");return t.map(e=>{let{direction:o,amount:n,usdAmount:r,symbol:s,logo:c}=e;return{operator:o===1?"+":"-",usdValue:r,rawValue:n,asset:{assetType:Jo.NATIVE,amount:n,symbol:s,imageUrl:c}}})}var wr=({address:t,hexStringList:e=[],chainIndex:o=0},n={})=>{let r=e?.toString(),s={ready:o!==void 0&&!!e?.length,refreshDeps:[t,r,o],...n},{loading:c,data:f,error:_}=(0,Ln.useRequest)(async()=>(await Uo({address:t,hexStringList:e,chainIndex:o})).data,s);return{loading:c,data:f,error:_}},hr=t=>(0,so.useMemo)(()=>!t||!t.length?[]:t.map(e=>{let{assetChange:o=[],assetInversion:n}=e;return{status:e.analysisStatus,gasFee:e?.gasFee||0,isShowFee:e?.isShowFee,exploreUrl:e?.exploreUrl,inputInfo:e?.inputInfo||[],outputInfo:e?.outputInfo||[],assetChange:Pn(o),assetInversion:n||!1}}),[t]),Nr=(t=[])=>(0,so.useMemo)(()=>!t||!t.length?null:t.some(o=>o.status>0)?Bt.EXECUTE_ERROR:null,[t]);function Fn(t={},e={}){let{loading:o,data:n,error:r}=wr(t,e),{utxoAllInfos:s}=n||{},c=hr(s),f=Nr(c);return{loading:o,error:r||f,data:c}}a();l();var y=x(D()),_e=x(to());nt();a();l();Be();function io(t){return t===Bo.XRC_NFT}a();l();var fe=x(D());var On=x(yr());nt();var ao=x(Yt());a();l();var Mn={address:"_address_11ipy_1"};function lo({children:t,addresses:e=[],exploreUrl:o=""}){let n=e[0],r=(0,ao.useMemoizedFn)(()=>{(0,On.default)(n),Co.success({title:i("wallet_receive_toast_address_copied"),desc:""})},[n]),s=(0,ao.useMemoizedFn)(()=>{o&&globalThis.platform.openTab({url:`${o}${n}`})},[n,o]);return e.length>1?t:fe.default.createElement(Ke.WhiteBoard,{rebirthPopper:!0,popupStyle:{marginLeft:16,marginRight:16,padding:12,borderRadius:8},content:fe.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"center"},fe.default.createElement(w.Text,{forceWrap:!0,size:w.SIZE.sm,className:Mn.address},n),fe.default.createElement(st,{size:st.SIZE.xs,icon:"okds-copy",onClick:r,style:{marginLeft:8}}),fe.default.createElement(st,{size:st.SIZE.sm,icon:"okx-wallet-plugin-open-link",onClick:s,style:{marginLeft:8}})),trigger:Ke.TRIGGER.hover},t)}a();l();var k={content:"_content_1i550_1",none:"_none_1i550_4",title:"_title_1i550_10",input:"_input_1i550_15",utxoContainer:"_utxoContainer_1i550_18",isCurrentAddr:"_isCurrentAddr_1i550_18",signTag:"_signTag_1i550_18",addrContainer:"_addrContainer_1i550_24",address:"_address_1i550_29",amount:"_amount_1i550_38",xrcAssetsContainer:"_xrcAssetsContainer_1i550_50",xrcAssetsTitle:"_xrcAssetsTitle_1i550_56",xrcAssetContainer:"_xrcAssetContainer_1i550_62",logo:"_logo_1i550_65",isNFT:"_isNFT_1i550_72",isNft:"_isNFT_1i550_72",amountText:"_amountText_1i550_75",protocol:"_protocol_1i550_78",moreXRCContainer:"_moreXRCContainer_1i550_85",moreXrcContainer:"_moreXRCContainer_1i550_85",showMoreTitle:"_showMoreTitle_1i550_89",moreAssetsLogos:"_moreAssetsLogos_1i550_95",moreAssetsLogo:"_moreAssetsLogo_1i550_95",expandContainer:"_expandContainer_1i550_106",expandContainer_title:"_expandContainer_title_1i550_110",expandContainerTitle:"_expandContainer_title_1i550_110",expandContainer_leftTotal:"_expandContainer_leftTotal_1i550_116",expandContainerLeftTotal:"_expandContainer_leftTotal_1i550_116",expandContainer_icon:"_expandContainer_icon_1i550_123",expandContainerIcon:"_expandContainer_icon_1i550_123"};var co="inputInfo",vn="outputInfo",Ge={xrcAsset:10,utxo:50},Sr=({coinId:t,data:e={},currentAddr:o})=>{let[n,r]=(0,y.useState)({}),[,s]=jo(t,{withPrice:!0}),c=(0,y.useMemo)(()=>[co,vn].map(d=>{let g=e[d]||[],O=n[d]||!1;return g.map((B,P)=>{let L=n[`${d}-${P}`]||!1,F=B.xrcAssets||[];return B.xrcToShow=L?F:F.slice(0,Ge.xrcAsset),B.moreXRC=F.slice(Ge.xrcAsset),B}),{key:d,exploreUrl:e.exploreUrl,allData:g,dataToShow:O?g:g.slice(0,Ge.utxo),moreData:g.slice(Ge.utxo)}}),[e,n]),f=(0,y.useCallback)((m=[])=>m.reduce((d,{amount:g})=>E.add(d,g),0),[]),_=(0,y.useCallback)(m=>{switch(m){case co:return i("wallet_extension_asset_input_inputs_num",{amount:c[0].allData.length});case vn:return i("wallet_extension_asset_outputs",{amount:c[1].allData.length});default:return""}},[c]),M=(0,y.useCallback)(m=>{r(d=>({...d,[m]:!0}))},[]),T=m=>{let{protocolType:d}=m||{};return io(d)?m.logo||Ro:m.logo||Yo},S=y.default.memo(({xrcAssets:m=[]})=>y.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:k.moreAssetsLogos},m.slice(0,3).map(d=>y.default.createElement("img",{className:k.moreAssetsLogo,src:d.logo||"",alt:d.symbol}))));return y.default.createElement(De,{copyable:!1,title:i("wallet_extension_asset_btn_transaction_details")},c.map((m,d)=>{let g=d;return y.default.createElement("div",{key:g,className:(0,_e.default)(k.content,m.key===co?k.input:"",m.dataToShow.length===0?k.none:"")},y.default.createElement("div",{className:(0,_e.default)(k.title)},_(m.key)),m.dataToShow.map((O,B)=>{let P=`${g}-${B}`;return y.default.createElement(y.default.Fragment,null,y.default.createElement(u.FlexBox,{key:P,align:u.ALIGN.center,justify:"space-between",className:(0,_e.default)(k.utxoContainer,o===O.address[0]?k.isCurrentAddr:"")},y.default.createElement("div",{className:(0,_e.default)(k.addrContainer)},y.default.createElement(lo,{addresses:O.address,exploreUrl:m.exploreUrl},y.default.createElement("div",{className:k.address},O.address.length>1?i("wallet_extension_asset_title_multisig"):vo(O.address[0]))),y.default.createElement(ho,{className:k.signTag,size:Je.SIZE.sm},i("wallet_extension_asset_tag_sign"))),y.default.createElement("div",{className:k.amount},y.default.createElement(w.DisplayAmount,{noStyle:!0,amount:O.amount,mode:w.CRYPTO,symbol:s?.symbol,decimals:s?.decimals,precision:s?.decimals,isStableCoin:s?.stableCoin}))),O.xrcToShow.length>0&&y.default.createElement("div",{className:k.xrcAssetsContainer},y.default.createElement(w.Text,{size:w.SIZE.xs,className:k.xrcAssetsTitle},i("wallet_extension_asset_include_asset")),O.xrcToShow.map(L=>y.default.createElement(u.FlexBox,{align:u.ALIGN.center,className:k.xrcAssetContainer},y.default.createElement("img",{className:(0,_e.default)(k.logo,io(L.protocolType)?k.isNFT:""),src:T(L),alt:L.symbol}),y.default.createElement(w.Text,{nowrap:!0,size:w.SIZE.xs,ellipsis:{tooltip:!0},className:k.amountText},`${L.amount} ${L.symbol}`),y.default.createElement(wo,{className:k.protocol,size:Je.SIZE.sm},L.protocolName))),O.moreXRC.length>0&&!n[`${m.key}-${B}`]?y.default.createElement(u.FlexBox,{align:u.ALIGN.center,onClick:()=>{M(`${m.key}-${B}`)},className:k.moreXRCContainer},y.default.createElement(S,{xrcAssets:O.moreXRC}),y.default.createElement("div",{className:k.showMoreTitle},i("wallet_extension_asset_btn_show_num_asset",{amount:E.thousandFormat(O.moreXRC.length)})),y.default.createElement(st,{icon:"okds-arrow-chevron-down-md",size:st.SIZE.xs})):null))}),m.moreData.length>0&&!n[m.key]?y.default.createElement("div",{className:k.expandContainer,onClick:()=>{M(m.key)}},y.default.createElement(u.FlexBox,{align:u.ALIGN.center,justify:"space-between"},y.default.createElement("div",{className:k.expandContainer_title},i("wallet_extension_asset_more_amount_inputs",{amount:E.thousandFormat(m.moreData.length)})),y.default.createElement(u.FlexBox,null,y.default.createElement("div",{className:k.expandContainer_leftTotal},y.default.createElement(w.DisplayAmount,{noStyle:!0,amount:f(m.moreData),mode:w.CRYPTO,symbol:s?.symbol,decimals:s?.decimals,precision:s?.displayPrecision,isStableCoin:s?.stableCoin})),y.default.createElement(st,{icon:"okds-arrow-chevron-down-md",size:Xo.xs,className:k.expandContainer_icon})))):null)}))},Dn=Sr;a();l();var Z=x(D()),Un=x(to());nt();a();l();var mt={main:"_main_asg9r_1",title:"_title_asg9r_8",scrollArea:"_scrollArea_asg9r_17",item:"_item_asg9r_22",subTitle:"_subTitle_asg9r_25",content:"_content_asg9r_32",loading:"_loading_asg9r_38",arrow:"_arrow_asg9r_43",icon:"_icon_asg9r_48"};function Er({psbts:t=[],loading:e,onClick:o}){let n=(0,Z.useCallback)(s=>{o(s)},[o]),r=()=>e?Z.default.createElement("div",{className:mt.scrollArea},Z.default.createElement("div",{className:mt.loading},Z.default.createElement(go.Circle,null))):t.length===0?Z.default.createElement(yo.State,{className:mt.empty}):Z.default.createElement("div",{className:mt.scrollArea},(t||[]).map((s,c)=>Z.default.createElement(u.FlexBox,{className:mt.item,align:u.ALIGN.center,key:s,onClick:()=>{n(c)}},Z.default.createElement(u.FlexBox,{className:mt.content,direction:u.DIRECTION.vertical},Z.default.createElement("div",{className:mt.subTitle},i("wallet_extension_asset_transaction_confirmation",{amount:oo(c+1)})),Z.default.createElement("div",{className:mt.content},Do(s))),Z.default.createElement("div",{className:mt.arrow},Z.default.createElement(st,{className:(0,Un.default)("okx-wallet-plugin-arrow-small-right",mt.icon)})))));return Z.default.createElement(u.FlexBox,{className:mt.main},Z.default.createElement("div",{className:mt.title},i("",{number:oo(t.length)})),r())}var Wn=(0,Z.memo)(Er);a();l();var mo=x(D());var Ar=t=>{let{loading:e,dappInfo:o,analyzeRet:n,showDappInfo:r=!0,noFold:s=!1}=t,{assetChange:c=[]}=n;return e?mo.default.createElement(cn,null):mo.default.createElement(ln,{assetChange:c,dappInfo:o,showDappInfo:r,noFold:s})},ze=Ar;se();re();a();l();var Tt=x(D());nt();a();l();var Xt={main:"_main_1h9ym_1",box:"_box_1h9ym_6",tipImg:"_tipImg_1h9ym_12",tipImgIcon:"_tipImgIcon_1h9ym_21",tipImgPic:"_tipImgPic_1h9ym_25",title:"_title_1h9ym_29",decs:"_decs_1h9ym_37",w100:"_w100_1h9ym_43",footerWrap:"_footerWrap_1h9ym_46"};var br=({visible:t,onCancel:e,onConfirm:o,headerProps:n,psbtHasMultiXRCAsset:r,paymentUseXRCAsset:s,assetInversion:c})=>{let f=(0,Tt.useMemo)(()=>r?i("wallet_extension_tip_multiple_inscription_use"):s?i("wallet_extension_desc_inscription_asset"):c?i("wallet_extension_bot_desc_nft_high_pay"):"",[c,s,r]),_=eo({light:"/cdn/assets/imgs/254/1A753CC7A4597254.png",dark:"/cdn/assets/imgs/254/5A6525A2E28CDA88.png"}),M=eo({light:"/cdn/assets/imgs/2411/435A510ADAEB8439.png",dark:"/cdn/assets/imgs/2411/FF2841348F871214.png"});return Tt.default.createElement(ne,{visible:t,alignBottom:!0,noMargin:!0,maskClosable:!0,noContentPadding:!0,transitionProps:{type:"slide",placement:"bottom",timeout:300},confirmBtnProps:{size:lt.SIZE.lg},cancelBtnProps:{size:lt.SIZE.lg},cancelText:i("wallet_extension_function_btn_continue_transaction"),confirmText:i("wallet_extension_mid_dialog_btn_cancel"),onCancel:e,onConfirm:o,onClose:e},Tt.default.createElement(u.FlexBox,{className:Xt.main,direction:u.DIRECTION.vertical},Tt.default.createElement(u.Box,{className:Xt.box},Tt.default.createElement(u.Box,{className:Xt.tipImg},Tt.default.createElement(To,{src:c?_:M,className:Xt.tipImgPic})),Tt.default.createElement(w.Text,{className:Xt.title,align:w.ALIGN.center},c?i("wallet_extension_bot_title_high_valuediff"):i("wallet_extension_title_transaction_risk")),Tt.default.createElement(w.Text,{className:Xt.decs,size:w.SIZE.sm,align:w.ALIGN.center},f)),Tt.default.createElement(u.Box,{className:Xt.w100},Tt.default.createElement(ze,{...n,showDappInfo:!1,loading:!1,noFold:!0}))))},Yn=br;a();l();_r();xr();var Xe=x(D()),Br=()=>{let[t,e]=(0,Xe.useState)(""),o=async()=>{let{data:n}=await Eo(No.getSignPrompt);n.assetReminder?e(n.assetReminder):e(null)};return(0,Xe.useEffect)(()=>{o()},[]),{assetReminder:t}},Rn=Br;a();l();var Gn=x(D());nt();var kr=({onConfirm:t})=>(0,Gn.useCallback)(()=>{ne.warn({title:i("wallet_extension_asset_alertbanner_title_alert"),alignBottom:!1,maskClosable:!1,hideCloseBtn:!0,text:i("wallet_extension_asset_alertbanner_desc_utxo_lost"),confirmBtnProps:{type:lt.TYPE.outline,size:lt.SIZE.lg},cancelBtnProps:{type:lt.TYPE.highlight,size:lt.SIZE.lg},onConfirm(e){e.destroy(),t()},async onCancel(e){e.destroy()},cancelText:i("commonall_text_btn_cancel"),confirmText:i("wallet_extension_asset_btn_continue")})},[t]),zn=kr;a();l();var xe=x(D());a();l();var R=x(D()),po=x(to());a();l();var gt={main:"_main_1fewt_1",box:"_box_1fewt_6",isPureScreen:"_isPureScreen_1fewt_12",tipImg:"_tipImg_1fewt_15",tipImgIcon:"_tipImgIcon_1fewt_24",title:"_title_1fewt_28",decs:"_decs_1fewt_36",extLink:"_extLink_1fewt_42",footerWrap:"_footerWrap_1fewt_46",screenOneButtons:"_screenOneButtons_1fewt_49",extButton:"_extButton_1fewt_53"};var Xn=t=>{let{children:e,desc:o,title:n,isPureScreen:r}=t;return R.default.createElement(u.FlexBox,{className:gt.main,direction:u.DIRECTION.vertical},R.default.createElement(u.Box,{className:(0,po.default)(gt.box,{[gt.isPureScreen]:r})},R.default.createElement(u.Box,{className:gt.tipImg},R.default.createElement(xo,{className:(0,po.default)("okx-wallet-plugin-risk-trading",gt.tipImgIcon)})),R.default.createElement(w.Text,{className:gt.title,align:w.ALIGN.center},n),R.default.createElement(w.Text,{className:gt.decs,size:w.SIZE.sm,align:w.ALIGN.center},o)),R.default.createElement(u.Box,{className:gt.footerWrap},e))},Pr=({modalParams:t,handleCancel:e,handleNext:o})=>{let{screenOne:n,screenTwo:r}=t,[s,c]=(0,R.useState)(!1),f=async()=>{c(!0),await e(),c(!1)};return R.default.createElement(Xn,{desc:n.desc,title:n.title},R.default.createElement(u.Box,{className:gt.screenOneButtons},R.default.createElement(lt,{block:!0,loading:s,size:lt.SIZE.lg,onClick:f,type:lt.TYPE.highlight,category:lt.CATEGORY.fill},n.mainBtnText),r?R.default.createElement(u.Box,{className:gt.extButton,onClick:o},n.subBtnText):null))},Lr=({handleCancel:t,handleNext:e,modalParams:o})=>{let{screenTwo:n={}}=o,{loading:r,onClick:s}=et(e),{loading:c,onClick:f}=et(t),_=[{loading:r,actionType:Y.ACTION_TYPE.CANCEL,btnText:n.subBtnText,onClick:s},{loading:c,actionType:Y.ACTION_TYPE.CONFIRM,btnText:n.mainBtnText,onClick:f}];return R.default.createElement(Xn,{isPureScreen:!0,desc:n.desc,title:n.title},R.default.createElement(u.Box,{className:gt.screenTwoButtons},R.default.createElement(Y,{buttonGroup:_})))},Fr=({handleCancel:t,closeModal:e,modalParams:o})=>{let[n,r]=(0,R.useState)(1);return n===2?R.default.createElement(Lr,{modalParams:o,handleCancel:t,handleNext:e}):R.default.createElement(Pr,{modalParams:o,handleCancel:t,handleNext:()=>{r(2)}})},qn=Fr;a();l();var Zn=x(D());nt();a();l();var Hn={extLink:"_extLink_1eb1z_1"};var Mr=()=>{let t=Vo(),e=r=>({title:i("wallet_extension_fractal_title_transaction_risky"),desc:i(r,{case:Zn.default.createElement(qo,{className:Hn.extLink,href:t?.scamsUrl},i("wallet_extension_function_link_case"))}),mainBtnText:i("wallet_extension_function_btn_cancel"),subBtnText:i("wallet_extension_function_btn_advanced")}),o={title:i("wallet_extension_fractal_title_transaction_risky"),desc:i("wallet_extension_function_desc_developer_continue"),mainBtnText:i("wallet_extension_mid_dialog_btn_cancel"),subBtnText:i("wallet_extension_function_btn_continue_transaction")};return{getUTXONotFoundModalParams:()=>({screenOne:e("wallet_extension_fractal_desc_transaction_risky"),screenTwo:o})}},$n=Mr;var Or=({psbtsInfoErr:t,handleCancel:e})=>{let{getUTXONotFoundModalParams:o}=$n(),n=(0,xe.useRef)(),r=s=>{n.current||(n.current=ne.action({hideCloseBtn:!0,maskClosable:!1,noContentPadding:!0,children:xe.default.createElement(qn,{modalParams:s,handleCancel:async()=>{await e(),n.current.destroy(),n.current=null},closeModal:()=>{n.current.destroy(),n.current=null}})}))};(0,xe.useEffect)(()=>{t?.code==Bt.UTXO_NOT_FOUND&&r(o())},[t])},Vn=Or;a();l();nt();a();l();var uo=x(So());var jn=t=>{try{return uo.Psbt.fromHex(t).toBase64()}catch{return uo.Psbt.fromBase64(t),t}};var qe=x(So()),kt={LIST:"list",UNLIST:"unlist",TRADE:"trade",RUNES:"runes"},Kn=t=>{try{let e=qe.Psbt.fromBase64(jn(t)),o=e?.data?.inputs||[],n=e?.data?.globalMap?.unsignedTx?.tx?.outs||[],r=[];return o.forEach((s,c)=>{if(s.witnessUtxo)r.push({...s,value:s.witnessUtxo.value});else if(s.nonWitnessUtxo){let f=qe.Transaction.fromBuffer(s.nonWitnessUtxo),_=e?.data?.globalMap?.unsignedTx?.tx?.ins||[],T=f.outs[_[c]?.index]?.value;r.push({...s,value:T})}}),{inputs:r,outputs:n}}catch{return{inputs:[],outputs:[]}}},qt=(t,e=0,o)=>!Array.isArray(t)||o===0?0:t.slice(e,o?e+o:void 0).reduce((n,{value:r})=>E.add(n,r),0);var tr=({unapproved:t})=>{let{psbt:e,psbts:o,type:n,from:r,amount:s=1,psbtOpts:c,broadcast:f=!1}=t.params.transaction,{origin:_,method:M}=t,T=t.method===Q.SIGNPSBTS,S=t?.walletId,m=t?.localType,g=xt({localType:m})?.coinId;g===void 0&&(g=Nt(m));let O=le(S),B=ce(S),P=de(S),{loading:L,data:F,error:I}=Fn({address:r,hexStringList:T?o:[e],chainIndex:Ut(m)}),[b,G]=(0,p.useState)(!1),[z,pt]=(0,p.useState)(0),$=(0,p.useMemo)(()=>T&&!b,[T,b]),N=(0,p.useMemo)(()=>F[z]||{},[F,z]),{assetReminder:X}=Rn(),W=(0,Jn.useDispatch)(),St=(0,Qn.useHistory)(),yt=an(t),{name:ut,icon:it,host:Ft}=yt,{inputs:Kt,outputs:V}=Kn(T?o[z]:e),at=(0,p.useMemo)(()=>E.sub(qt(Kt),qt(V)),[Kt,V]),Et=Tn(),Jt=(0,p.useMemo)(()=>{if(n!==kt.TRADE&&n!==kt.RUNES)return null;let j=Number(s);if(n===kt.RUNES){let ee=qt(V,1,j),oe=E.add(qt(V,0,1),qt(V,V.length-j+1,j-1));return`${E.sub(oe,E.add(ee,at))}`}let bt=qt(V,j+1,j),dt=qt(V,1,j);return`${E.sub(dt,E.add(bt,at))}`},[s,at,V,n]),wt=(0,p.useCallback)(async()=>{await W(tt(t.id)),await rt(W)},[W,t.id]),{addressCheckError:ht,addressCheckLoading:Mt}=zt({handleCancel:wt,from:r,method:M,chainIndex:Ut(m)}),ot=(0,p.useMemo)(()=>O&&T?{type:H.TIP_TYPE.COMMON_ERROR,message:i("extension_wallet_contractual_interaction_wallet_unavailable")}:B?{type:H.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:ht?{type:H.TIP_TYPE.COMMON_ERROR,message:ht}:I?{type:Ht.TYPE.warn,message:i("wallet_extension_asset_alert_trust_network")}:X&&!_?.includes("okx.com")?{type:Ht.TYPE.warn,message:X}:{},[O,T,B,I,X,_,ht]),Ot=(0,p.useCallback)(async()=>{if(!await me({walletId:S,callback:async()=>{await W(tt(t.id))}}))return;let bt=Ao(m);try{let dt=await Ho(T?o:e,r,S,{localType:bt,isPsbts:T},c);await W(ct(t.id,{signedTx:dt,broadcast:f}))}catch(dt){await Et({id:t.id,error:dt?.message||"Error"})}await rt(W)},[St,r,Et,W,T,m,e,c,o,t.id,S]);Vn({psbtsInfoErr:I,handleCancel:wt});let Qt=zn({onConfirm:Ot}),[te,K]=(0,p.useState)(!1),vt=(0,p.useMemo)(()=>{let j=N?.inputInfo||[],bt=N?.outputInfo||[],dt=j.filter(ft=>ft.address?.includes(r)),ee=bt.filter(ft=>ft.address?.includes(r)),oe=[],Ae=[];return dt.forEach(ft=>{ft.xrcAssets&&ft.xrcAssets.forEach(_t=>{oe.some(ye=>ye.symbol===_t.symbol&&ye.protocolId===_t.protocolId)||oe.push({symbol:_t.symbol,protocolId:_t.protocolId})})}),ee.forEach(ft=>{ft.xrcAssets&&ft.xrcAssets.forEach(_t=>{Ae.some(ye=>ye.symbol===_t.symbol&&ye.protocolId===_t.protocolId)||Ae.push({symbol:_t.symbol,protocolId:_t.protocolId})})}),oe.length>0&&Ae.length>0?!oe.every(ft=>Ae.some(_t=>ft.symbol===_t.symbol&&ft.protocolId===_t.protocolId)):!1},[N,r]),Dt=(0,p.useMemo)(()=>{let j=N.inputInfo||[],bt=N.outputInfo||[];return[...j,...bt].some(dt=>!!(dt.xrcAssets&&dt.xrcAssets.length>1))},[N]),Te=(0,p.useMemo)(()=>F.some(j=>{let bt=j.inputInfo||[],dt=j.outputInfo||[];return[...bt,...dt].some(ee=>!!(ee.xrcAssets&&ee.xrcAssets.length>1))}),[F]);(0,p.useEffect)(()=>{$||(Dt||vt||N.assetInversion)&&K(!0)},[F,$,Dt,vt,N.assetInversion]);let Ie=(0,p.useCallback)(()=>{if(!Te||!$){Ot();return}Qt()},[Te,Ot,Qt,$]),we=(0,p.useCallback)(j=>{G(!0),pt(j)},[G]),{loading:he,onClick:J}=et(wt),{loading:At,onClick:Ne}=et(Ie),Se=(0,p.useMemo)(()=>[{loading:he,actionType:Y.ACTION_TYPE.CANCEL,btnText:$?i("wallet_extension_asset_btn_cancel_all"):i("wallet_dapp_connection_btn_reject"),onClick:J},{disabled:B||L||ot.type===H.TIP_TYPE.COMMON_ERROR,actionType:Y.ACTION_TYPE.CONFIRM,btnText:$?i("wallet_extension_asset_btn_confirm_all"):i("extension_transactions_btn_confirm"),onClick:Ne,loading:At||Mt}],[B,he,At,J,ot,Ne,$,L,Mt]),Ve=(0,p.useMemo)(()=>{switch(n){case kt.LIST:return i("extension_wallet_transfer_maintitle_list");case kt.UNLIST:return i("extension_wallet_transfer_maintitle_cancel_listing");case kt.TRADE:return i("extension_wallet_transfer_maintitle_transaction");default:return i("extension_wallet_transfer_maintitle_transaction")}},[n]),Ee=(0,p.useMemo)(()=>n==="list"||N&&!N.isShowFee?!1:E.gt(N.gasFee,0)||E.gt(at,0),[at,N,n]),ge=(0,p.useMemo)(()=>!I||I===Bt.EXECUTE_ERROR&&N.status!==Bt.PSBT_ANALYSIS_FAILED,[I,N]),dr=(0,p.useMemo)(()=>I&&I!==Bt.EXECUTE_ERROR||N?.status===Bt.PSBT_ANALYSIS_FAILED,[I,N]);return p.default.createElement(u.Container,null,p.default.createElement(Rt,{title:Ve,backable:T&&b,closeable:!1,onBack:()=>{G(!1)}}),$?p.default.createElement("div",null,p.default.createElement(q,null,p.default.createElement(no,{summaryList:[{title:ut,desc:Ft,icon:{src:it}}],title:i("extension_contract_interaction_maintitle_request_from")})),p.default.createElement(Wn,{psbts:o,loading:L,onClick:we})):null,$?null:p.default.createElement(p.default.Fragment,null,ge&&p.default.createElement(ze,{coinId:g,txType:U.TRANS_OUT,loading:L,dappInfo:{name:ut,host:Ft,icon:it},analyzeRet:N}),dr&&p.default.createElement(q,null,(n===kt.TRADE||n===kt.RUNES)&&p.default.createElement(ue,{summaryList:[{coinId:g,coinAmount:Jt}],tooltip:i("extension_infor_tooltip_asset_changestips"),title:i("extension_contract_interaction_maintitle_asset_changes")}),p.default.createElement(no,{summaryList:[{title:ut,desc:Ft,icon:{src:it}}],title:i("extension_contract_interaction_maintitle_request_from")})),Ee&&p.default.createElement(q,null,p.default.createElement(pe,{coinId:g,networkFee:N.gasFee||at})),p.default.createElement(q,null,p.default.createElement(Vt,{title:i("wallet_extension_network_address_title_walletused"),address:r,walletId:S,onCopyCallback:()=>{P({trade:"approve",all_confirmation:"wallet_used_address"})}})),!Ee&&p.default.createElement(q,null,p.default.createElement(yn,{coinId:g})),p.default.createElement(q,null,p.default.createElement(Dn,{coinId:g,data:N,currentAddr:r})),p.default.createElement(q,null,p.default.createElement(De,{data:T?o[z]:e,copyable:{hideDesc:!0}}))),b?null:p.default.createElement(ae,{placeholder:!0,offsetBottom:0,borderTop:!0},p.default.createElement(H,{coinId:g,...ot}),p.default.createElement(Y,{buttonGroup:Se})),p.default.createElement(Yn,{visible:te,onCancel:()=>{K(!1)},onConfirm:()=>{K(!1),wt()},headerProps:{coinId:g,txType:U.TRANS_OUT,analyzeRet:N},psbtHasMultiXRCAsset:Dt,paymentUseXRCAsset:vt,assetInversion:N.assetInversion}))};a();l();var A=x(D()),er=x(ie()),or=x(Yt());nt();se();re();var nr=({unapproved:t})=>{let e=t.walletId,{localType:o,method:n}=t,r=xt({localType:o}),s=r?.coinId;s===void 0&&(s=Nt(o));let c=ce(e),{memo:f,value:_,memoPos:M,to:T,satBytes:S,from:m,extraParams:d}=t.params.transaction,g=Gt(s),[O,{toggle:B}]=(0,or.useBoolean)(!1),[P,L]=(0,A.useState)(S?{level:Wt.CUSTOM,satBytes:S}:{}),F=P?.satBytes,I=(0,er.useDispatch)(),[,b]=Pe({coinId:s,address:m,chainId:g?.chainId}),G=b?.transferReminder;(0,A.useEffect)(()=>{if(!F&&b?.normal&&L({level:Wt.STANDARD,satBytes:b?.normal}),F&&P?.level!==Wt.CUSTOM){let K=b[Oe[P?.level]?.satBytes];L({...P,satBytes:K})}},[b]);let[z,pt]=Fe({coinId:s,walletId:e,address:m,satBytes:F},{}),$=de(e),[N,X,W]=nn({coinId:s,toAddr:T,walletId:e,fromAddr:m,satBytes:F,coinAmount:_,canTransferAmount:pt},{}),St=(0,A.useMemo)(()=>pt===void 0||X===void 0?!0:E.gte(pt,E.add(X,_)),[pt,_,X]),yt=Me({coinId:s,txType:U.TRANS_OUT,address:m}),ut=rn({memo:f,memoPos:M,coinId:s,toAddr:T,walletId:e,coinAmount:_,fromAddr:m,localType:g?.localType,dustSize:b?.minOutput,networkFee:X,satBytes:P.satBytes}),it=tn({coinId:s,walletId:e,satBytes:F,address:m,utxoType:$t.TRANSFER}),Ft=le(e),[Kt,V]=(0,A.useState)(!1),at=(0,A.useCallback)(async()=>{await I(tt(t.id)),await I(Ct()),await rt(I),V(!1)},[I,t.id]),Et=(0,A.useCallback)(async()=>{if(!await me({walletId:e,callback:async()=>{await I(tt(t.id))}}))return;let vt=await it(_,X);await yt(vt,()=>{at()}),V(!0);let Dt=await ut({utxoList:vt});t.id&&(await I(ct(t.id,{signedTx:Dt,coinAmount:_,serviceCharge:X,satPerByte:F,coinId:s,...d})),await I(Ct())),V(!1)},[yt,_,I,X,d,it,at,F,ut,t.id]),{loading:Jt,onClick:wt}=et(at),{loading:ht,onClick:Mt}=et(Et),{addressCheckError:ot,addressCheckLoading:Ot}=zt({method:n,from:m,handleCancel:wt,chainIndex:r?.chainId||be}),Qt=(0,A.useMemo)(()=>c?{type:H.TIP_TYPE.COMMON_ERROR,message:i("wallet_extension_top_toast_dapp_comingsoon")}:St?W?{type:H.TIP_TYPE.FEE_ERROR}:ot?{type:H.TIP_TYPE.COMMON_ERROR,message:ot}:{type:Ht.TYPE.warn,message:G}:{type:H.TIP_TYPE.FEE_BALANCE_INSUFFICIENT},[W,c,St,G,ot]),te=(0,A.useMemo)(()=>{let K=[{actionType:Y.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:wt,loading:Jt}];return St?K=[...K,{disabled:z||N||W||c||!Number(X)||!!ot,actionType:Y.ACTION_TYPE.CONFIRM,onClick:Mt,loading:ht||Ot}]:K=[...K,{coinId:s,address:m,walletId:e,actionType:Y.ACTION_TYPE.FILL_UP}],K},[Jt,s,ht,X,W,N,m,c,St,z,wt,Mt,e,Ot,ot]);return A.default.createElement(u.Container,null,A.default.createElement(Rt,{title:i("wallet_trade_maintitle_transaction_confirm"),backable:!1,closeable:!1}),A.default.createElement(q,null,A.default.createElement(ue,{title:i("wallet_extension_send_colored_send"),summaryList:[{coinId:s,coinAmount:_}]})),A.default.createElement(q,null,A.default.createElement(Vt,{walletId:e,address:m,title:i("extension_send_mid_text_from"),onCopyCallback:()=>{$({trade:"send",all_confirmation:"wallet_used_address"})}},!!pt&&A.default.createElement(Ue,{coinBalance:pt,coinId:s})),A.default.createElement(Vt,{address:T,title:i("extension_send_mid_text_to"),onCopyCallback:()=>{$({trade:"send",all_confirmation:"to_address"})}})),A.default.createElement(q,{bordered:!1},A.default.createElement(pe,{coinId:s,loading:N,estimateFailed:W,networkFee:X,level:P?.level,onClick:()=>{B(),$({trade:"send",all_confirmation:"network_fee"})}})),A.default.createElement(ae,{placeholder:!0,offsetBottom:0,borderTop:!0},A.default.createElement(H,{coinId:s,...Qt}),A.default.createElement(Y,{buttonGroup:te})),A.default.createElement(ve,{coinId:s,visible:O,signInfo:b,value:P,estimatedFee:X,onChange:L,onToggleVisible:B}),A.default.createElement(We,{visible:Ft&&Kt}))};a();l();var Ce=x(D()),lr=x(Yt());Be();re();a();l();function rr(t){try{return[JSON.parse(t),null]}catch{return[null,new Error("Illegal JSON string")]}}fr();a();l();var $e=x(D()),ir=x(ie());nt();se();re();a();l();var v=x(D());nt();var Ze=x(Yt());a();l();var Pt={"inscription-preview":"_inscription-preview_yy6vc_1",inscriptionPreview:"_inscription-preview_yy6vc_1","inscription-preview__inner":"_inscription-preview__inner_yy6vc_13",inscriptionPreviewInner:"_inscription-preview__inner_yy6vc_13","inscription-preview-text":"_inscription-preview-text_yy6vc_21",inscriptionPreviewText:"_inscription-preview-text_yy6vc_21","inscription-preview-image":"_inscription-preview-image_yy6vc_26",inscriptionPreviewImage:"_inscription-preview-image_yy6vc_26","inscription-item__content":"_inscription-item__content_yy6vc_30",inscriptionItemContent:"_inscription-item__content_yy6vc_30","inscription-exceedTip":"_inscription-exceedTip_yy6vc_34",inscriptionExceedTip:"_inscription-exceedTip_yy6vc_34","inscription-extend":"_inscription-extend_yy6vc_39",inscriptionExtend:"_inscription-extend_yy6vc_39","inscription-extend__icon":"_inscription-extend__icon_yy6vc_43",inscriptionExtendIcon:"_inscription-extend__icon_yy6vc_43"};var fo=24,He={TEXT:"text",IMAGE:"image"},vr=v.default.memo(({type:t,contentType:e,body:o})=>{let[{inscriptionType:n,inscriptionContent:r},s]=(0,Ze.useSetState)({inscriptionType:He.TEXT,inscriptionContent:o});return(0,v.useEffect)(()=>{if(t===U.ORDINAL_NFT||e?.startsWith("image/"))try{let c=URL.createObjectURL(new Blob([o]));s({inscriptionType:He.IMAGE,inscriptionContent:c})}catch{s({inscriptionType:He.TEXT,inscriptionContent:o})}finally{s({initing:!1})}},[o,e,s,t]),v.default.createElement(u.Box,{className:Pt["inscription-preview"]},n===He.IMAGE?v.default.createElement("img",{alt:"",src:r,className:Pt["inscription-preview-image"]}):v.default.createElement(u.Box,{className:Pt["inscription-preview__inner"]},v.default.createElement(w.Text,{forceWrap:!0,className:Pt["inscription-preview-text"]},r)))}),Dr=({type:t,contentType:e,body:o,rawBody:n})=>{let r=(0,v.useMemo)(()=>{let f=o?.length;return E.lt(f,1024)?`${f} B`:`${E.floorTruncate(E.div(f,1024),3)} KB`},[o?.length]),s=t===U.ORDINAL_NFT||e?.startsWith("image/"),c=s?n?.slice(0,200):n;return v.default.createElement(u.FlexBox,null,v.default.createElement(vr,{type:t,body:o,contentType:e}),v.default.createElement(u.FlexBox,{direction:u.DIRECTION.vertical,className:Pt["inscription-item__content"]},v.default.createElement(w.Text,{strong:!0,ellipsis:{tooltip:!s},size:w.SIZE.xs},c),v.default.createElement(w.Text,{size:w.SIZE.xs,type:w.TYPE.secondary},r)))},Ur=({type:t,dataSource:e=[]})=>{let o=e?.length||0,[n,{toggle:r}]=(0,Ze.useBoolean)(!1),s=(0,v.useMemo)(()=>n?e?.slice(0,fo):e?.slice(0,3),[e,n]),c=(0,v.useMemo)(()=>Mo(t),[t]);return v.default.createElement(sn,{space:16,title:i(c,{num:o})},v.default.createElement($o,{space:24,renderEmpty:!1,dataSource:s,renderItem:f=>v.default.createElement(Dr,{...f,type:t})}),n&&o>fo&&v.default.createElement(w.Text,{size:w.SIZE.xs,type:w.TYPE.secondary,className:Pt["inscription-exceedTip"]},i("wallet_info_dialog_desc_replicate_hide",{num:E.sub(o,fo)})),o>3&&v.default.createElement(u.FlexBox,{justify:"center",className:Pt["inscription-extend"],onClick:r},v.default.createElement(st,{size:st.SIZE.xs,className:Pt["inscription-extend__icon"],icon:n?"okds-arrow-chevron-up-md":"okx-wallet-plugin-add-arrow-chevrons"})))},sr=Ur;function Wr({unapproved:t}){let e=(0,ir.useDispatch)(),{id:o}=t,{type:n}=t.params?.transaction||{},r=Fo[n],{localType:s}=t,f=xt({localType:s})?.coinId;f===void 0&&(f=Nt(s));let _=async()=>{await e(Ct()),await e(tt(t.id)),await rt(e)},M=async S=>{await e(ct(t.id,S)),await e(Ct())},{inscriptions:T}=pn();return $e.default.createElement(un,{txId:o,headerProps:{title:r?i(r):null,closeable:!1,backable:!1},confirmButtonProps:{onCancel:_,onConfirm:M},slot:{top:$e.default.createElement(q,null,$e.default.createElement(sr,{type:n,dataSource:T}))},netWorkCoinId:f})}var ar=Wr;var Yr=[U.BRC20_MINT,U.BRC20_INSCRIBE,U.BRC20_DEPLOY],Rr=[U.RUNES_ETCH];function Gr(t,e){let o=Po(e);return Yr.includes(t)?o=ko(e):Rr.includes(t)&&(o=Lo(e)),o}function zr(t,e){return e.map(({contentType:o,body:n})=>{let r=n;try{(t===U.ORDINAL_NFT||typeof t!="number"&&o?.startsWith("image/"))&&(r=C.Buffer.from(n,"hex"))}catch{}return{contentType:o,body:r,rawBody:n}})}function Xr({unapproved:t}){let{tick:e,type:o,from:n,to:r,txSource:s,inscriptions:c=[],amount:f,mintType:_=Oo.parallel,noBroadCast:M=!1}=t.params?.transaction||{},{localType:T}=t,S=(0,Ce.useMemo)(()=>zr(o,c),[o,c]),m=xt({localType:T}),d=m?.netWorkId;d===void 0?d=Ut(T):d=+d;let g=m?.coinId;g===void 0&&(g=Nt(T));let O=(0,lr.useCreation)(()=>{if(o===U.RUNES_ETCH){let[I,b]=rr(c[0]?.body);if(b)return{chainId:d,coinType:Qe(d),symbol:e,address:"btc-runesMain-invalid-inscriptions"};let G=I?.id||"";return{chainId:d,coinType:Qe(d),symbol:e,address:`btc-runesMain-${G}`}}return e?{chainId:d,coinType:ke(d),symbol:e}:null},[e,o,d]),B=Gr(o,d),P=Gt(void 0,{},O),L=(I,b)=>{let G=0;if(o===U.RUNES_ETCH){I.coinAmount=je(f,10**P?.decimals),I.coinId=P?.coinId||g,I.txSource=s||Zt.DAPP;return}f&&P?.decimals&&(G=je(f,10**P?.decimals)),I.coinAmount=G,I.coinId=b?g:P?.coinId||g,I.txSource=s||Zt.DAPP},F=(I,b)=>(I&&L(I,!0),Array.isArray(b)&&b.forEach(G=>{L(G,!1)}),M);return Ce.default.createElement(dn,{params:{walletId:t.walletId,utxoType:$t.INSCRIPTION_USE_NFT_UTXO,from:n,to:r,inscriptions:S,txType:o,protocolId:B,mintType:_,netWorkCoinId:g},lifecycle:{beforePostTx:F}},Ce.default.createElement(ar,{unapproved:t}))}var cr=Xr;a();l();var mr=x(D()),pr=x(ie()),_o=x(Yt());nt();se();var qr=({unapproved:t})=>{let e=(0,pr.useDispatch)(),{targetCoin:o}=t.params||{},n={image:o.logo,decimals:o.decimals,name:o.name,address:o.contractAddress,symbol:o.symbol},r=de(),s=(0,_o.useMemoizedFn)(async()=>{r({all_confirmation:"cancel",trade:"add_token"}),await e(tt(t.id)),await rt(e)}),{loading:c,onClick:f}=et(s),_={actionType:Y.ACTION_TYPE.CANCEL,btnText:i("wallet_dapp_connection_btn_reject"),onClick:f,loading:c},M=(0,_o.useMemoizedFn)(async()=>{try{r({all_confirmation:"confirm",trade:"add_token"}),await Zo(o),await e(ct(t.id)),await rt(e)}catch(g){Io.error(g?.data?.originalError?.msg||i("wallet_extenshion_toast_add_failed"))}}),{loading:T,onClick:S}=et(M),m={actionType:Y.ACTION_TYPE.CONFIRM,onClick:S,loading:T},d=[_,m];return mr.default.createElement(gn,{token:n,networkName:o.blockChain||o.localType,buttonGroup:d})},ur=qr;var hp=({unapproved:t})=>{switch(t.method){case Q.TRANSFER_NFT:case Q.SEND_INSCRIPTION:return Lt.default.createElement(wn,{unapproved:t});case Q.SPLITUTXO:return Lt.default.createElement(Nn,{unapproved:t});case Q.INSCRIBE:case Q.INSCRIBE_TRANSFER:return Lt.default.createElement(kn,{unapproved:t});case Q.SIGNPSBT:case Q.SIGNPSBTS:return Lt.default.createElement(tr,{unapproved:t});case Q.SIGN_MESSAGE:return Lt.default.createElement(En,{unapproved:t});case Q.MINT:return Lt.default.createElement(cr,{unapproved:t});case Q.WATCHASSET:return Lt.default.createElement(ur,{unapproved:t});case Q.SEND:case Q.SEND_BTC:return Lt.default.createElement(nr,{unapproved:t});default:return""}};export{hp as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=Bitcoin-MRKZPF34.js.map
