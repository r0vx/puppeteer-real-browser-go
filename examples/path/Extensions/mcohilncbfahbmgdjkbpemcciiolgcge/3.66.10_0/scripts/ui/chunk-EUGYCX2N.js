import{f as yn,g as _n,h as Fn,j as ut,k as An,l as In,m as Nn,r as kn}from"./chunk-TEVAE4SY.js";import{a as bn,b as Pn}from"./chunk-NZOYKJV7.js";import{a as Je}from"./chunk-V2QGBG3D.js";import{a as En}from"./chunk-7GRDW7ZD.js";import{a as dn,b as Tn,d as gn,f as hn,h as Cn}from"./chunk-DGIWAYI5.js";import{b as un}from"./chunk-IK5VIKIS.js";import{d as wn,e as vn}from"./chunk-J3K74NCM.js";import{a as Bn}from"./chunk-7KQVTMRC.js";import{c as ct,e as rn}from"./chunk-OADPFYBO.js";import{a as mt}from"./chunk-CIEH2J25.js";import{b as xn}from"./chunk-64LKONIY.js";import{B as mn,a as ln,l as pt}from"./chunk-NKIUEXOA.js";import{m as fn}from"./chunk-4YDY4B6P.js";import{d as pn}from"./chunk-CGFS6AE4.js";import{l as cn,m as Qe,u as ae}from"./chunk-CDNJY7Z3.js";import{b as an}from"./chunk-DBWXHHZT.js";import{d as Ee}from"./chunk-7JSJY3SQ.js";import{b as sn}from"./chunk-NWY3GPDX.js";import{a as Xe,d as Xt}from"./chunk-5PDHABUQ.js";import{a as $t,b as Kt}from"./chunk-NPQMAAOH.js";import{h as on}from"./chunk-OK4242CI.js";import{oa as jt}from"./chunk-NQAVUB4Q.js";import{c as tn}from"./chunk-5CHE7P4E.js";import{a as nn}from"./chunk-Y5K5NJ6U.js";import{a as en}from"./chunk-Q7FGM7BT.js";import{b as ve}from"./chunk-TKE74ERX.js";import{a as Zt,e as qt,r as xe}from"./chunk-WGVA2GGS.js";import{a as ko}from"./chunk-APGT6UVG.js";import{o as lt}from"./chunk-XP3TNE3R.js";import{C as Ht,Kb as Vt,T as Wt,Ua as Ze,W as Ut,Za as qe,_a as Rt,ib as zt,jc as No,mb as Yt,nb as st}from"./chunk-QRHYK2TW.js";import{a as z}from"./chunk-2FDQIA7D.js";import{b as Qt}from"./chunk-L524QXHA.js";import{E as Ot,Y as je,_ as j,c as Ve,da as oe,e as Gt,l as Mt}from"./chunk-4EIUGT5A.js";import{c as k}from"./chunk-62ZAND24.js";import{a as Jt}from"./chunk-SIITVWZR.js";import{Eb as Dt,J as rt,Jb as Po,K as Et,L as Ne,M as Ye,Ma as Bt,Na as bo,O as Ft,Q as ke,R as bt,Y as Pt,_d as St,gc as Lt,ia as Be,oa as At,od as Ao,oe as Io,ra as Fo}from"./chunk-QHXUL3YM.js";import{H as ne,n as Q,y as m}from"./chunk-MOTAOJVG.js";import{G as De,H as kt,c as Nt,o as le,q as it}from"./chunk-XR4SQWL7.js";import{L as at,e as wt,ra as vt}from"./chunk-CYTB2B6Q.js";import{aa as It,ka as D}from"./chunk-6M3PZK2X.js";import{b as te}from"./chunk-OL67KS7C.js";import{f as L,o as a,q as r}from"./chunk-SHG7TIBL.js";a();r();var ce=L(te());a();r();var Le={root:"_root_1gj3g_1",tools:"_tools_1gj3g_1",mevWrap:"_mevWrap_1gj3g_9",txExplainWrap:"_txExplainWrap_1gj3g_12",data:"_data_1gj3g_15"};var Bo=({txTypeInfo:e,children:t,...n})=>{let{txExplain1:o={},baseInfo:i={}}=e,x;i?.title?.text&&(x={...i,title:i.title.text});let u=ce.Children.toArray(t)?.filter(Boolean)?.length;return ce.default.createElement(yn,{injectInfo:x,needChildrenPadding:u,...n},ce.default.createElement(k.Box,{className:Le.root},ce.default.createElement(k.Box,{className:Le.tools},o?.title?ce.default.createElement(k.Box,{className:Le.txExplainWrap},ce.default.createElement(_n,{txExplain:o})):null),ce.default.createElement(k.Box,{className:Le.data},t)))},Dn=Bo;a();r();ne();a();r();ne();a();r();var Se=L(te());a();r();var $e={content:"_content_18w99_1",title:"_title_18w99_4",text:"_text_18w99_10"};a();r();a();r();var Z=L(te()),Ln=L(No());ne();Be();a();r();var J={title:"_title_1xthp_1",subtitle:"_subtitle_1xthp_9",fee:"_fee_1xthp_15",feeTitle:"_feeTitle_1xthp_21",feeDetail:"_feeDetail_1xthp_26",speedDetail:"_speedDetail_1xthp_33",gasDetail:"_gasDetail_1xthp_36"};var Do=()=>{let e=an(),t=fn(),n=on(),o=(0,Ln.useSelector)(Vt),i=un(),x=wn(),d=async(c,f,p,g=0)=>{let{baseCoin:T}=await e(p,!0),C=n?.[T.coinId]||"0",v=rt(c,f),y=Zt(Ne(v,g),{symbol:T.symbol,useContractPrecision:!0,contractPrecision:{decimals:T.decimals},precision:T.displayPrecision}).value,w=qt(rt(Et(Ne(v,g),10**T.decimals),C),{currencySign:o.symbol,useApproximate:!0}).value;return`${y} ${w}`},u=(c,f)=>{let p=i(c);return m("wallet_extension_transaction_confirmation_gas_detail",{gasPrice:Q.thousandFormat(p),gasLimit:Q.thousandFormat(f)})},s=async(c,f)=>{try{return await x({...c,coinId:f})}catch{return""}},l=({userGasInfo:c,updateGasInfo:f,fetchParams:p})=>{let{gasPrice:g,maxFeePerGas:T,maxPriorityFeePerGas:C}=f,{supportEip1559:v,gasLimit:y,gasPrice:w,maxFeePerGas:E,maxPriorityFeePerGas:P}=c;return v?(delete p.gasPrice,{...p,value:p?.amount,maxFeePerGas:T||E,maxPriorityFeePerGas:C||P,gasLimit:y}):{...p,value:p?.amount,gasPrice:g||w,gasLimit:y}};return async({coinId:c,baseCoinAmountUse:f,userGasInfo:p,updateGasInfo:g,serverSignInfo:T,fetchParams:C})=>{let{gasPrice:v,maxFeePerGas:y}=g,{supportEip1559:w,gasLimit:E,gasPrice:P,maxFeePerGas:$}=p,W=0;T?.needExtFee&&(W=await s(l({userGasInfo:p,updateGasInfo:g,fetchParams:C}),c));let G=w?$:P,U=await d(G,E,c),Y=u(G,E),M=w?y:v,K=await d(M,E,c,W),re=u(M,E);return new Promise((q,S)=>{let B=le.prompt({hideCloseBtn:!1,alignBottom:!1,titleCenter:!1,infoType:null,confirmText:m("extension_toast_btn_confirmgasfee"),confirmBtnProps:{type:D.TYPE.highlight,size:D.SIZE.lg},onConfirm:async()=>{B.destroy();let{baseCoin:R}=await e(c,!0),{coinAmountInt:V}=t(R.coinId),X=Ye(V,f);Cn({userGasInfo:p,updateGasInfo:g,baseCoinAmountAvailable:X,L1FEE:W})?(De.error({title:m("extension_toast_text_insufficient_balance")}),S(new Error(ae))):q(g)},onClose:()=>{B.destroy(),S(new Error(ae))},renderContent:R=>Z.default.createElement(R,null,Z.default.createElement("div",{className:J.title},m("extension_toast_title_transaction_replace")),Z.default.createElement("div",{className:J.subtitle},m("extension_toast_subtitle_gasincrease")),Z.default.createElement("div",{className:J.feeTitle},m("extension_toast_title_current_transaction")),Z.default.createElement("div",{className:J.fee},Z.default.createElement("div",{className:J.feeDetail},U),Z.default.createElement("div",{className:J.gasDetail},Y)),Z.default.createElement("div",{className:J.feeTitle},m("extension_toast_title_gasprice")),Z.default.createElement("div",{className:J.fee},Z.default.createElement("div",{className:J.speedDetail},K),Z.default.createElement("div",{className:J.gasDetail},re)))})})}},Sn=Do;var Lo=()=>{let e=Sn();return async({coinId:n,baseCoinAmountUse:o,userGasInfo:i,serverGasInfo:x,serverSignInfo:d,originTxGasInfo:u,fetchParams:s})=>{let l=hn({userGasInfo:i,serverGasInfo:x,originTxGasInfo:u});return l?.gasPrice||l?.maxFeePerGas?(await e({coinId:n,baseCoinAmountUse:o,userGasInfo:i,updateGasInfo:l,serverSignInfo:d,fetchParams:s}),Promise.resolve(l)):Promise.resolve()}},Gn=Lo;var So=({onCancel:e,getDialog:t,resolve:n,reject:o,newNonce:i})=>()=>{if(e){e(t(),{resolve:n,reject:o});return}t().destroy(),n({nonce:i})},Go=({updateGasInfo:e,resolve:t,onChainNonce:n})=>{t(e?{nonce:n,updateGasInfo:e}:{nonce:n})},Mo=()=>{let e=Gn();return async({coinId:n,baseCoinAmountUse:o="0",showSelectNonceDialog:i=!1,onChainNonce:x="0",newNonce:d="0",userGasInfo:u={},serverGasInfo:s={},serverSignInfo:l={},originTxGasInfo:_={},fetchParams:c={},title:f="",text:p="",confirmText:g="",cancelText:T="",onConfirm:C,onCancel:v})=>new Promise((y,w)=>{if(i){let E=le.prompt({hideCloseBtn:!0,alignBottom:!1,titleCenter:!1,infoType:null,cancelBtnProps:{category:D.CATEGORY.outline,size:D.SIZE.lg},confirmBtnProps:{type:D.TYPE.highlight,size:D.SIZE.lg},confirmText:g,cancelText:T,onConfirm:async()=>{if(C){await C(E,{resolve:y,reject:w});return}E.destroy();try{let P=await e({coinId:n,baseCoinAmountUse:o,userGasInfo:u,serverGasInfo:s,serverSignInfo:l,originTxGasInfo:_,fetchParams:c});Go({updateGasInfo:P,resolve:y,onChainNonce:x})}catch(P){w(P)}},onCancel:So({onCancel:v,resolve:y,reject:w,newNonce:d,getDialog:()=>E}),renderContent:P=>Se.default.createElement(P,null,Se.default.createElement("div",{className:$e.content},Se.default.createElement("div",{className:$e.title},f),Se.default.createElement("div",{className:$e.text},p)))})}else y({nonce:d})})},Fe=Mo;var Oo=()=>{let e=Fe();return async({coinId:n,baseCoinAmountUse:o,hasFailedTx:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:s,originTxGasInfo:l,serverSignInfo:_,fetchParams:c,txToastCheckData:f})=>{let p=f?.find(y=>y?.checkType===oe.OVERWRITTEN)||{},{popUpTitle:g,popUpDesc:T,primaryButtonName:C,secondaryButtonName:v}=p||{};return e({coinId:n,baseCoinAmountUse:o,showSelectNonceDialog:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:s,serverSignInfo:_,originTxGasInfo:l,fetchParams:c,title:g||m("wallet_extension_transaction_popup_failed_transaction"),text:T||m("wallet_extension_transaction_popup_replace_failed_transaction"),confirmText:C||m("wallet_extension_transaction_popup_btn_replace"),cancelText:v||m("wallet_extension_transaction_popup_btn_skip")})}},Mn=Oo;a();r();var Ho=()=>{let e=Fe();return async({coinId:n,baseCoinAmountUse:o,hasPending7702Tx:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:s,originTxGasInfo:l,serverSignInfo:_,fetchParams:c,txToastCheckData:f})=>{let p=f?.find(y=>y?.checkType===oe.OVERWRITTEN)||{},{popUpTitle:g,popUpDesc:T,primaryButtonName:C,secondaryButtonName:v}=p||{};return e({coinId:n,baseCoinAmountUse:o,showSelectNonceDialog:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:s,serverSignInfo:_,fetchParams:c,originTxGasInfo:l,title:g,text:T,confirmText:C,cancelText:v,onConfirm:(y,{resolve:w})=>{y.destroy(),w({nonce:d})},onCancel:(y,{reject:w})=>{y.destroy(),w(new Error(ae))}})}},On=Ho;a();r();ne();var Wo=()=>{let e=Fe();return async({coinId:n,baseCoinAmountUse:o,hasPendingTx:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:s,originTxGasInfo:l,serverSignInfo:_,fetchParams:c,txToastCheckData:f})=>{let p=f?.find(y=>y?.checkType===oe.OVERWRITTEN)||{},{popUpTitle:g,popUpDesc:T,primaryButtonName:C,secondaryButtonName:v}=p||{};return e({coinId:n,baseCoinAmountUse:o,showSelectNonceDialog:i,onChainNonce:x,newNonce:d,userGasInfo:u,serverGasInfo:s,serverSignInfo:_,fetchParams:c,originTxGasInfo:l,title:g||m("wallet_extension_transaction_popup_pending_transaction"),text:T||m("wallet_extension_transaction_popup_replace_pending_transaction"),confirmText:C||m("wallet_extension_transaction_popup_btn_replace"),cancelText:v||m("wallet_extension_transaction_popup_btn_continue_wait")})}},Hn=Wo;a();r();ne();vt();var Uo=()=>async({isRepeat:t,onCancel:n})=>new Promise((o,i)=>{if(t){let x=le.prompt({alignBottom:!1,hideCloseBtn:!0,infoType:le.Prompt.INFO_TYPE.warn,confirmBtnProps:{type:D.TYPE.highlight,size:D.SIZE.lg},cancelBtnProps:{category:D.CATEGORY.outline,size:D.SIZE.lg},title:m("wallet_extension_popup_repeat_order"),confirmText:m("wallet_extension_popup_repeat_order_btn_continue"),cancelText:n?m("wallet_extension_popup_repeat_order_btn_viewhistory"):null,text:m("wallet_extension_popup_repeat_order_desc"),onConfirm:()=>{x.destroy(),o()},onCancel:()=>{x.destroy(),wt(n)&&n(),i(new Error(ae))}})}else o()}),Wn=Uo;var Un=()=>{let e=Mn(),t=Hn(),n=Wn(),o=On(),i=async({coinId:u,from:s,to:l,amount:_,gasPrice:c,authorizationList:f,stateOverrideList:p})=>{let[{data:g=[]},{data:T={}}]=await Promise.all([Ut({checkTypes:[oe.REPEAT,oe.OVERWRITTEN],coinId:u,from:s,to:l,amount:_,gasPrice:c,authorizationList:f,stateOverrideList:p}),Wt({coinId:u,address:s},{fromAddr:s,scenario:Mt.SCENARIO_SEND_COIN})]);return{txToastCheckData:g,signInfoData:T}},x=u=>{let{hasFailedTx:s,hasPendingTx:l,hasPending7702Tx:_,nonce:c,newNonce:f,originGasPrice:p,originPriorityFee:g}=gn(u),T=Tn(u,oe.REPEAT);return{hasFailedTx:s,hasPendingTx:l,hasPending7702Tx:_,nonce:c,newNonce:f,originGasPrice:p,originPriorityFee:g,isRepeat:T}};return async({coinId:u,from:s,to:l,amount:_,gasPrice:c,authorizationList:f,stateOverrideList:p,baseCoinAmountUse:g,userGasInfo:T,whetherCheckRepeat:C,onRepeatCancel:v})=>{let y=[],w={};try{let B=await i({coinId:u,from:s,to:l,amount:_,gasPrice:c,authorizationList:f,stateOverrideList:p});if(!Array.isArray(B.txToastCheckData)||typeof B.signInfoData!="object")throw new Error(m("wallet_home_toast_network_error"));y=B.txToastCheckData,w=B.signInfoData?.info||{}}catch(B){throw new Error(B?.msg||m("wallet_home_toast_network_error"))}let E=x(y),{nonce:P,newNonce:$,originGasPrice:W,originPriorityFee:G,hasFailedTx:U,hasPendingTx:Y,hasPending7702Tx:M,isRepeat:K}=E,re={originGasPrice:W,originPriorityFee:G},q={coinId:u,baseCoinAmountUse:g,onChainNonce:P,newNonce:$,userGasInfo:T,serverGasInfo:w.gasPrice,serverSignInfo:w,originTxGasInfo:re,fetchParams:{amount:_,coinId:u,from:s,gasPrice:c,to:l}},S={nonce:$};return U?S=await e({...q,hasFailedTx:U,txToastCheckData:y}):Y?S=await t({...q,hasPendingTx:Y,txToastCheckData:y}):M&&(S=await o({...q,hasPending7702Tx:M,txToastCheckData:y})),C&&await n({isRepeat:K,onCancel:v}),S}};a();r();var N=L(te()),ge=L(lt());vt();ne();a();r();var Ge=L(te()),Te=L(Jt());ne();a();r();var me={root:"_root_wpiv5_1",title:"_title_wpiv5_4",header:"_header_wpiv5_8",icon:"_icon_wpiv5_12",content:"_content_wpiv5_16",textarea:"_textarea_wpiv5_19",errorTip:"_errorTip_wpiv5_22",errorBordered:"_errorBordered_wpiv5_29"};function Ro({className:e,value:t,onChange:n,error:o,titleClass:i,errorTipClass:x,headerClassName:d,contentClassName:u,...s}){return Ge.default.createElement(Nt,{defaultExpanded:!0,className:(0,Te.default)(me.root,e),titleClass:(0,Te.default)(me.title,i),headerClassName:(0,Te.default)(me.header,d),contentClassName:(0,Te.default)(me.content,u),customHeaderIcon:l=>Ge.default.createElement(ve,{icon:"okds-arrow-chevron-down-md",size:ve.SIZE.xs,className:(0,Te.default)({"okui-accordion-header-icon-expanded":l},me.icon)}),title:m("wallet_extension_inscription_text_hex_data_optional")},Ge.default.createElement(it.TextArea,{...s,inputClassName:me.textarea,errorType:it.TIP_TYPE.always,error:!!o,value:t,onChange:l=>{let _=l.target.value||"";n?.(_.trim())}}),!!o&&Ge.default.createElement(xe.Text,{className:(0,Te.default)(me.errorTip,x)},o))}var Rn=Ro;a();r();ne();function zn(e){return!!e&&(e.toLowerCase()==="0x"||!Xt(e)||e.length%2!==0)?m("wallet_extension_inscription_text_input_formatting_error"):null}a();r();var Yn=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"unpause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"account",type:"address"}],name:"isPauser",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"paused",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"renouncePauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"account",type:"address"}],name:"addPauser",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"pause",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"name",type:"string"},{name:"symbol",type:"string"},{name:"decimals",type:"uint8"},{name:"totalSupply",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"PauserRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"}];Be();a();r();var h=L(te()),pe=L(lt()),jn=L(Jt()),Zn=L(ko());ne();Be();a();r();var b={root:"_root_cnpwt_1",icon:"_icon_cnpwt_1",editApproveAmountModal:"_editApproveAmountModal_cnpwt_10",content:"_content_cnpwt_22",txTypeInfo:"_txTypeInfo_cnpwt_25",editArea:"_editArea_cnpwt_28",unlimitedText:"_unlimitedText_cnpwt_33",unlimitedSymbol:"_unlimitedSymbol_cnpwt_43",symbolClassName:"_symbolClassName_cnpwt_60",quickHandler:"_quickHandler_cnpwt_63",balanceWrap:"_balanceWrap_cnpwt_70",balance:"_balance_cnpwt_70",maxBalance:"_maxBalance_cnpwt_92",unlimited:"_unlimited_cnpwt_33",text:"_text_cnpwt_105",authQuantityWarnTip:"_authQuantityWarnTip_cnpwt_112",danger:"_danger_cnpwt_119",info:"_info_cnpwt_122",approveTip:"_approveTip_cnpwt_125",footerActions:"_footerActions_cnpwt_133",copy:"_copy_cnpwt_136",spenderAddress:"_spenderAddress_cnpwt_144"};var Vn=Q.toPlainString(10**40),zo=e=>{typeof e!="string"&&(e=e.toString());let t=e?.length;return t<=9?36:t>=10&&t<12?32:t===12?30:t>=13&&t<=15?24:t>=16&&t<=18?20:t>=19&&t<=24?16:12},qn=({address:e,coins:t,baseCoinId:n})=>{if(Array.isArray(t))return t.find(o=>o?.baseCoinId===n&&Qt(o?.address,e,{baseCoinId:n})||qn({address:e,baseCoinId:n,coins:o?.childrenCoin}))},Yo=({txTypeInfo:e,walletAccount:t,approve:n,baseCoin:o,updateApproveInfo:i,showApproveAddressAtPopup:x})=>{let{walletId:d}=t,{tokenInfo:u,index:s,amount:l,authQuantity:_,spender:c}=n||{},{autoEdit:f,defaultAmount:p,warnTip:g}=_||{},{address:T,decimals:C,symbol:v}=u,{address:y}=c||{},w=Nn(v,12),[E,P]=(0,h.useState)(null);(0,h.useEffect)(()=>{E&&E.focus()},[E]);let[$,W]=(0,h.useState)(!1),[G,U]=(0,h.useState)(!1),[Y,M]=(0,h.useState)(0),K=(0,pe.useMemoizedFn)((A=l)=>{U(st(A)),M(bn(A,C)),W(!0)}),re=(0,pe.useMemoizedFn)(()=>{U(A=>!A),M(0)}),q=(0,pe.useMemoizedFn)(()=>{U(!0),M(0)}),S=(0,h.useMemo)(()=>g?{type:b.info,text:g}:G&&!st(p)?{type:b.danger,text:m("wallet_extension_approve_alert_high_risk_unlimited")}:{type:b.info,text:m("wallet_extension_approvals_new_approval_amount")},[g,G,p,Y]),{chainId:B}=o||{},{coinId:R}=Ee(void 0,void 0,{chainId:B,address:T})||{},V=Je(R,d)?.coinAmount,X=Q.thousandFormat(V),ie=(0,pe.useMemoizedFn)(()=>{U(!1),M(V)}),ue=(0,pe.useMemoizedFn)(()=>{let A=G?Yt:Pn(Y||0,C);i(s,{amount:A}),W(!1),P(null)}),Pe=Bn(),de=sn({},d),fe=(0,h.useMemo)(()=>de?.find(A=>A.localType===o?.localType),[o?.localType,de?.length]),he=(0,pe.useMemoizedFn)(async(A=0)=>{if(!qn({address:T,coins:Pe,baseCoinId:o?.coinId}))try{let I=await $t({contractAddress:T,chainInfo:fe});await Kt(I)}catch(I){++A<3?he(A):kt.error({title:I?.msg||m("wallet_home_toast_network_error")})}}),se=()=>{(0,Zn.default)(y),De.success({desc:h.default.createElement(xe.Text,{inherit:!0,forceWrap:!0},y),placement:De.DIRECTION.top,title:m("wallet_receive_toast_address_copied")})};return(0,pe.useMount)(()=>{f&&K(p),he()}),h.default.createElement(k.Box,{className:b.root},h.default.createElement(k.Box,{className:b.icon,onClick:()=>{K()}},h.default.createElement(It,{className:"okx-wallet-plugin-draw-20"})),h.default.createElement(le.Action,{hideCloseBtn:!0,noContentPadding:!0,visible:$},h.default.createElement(k.Box,{className:b.editApproveAmountModal},h.default.createElement(k.Box,{className:b.content},h.default.createElement(Dn,{bordered:!1,txTypeInfo:e,className:b.txTypeInfo}),h.default.createElement(k.Box,{className:b.editArea},G?h.default.createElement(xe.Text,{onClick:re,className:b.unlimitedText},m("wallet_extension_transfer_title_unlimited_amount",{token:h.default.createElement(xe.Text,{className:b.unlimitedSymbol},w)})):h.default.createElement(pn,{clickSymbolFocus:!0,onRef:P,symbol:w,autoSize:zo,placeholder:"0",max:Vn,decimals:C,value:Y,onChange:A=>{Ft(A,Vn)&&M(A)},style:{fontWeight:700,height:"42px"},symbolClassName:b.symbolClassName})),h.default.createElement(k.Box,{className:b.quickHandler},!!Number(V)&&h.default.createElement(k.Box,{className:b.balanceWrap},h.default.createElement(xe.Text,{className:b.balance,ellipsis:{tooltip:X}},m("wallet_extension_approve_label_balance",{amount:X})),h.default.createElement(k.Box,{className:b.maxBalance,onClick:ie},m("commonall_enterfield_btn_max"))),h.default.createElement(k.Box,{onClick:q,className:b.unlimited},h.default.createElement(k.Box,{className:b.text},m("wallet_extension_transfer_dialog_checkbox_set_to_unlimited")))),!!S&&h.default.createElement(k.Box,{className:(0,jn.default)(b.authQuantityWarnTip,S.type)},S.text),x&&y&&h.default.createElement(k.Box,{className:b.spenderAddress},m("wallet_extension_approvals_mid_label_approval_address_var",{address:Ht(y)}),h.default.createElement(ve.IconButton,{hovered:!0,onClick:se,size:ve.SIZE.sm,tooltip:m("wallet_extension_top_copy_address"),icon:"okx-wallet-plugin-web3-copy",className:b.copy}))),h.default.createElement(k.Box,{className:b.approveTip},m("wallet_extension_approve_desc_dapp_right")),h.default.createElement(en,{affixStyle:{position:"none"},placeholder:!1,className:b.footerActions},h.default.createElement(D,{block:!0,category:D.CATEGORY.fill,type:D.TYPE.primary,size:D.SIZE.lg,onClick:ue},m("wallet_extension_approve_btn_amount_confirmation"))))))},Xn=Yo;a();r();var Ke=L(te()),Qn=L(lt());Io();Ao();var Vo=({coinId:e,txParams:t,networkFee:n,modifiedData:o,mevInfo:i,isMev:x,gasReturnActivity:d})=>({coinId:e,toAddr:t?.to,fromAddr:t?.from,txSource:St.DAPP,coinAmount:(Xe(t?.value)?z(t?.value):t?.value)||0,serviceCharge:n,inputData:o,mevSuppliers:x?i?.mevSuppliers:[],activityId:d?.activityId}),jo=({mergedParams:e,gasType:t})=>JSON.stringify({to:e?.to,gasType:t,from:e?.from,value:Xe(e?.value)?z(e?.value):e?.value,nonce:Xe(e?.nonce)?z(e?.nonce):e?.nonce,data:e?.data,gas:e?.gasLimit,oldTxHash:"",gasPrice:e?.supportEip1559?e?.maxFeePerGas:e?.gasPrice,repeatTxType:Gt.CONFIRMING,priorityFee:e?.supportEip1559?e.maxPriorityFeePerGas:0,authorizationList:e?.authorizationList}),Zo=({coinId:e,txType:t,txParams:n,isMev:o,mevInfo:i,localType:x,modifiedData:d,walletAccount:u,customGasInfo:s,gasReturnActivity:l,modifiedDataError:_,isSufficientGas:c,isSufficientBalance:f,reportGasReturnActivityDataInConfirm:p,confirmBtnText:g,cancelBtnText:T,canConfirm:C,silentLoading:v,onBeforeSign:y,onBeforePublish:w,onCancel:E,onConfirm:P,onConfirmReplace:$,isBalanceLoadError:W,preExecInfo:G,isOutputLoading:U,txToastCheckParams:Y})=>{let{walletId:M}=u||{},K=Un(),{networkFee:re,gasType:q,gasPrice:S}=s||{},B=vn({coinId:e,walletId:M,localType:x,fromAddr:n?.from}),R=mn(Vo({coinId:e,txParams:n,networkFee:re,modifiedData:d,mevInfo:i,isMev:o,gasReturnActivity:l})),V=(0,Ke.useMemo)(()=>s?.isNetworkFeeLoading||Qe(s,t)||W||_||v||C===!1||!c||!f,[v,s,t,_,C,c,f,W]),X=(0,Qn.useMemoizedFn)(async()=>{if($&&typeof P=="function")return P({preExecInfo:G,isMev:o,coinId:e,mevInfo:i,txParams:n,customGasInfo:s,modifiedData:d,gasReturnActivity:l,reportGasReturnActivityDataInConfirm:p});let se,A;try{let I=await K({to:n?.to,from:n?.from,authorizationList:n?.authorizationList,coinId:e,gasPrice:S,userGasInfo:s,amount:z(n?.value)||0,baseCoinAmountUse:z(n?.value||0),...Y||{}});se=I.nonce,A=I.updateGasInfo}catch(I){if(I?.message===ae)return null;throw I}p();let O={...n,...s,...A||{},nonce:se,data:d,withSignParams:!0};y&&(O=y(O,{txParams:n,customGasInfo:s,updateGasInfo:A}));try{let{signedTx:I,signParams:ee}=await B(O),Ae=await ln(Lt,I),Oe={};w&&(Oe=(await w({signedTx:I,txHash:Ae,signParams:ee,preExecInfo:G}))?.publishParams||{});let Ce=await R(I,{txHash:Ae,extJson:jo({mergedParams:{...O,authorizationList:ee?.authorizationList},gasType:q}),...Oe});return P?.({txHash:Ae,txId:Ce})}catch(I){return P?.({error:I})}}),{loading:ie,onClick:ue}=mt(X),Pe=(0,Ke.useMemo)(()=>({disabled:V,loading:ie||U,actionType:pt.ACTION_TYPE.CONFIRM,onClick:ue,btnText:g}),[V,ue,ie,U,g]),{loading:de,onClick:fe}=mt(E);return[(0,Ke.useMemo)(()=>({loading:de,onClick:fe,actionType:pt.ACTION_TYPE.CANCEL,btnText:T}),[de,fe,T]),Pe]},Jn=Zo;a();r();var et=L(te());ne();var qo=e=>{let[t,n]=(0,et.useState)({isNetworkFeeLoading:!0,gasLimit:"0",gasPrice:"0",maxFeePerGas:"0",maxPriorityFeePerGas:"0",supportEip1559:!1,gasType:j.STANDARD}),{gasLimitInfo:o={},gasLimit:i,gasPrice:x,maxFeePerGas:d,gasType:u,supportEip1559:s,customConfirmed:l,isGasLimitLoading:_,isNetworkFeeLoading:c,networkFee:f,maxPriorityFeePerGas:p,gasPriceInfo:g,extFee:T,useDefaultGas:C}=t,{minGasFee:v}=cn({gasLimit:i,gasPrice:x,maxPriorityFeePerGas:p,maxFeePerGas:d,supportEip1559:s,extFee:T,gasPriceInfo:g,gasLimitInfo:o,gasType:u}),y=(0,et.useMemo)(()=>u===j.CUSTOM&&!l&&!C?m("extension_send_mid_text_dapps_suggested_fee"):u||j.STANDARD,[l,u,C]),w=Qe(t,e),E=c&&_&&!o?.gasLimit;return{level:y,estimateFailed:w,customGasInfo:t,loading:c,networkFee:E?void 0:v,maxNetworkFee:E?void 0:f,onCustomGasInfoChange:n}},$n=qo;a();r();var be=L(te());Fo();Be();var Xo=({txType:e,walletId:t,coinId:n,txParams:o,customGasInfo:i,preExecuteLoading:x})=>{let[d,u]=(0,be.useState)(""),s=Ee(n),{from:l,to:_}=o||{},[c,f]=(0,be.useState)("");(0,be.useEffect)(()=>{x||(ut(e)||An(e)?(u(ct.approval),f(ut(e)?"approve":"revoke_approve")):(u(ct.dapp),f("Contract interaction")))},[x,e]);let p=rn({walletId:t,coinId:n,fromAddress:l,toAddress:_,txType:d,fee:Pt(i?.networkFee),disabled:!_,unavailable:i.gasType===j.CUSTOM&&i.customConfirmed}),{status:g,activity:T,activityId:C,tip:v,clear:y}=p,w=()=>{At({activityId:C,activity:T,status:g,tip:v,walletId:t,address:l})},E=T?.errorCode;return(0,be.useEffect)(()=>{!c||E===0&&jt({wallet_address:l,interactive_address:_,chain_id:s?.chainId,transaction_type:c})},[E,c,l,_,s?.chainId]),{gasReturnActivity:p,clearGasReturnInfo:y,reportGasReturnActivityDataInConfirm:w}},Kn=Xo;a();r();var Me=L(te());a();r();bo();Po();async function eo(e){return(await Dt(Bt.generate5792Data,e)).data.callData}function Qo({chainIndex:e,setModifiedData:t}){let[n,o]=(0,Me.useState)(!1),i=(0,Me.useRef)(0),[x,d]=(0,Me.useState)(!1),u=async(s,l)=>{try{let _=s.map(f=>f?.data?.eip5792Call),c=await eo({type:1,chainIndex:e,calls:_});l===i.current&&(o(!1),t(c),d(!1))}catch{d(!0),o(!1)}};return{loading:n,error:x,onDataChange:s=>{let l=(s.moduleList||[]).filter(c=>c?.data?.moduleType==="tx"),{strategyType:_}=s.txTypeInfo||{};_===qe.EIP_5792?(o(!0),i.current+=1,u(l,i.current)):(o(!1),d(!1),t(l[0]?.data?.modifiedData))}}}var to=Qo;a();r();Be();var Jo=e=>{let{txParams:t={}}=e,{gasPrice:n,maxFeePerGas:o,maxPriorityFeePerGas:i}=t,x=t.gas||t.gasLimit,d=j.STANDARD,u,s,l,_=z(x),c=z(n),f=z(o),p=z(i);return ke(c,0)&&(d=j.CUSTOM,u=c),ke(f,0)&&ke(p,0)&&bt(f,p)&&(d=j.CUSTOM,s=f,l=p),ke(_,0)&&(d=j.CUSTOM),!t.to&&t.data&&(d=j.CUSTOM),{initialGasType:d,initialCustomMaxPriorityFee:l,initialCustomGasLimit:_,initialCustomGasPrice:u,initialCustomMaxBaseFee:Ye(s,l)}},no=Jo;a();r();var dt={"data-input":"_data-input_1k4cq_1",dataInput:"_data-input_1k4cq_1","data-input-error-tip":"_data-input-error-tip_1k4cq_5",dataInputErrorTip:"_data-input-error-tip_1k4cq_5"};var $o=e=>Number(e)===Ve.INCREASE_ALLOWANCE?Yn:[],Ko=e=>{let{txId:t,chainId:n,walletId:o,txParams:i,gasLimitParams:x={},txToastCheckParams:d,preExecParams:u,interactAddress:s,dappInfo:l={},needMev:_=!1,openMev:c,coinId:f,isShowBlockSwapMevTooltip:p,onMevChange:g,onConfirm:T,onConfirmReplace:C,onCancel:v,onBeforeSign:y,onBeforePublish:w,backable:E=!1,onBack:P,asPage:$,confirmBtnText:W,cancelBtnText:G,showApproveAddressAtPopup:U,onDataChange:Y,reserveValue:M="0"}=e||{},[K,re]=(0,ge.useSetState)({mevInfo:{},isMev:c}),[q,{toggle:S}]=(0,ge.useBoolean)(!1),{from:B,to:R,value:V="0x0",data:X,typeInt:ie,authorizationList:ue,extParams:Pe}=i||{},{isSilentSign:de}=Pe||{},fe=s!==!1&&(s||R),he=(0,N.useMemo)(()=>[je.FeeDelegatedValueTransfer,je.FeeDelegatedValueTransferMemo,je.FeeDelegatedSmartContractExecution].includes(ie),[ie]),[se,A]=(0,N.useState)(""),O=Ee(f,void 0,{chainId:n}),I=O?.coinId,[ee,Ae]=(0,N.useState)({}),Oe=ee.loading,Ce=(0,N.useMemo)(()=>{if(!R&&X)return Ze.DEPLOY_CONTRACT;let{strategyType:H}=ee?.txTypeInfo||{};return H===qe.EIP_5792?Ze.EIP_5792:(ee?.moduleList||[]).find(({data:Ie})=>Ie?.moduleType===Rt.TX)?.data?.approveInfoList?.[0]?.spender?.approvalType||""},[R,X,ee]),ye=tn(O?.localType,o),tt=Ne(z(V),M),oo=no({txParams:i}),ao=En(ye.walletId),ro=(0,N.useMemo)(()=>zn(se),[se]),{isMev:He,mevInfo:nt}=K,We=se||X||"",io=(0,N.useMemo)(()=>({dappData:JSON.stringify({to:R,from:B,value:V,data:We,typeInt:ie}),from:B,authorizationList:ue,dappInfo:l,chainIndex:O?.chainId,method:Ot.SIGN_TRANSACTION,...u||{}}),[O?.chainId,B,We,R,V,ue,u]),so=(0,ge.useMemoizedFn)((H,_e)=>{re({isMev:H,mevInfo:_e}),g?.(H,_e)}),{level:lo,networkFee:co,maxNetworkFee:ft,customGasInfo:yt,estimateFailed:_t,loading:po,onCustomGasInfoChange:mo}=$n(Ce),{gasReturnActivity:xt,reportGasReturnActivityDataInConfirm:uo}=Kn({txType:Ce,coinId:I,txParams:i,customGasInfo:yt,preExecuteLoading:Oe,walletId:ye.walletId}),Tt=Je(I,o),{coinAmountInt:we,isBalanceLoadError:fo,isBalanceLoading:yo}=Tt,Ue=he?"0":ft,gt=(0,N.useMemo)(()=>at(we)||Q.gte(we,Ue),[we,Ue]),ht=(0,N.useMemo)(()=>!Q.eq(tt,0)&&!at(we)?Q.lte(tt,Q.sub(we,Ue)):!0,[we,Ue,tt]),{loading:_o,error:xo,onDataChange:To}=to({chainIndex:O?.chainId,setModifiedData:H=>{A(H),Y&&Y(H)}}),ot=xo||ro,go=Jn({coinId:I,txType:Ce,txParams:i,isMev:He,mevInfo:nt,isBalanceLoadError:fo,isOutputLoading:yo||_o,canConfirm:ee?.canConfirm,silentLoading:ee?.silentLoading,isSufficientGas:gt,isSufficientBalance:ht,walletAccount:ye,customGasInfo:yt,gasReturnActivity:xt,modifiedDataError:ot,localType:O?.localType,modifiedData:We,walletId:ye?.walletId,reportGasReturnActivityDataInConfirm:uo,onBeforeSign:y,onBeforePublish:w,onCancel:v,preExecInfo:ee,onConfirm:T,onConfirmReplace:C,confirmBtnText:W,cancelBtnText:G,txToastCheckParams:d}),ho=(0,ge.useMemoizedFn)((H,_e,Ie)=>{let Re=$o(H),ze=zt(_e,Re);return ze?In(i?.data,{approveAmount:Ie},ze):null});return N.default.createElement(N.default.Fragment,null,N.default.createElement(nn,{title:"",noContent:!0,onBack:P,asPage:$,closeable:!1,backable:E}),N.default.createElement(kn,{handleCancel:v,preExecParams:io,walletAccount:ye,confirmBtnText:W,cancelBtnText:G,buttonGroup:go,onUpdatePreExecInfo:Ae,txState:{txId:t,baseCoin:O,estimateFailed:_t,isSufficientBalance:ht,isSufficientGas:gt,coinWithBalance:Tt},localType:O?.localType,mevProps:{isMev:He,needMev:_,onMevChange:so,isShowBlockSwapMevTooltip:p},networkFeeProps:{isFree:he,level:lo,coinId:I,networkFee:co,maxNetworkFee:ft,loading:po,estimateFailed:_t,onClick:()=>{S(),ao({trade:"contract_interaction",all_confirmation:"network_fee"})}},onDataChange:To,slot:{interactWith:!!fe&&N.default.createElement(xn,{address:fe,title:m("wallet_extension_popup_text_interact_with")}),advancedEntry:!X&&N.default.createElement(Rn,{value:se,error:ot,onChange:A,className:dt["data-input"],errorTipClass:dt["data-input-error-tip"]}),bottom:!!de&&N.default.createElement(Fn,null)},renderEditApproveAmount:(H,_e)=>{let Ie=H?.authQuantity?.canEdit,Re=H?.spender?.approvalType,ze=H?.eip5792Call,Co=H?.txTitle?.data;return[Ve.INCREASE_ALLOWANCE,Ve.AUTHORIZATION].includes(Re)&&Ie?N.default.createElement(Xn,{showApproveAddressAtPopup:U,txTypeInfo:{baseInfo:Co},walletAccount:ye,approve:H,baseCoin:O,updateApproveInfo:(wo,Ct)=>{let vo=Ce===Ze.EIP_5792?ze?.data:i.data,Eo=ho(Re,vo,Ct.amount);_e(wo,Ct,Eo)}}):null}}),N.default.createElement(dn,{visible:q,coinId:I,address:B,inputData:We,tokenAddress:R,value:z(V),onBack:S,onClose:null,initialGasData:oo,onGasChange:mo,minimumGasLimit:He?nt.gas:0,isMev:He,mevInfo:nt,gasReturn:xt,gasLimitParams:x,gasLimitOptions:{disabled:ot}}))},ll=Ko;export{Dn as a,Un as b,Rn as c,zn as d,eo as e,ll as f};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-EUGYCX2N.js.map
