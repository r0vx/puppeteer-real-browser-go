import{a as ft}from"./chunk-3FBTFEMV.js";import{c as yt,d as xt}from"./chunk-LU2QCUPE.js";import{a as at}from"./chunk-BULMUVKY.js";import{a as ht}from"./chunk-U7FUSLT6.js";import{f as nt}from"./chunk-F6UVHIJV.js";import{a as gt}from"./chunk-IEGAVAV7.js";import{a as _t}from"./chunk-DA2FCNEZ.js";import{a as rt}from"./chunk-TLZRRG7J.js";import{z as wt}from"./chunk-KDVER5QK.js";import{b as ct,c as ut,f as dt}from"./chunk-7IRBVBKW.js";import{b as j}from"./chunk-BO5YOOQA.js";import{i as Q}from"./chunk-QTKQMZ5K.js";import{a as pt}from"./chunk-Q7FGM7BT.js";import{b as mt,c as lt}from"./chunk-MONRGJFN.js";import{a as h,y as tt,z as et}from"./chunk-QMENNGDH.js";import{r as m}from"./chunk-WGVA2GGS.js";import{o as At}from"./chunk-XP3TNE3R.js";import{Nb as $,jc as Dt,sb as V,vb as J,yb as X}from"./chunk-QRHYK2TW.js";import{a as st}from"./chunk-7N263AYH.js";import{a as ot}from"./chunk-532YJKK4.js";import{p as K,q as G,r as Ft}from"./chunk-ZDOH3CEJ.js";import{d as it}from"./chunk-AVC4ODUV.js";import{a as Ot}from"./chunk-SIITVWZR.js";import{I as Ct,la as Y,ra as vt,u as z}from"./chunk-QHXUL3YM.js";import{H as D,y as s,z as R}from"./chunk-MOTAOJVG.js";import{D as x,H as Z,h as P,o as q,q as O}from"./chunk-XR4SQWL7.js";import{ka as y}from"./chunk-6M3PZK2X.js";import{b as A}from"./chunk-OL67KS7C.js";import{f as d,o as e,q as o}from"./chunk-SHG7TIBL.js";e();o();var t=d(A()),bt=d(ot());var L=d(Ot());D();e();o();e();o();var k=d(A()),E=d(Dt()),N=d(ot());e();o();var Tt=()=>rt("passwordSecurity",{...at,location:window.location.href})?.data;vt();e();o();var kt=r=>{let i="";try{let a=J(r),c=V(r),u=$(r);i=nt(r)?.metadata?.origin||c[c.length-1]?.origin||c[c.length-1]?.msgParams?.origin||u[u.length-1]?.origin||a[a.length-1]?.origin}catch{}return i};Ct();Ft();var U=d(At());D();e();o();var g=d(A());D();e();o();var T={updateMb32:"_updateMb32_2kuwm_1",centerImage:"_centerImage_2kuwm_4",titleUpdate:"_titleUpdate_2kuwm_11",textUpdate:"_textUpdate_2kuwm_16"};var Et=(r,i)=>{q.action({mobileWidth:"77.777777%",noTopRadius:!1,alignBottom:!1,hideCloseBtn:!0,btnFull:!0,children:g.default.createElement("div",{className:T.updateMb32},g.default.createElement("div",{className:T.centerImage},g.default.createElement("img",{src:i,alt:""})),g.default.createElement("div",{className:T.titleUpdate},s("wallet_extension_password_popup_title_wallet_security_tip")),g.default.createElement("div",{className:T.textUpdate},s("wallet_extension_password_popup_text_wallet_security_tip"))),confirmText:s("wallet_extension_password_popup_btn_update_password"),cancelText:s("wallet_extension_password_popup_btn_maybe_later"),maskClosable:!1,onConfirm:a=>{window.localStorage.pss=1,r.push(et),a.destroy()},cancelBtnProps:{category:"text",type:"primary"},onCancel:a=>{window.localStorage.pss=1,a.destroy()}})};var Ht=r=>`https://${r}/help/how-to-solve-the-problem-of-encountering-password-errors-when-logging-in-to`,H=()=>(0,E.useSelector)(X),M=({form:r})=>{let i=(0,N.useHistory)(),{search:a}=(0,N.useLocation)(),c=(0,E.useDispatch)(),u=gt(),[w,f]=(0,k.useState)(!1),[n,b]=(0,k.useState)(null),[{walletAsset:C=0}]=wt(),I=Tt(),p=(0,E.useSelector)(kt),v=Y()===z;(0,U.useMount)(()=>{j({islogin:"no",isbydapp:v?" yes":"no",dapp_url:p,wallet_id:u})});let St=ft(),Pt=_t()?.passwordNotice||Ht(St),Nt=it({dark:"/cdn/assets/imgs/246/74D87A474619BCFE.png",light:"/cdn/assets/imgs/246/696DAB049D0A9095.png"}),Ut=(0,U.useMemoizedFn)(async W=>{let F=r.getFieldValue("password");if(F&&!w&&!n)try{let S=window.localStorage.pss;f(!0),await c(Q(F)),I&&F.length<ht&&Number(C)>100&&!S&&Et(i,Nt);let{redirectPathname:B,redirectSearchParams:Lt}=xt(a);B?(i.replace({pathname:h}),i.push({pathname:B,search:yt(Lt)})):i.push({pathname:h})}catch({message:S}){S===K?b(R("wallet_set_password_errortip_password_wrong_see_notice",{notice:k.default.createElement(P,{size:P.SIZE.sm,weight:P.WEIGHT.muted,target:"_blank",href:Pt,underline:!0},s("wallet_set_password_errortip_password_wrong_see_notice_icu"))})):S===G&&Z.error(s("wallet_home_toast_version_error")),W&&W()}finally{f(!1)}},[r,w,n]);return{submitting:w,passwordError:n,setPasswordError:b,onSubmit:Ut}};e();o();var l={password:"_password_11p2x_1",error:"_error_11p2x_5",input:"_input_11p2x_8",btn:"_btn_11p2x_14",footer:"_footer_11p2x_17","tip-text":"_tip-text_11p2x_21",tipText:"_tip-text_11p2x_21","password-tip-text":"_password-tip-text_11p2x_31",passwordTipText:"_password-tip-text_11p2x_31","pass-key-tip-text":"_pass-key-tip-text_11p2x_34",passKeyTipText:"_pass-key-tip-text_11p2x_34"};var Mt=()=>{let r=x.useForm(),i=H(),a=(0,bt.useHistory)();t.default.useLayoutEffect(()=>{i&&a.push(h)},[i]);let{submitting:c,passwordError:u,setPasswordError:w,onSubmit:f}=M({form:r}),n=(0,t.useRef)(null),[b]=lt(mt.passwordType),{open:C}=dt(),I=(0,t.useCallback)(async p=>{(p?.key==="Enter"||p?.keyCode===13)&&await f(()=>{n.current&&setTimeout(()=>{n.current.focus()})})},[]);return(0,t.useEffect)(()=>(document.addEventListener("keydown",I),()=>{document.removeEventListener("keydown",I)}),[]),b===2?t.default.createElement(t.default.Fragment,null,t.default.createElement(ct,{onPass:async p=>{r.setFieldsValue({password:p}),await f()}}),t.default.createElement(m.Text,{className:(0,L.default)(l.tipText,l.passKeyTipText),strong:!0,align:m.ALIGN.center,size:m.SIZE.sm,type:m.TYPE.secondary,onClick:()=>{C()}},s("wallet_extension_biometrics_dialog_title_cant_unlock"))):t.default.createElement(x,{form:r,onChange:()=>{w(null)},onSubmit:async()=>{await f(()=>{n.current&&setTimeout(()=>{n.current.focus()})})}},t.default.createElement(x.Item,{useChildError:!0,name:"password",className:l.password,extra:!!u&&t.default.createElement(m.Text,{size:m.SIZE.sm,className:l.error},u)},t.default.createElement(ut,{elementName:"u",autoFocus:"autoFocus",inputClassName:l.input,className:(0,L.default)({error:!!u}),size:O.SIZE.xl,autoComplete:"off",errorType:O.TIP_TYPE.always,disabled:c,placeholder:s("wallet_home_lock_wallet_placeholder_input_password"),onRef:p=>{n.current=p}})),t.default.createElement(x.Item,{shouldUpdate:!0,className:l.btn},({getFieldValue:p})=>{let v=!p("password")||!!u;return t.default.createElement(pt,{usePortal:!0,placeholder:!0,offsetBottom:0,className:l.footer,style:{zIndex:1e4}},t.default.createElement(y,{block:!0,htmlType:"submit",disabled:v,category:y.CATEGORY.fill,type:y.TYPE.highlight,size:y.SIZE.xl,loading:c,loadingText:s("wallet_home_btn_unlock"),onClick:async()=>{await f(()=>{n.current&&setTimeout(()=>{n.current.focus()})})}},s("wallet_home_btn_unlock")),t.default.createElement(st,{to:tt,className:(0,L.default)(l.tipText,l.passwordTipText)},t.default.createElement(m.Text,{strong:!0,size:m.SIZE.sm,type:m.TYPE.secondary},s("wallet_footer_subtitle_forgot_password"))))}))};e();o();export{kt as a,M as b,Mt as c};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-5NOUDFJN.js.map
