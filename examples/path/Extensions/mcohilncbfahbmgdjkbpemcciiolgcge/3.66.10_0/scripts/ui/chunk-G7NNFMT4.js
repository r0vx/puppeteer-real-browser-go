import{c as V,o as B,q as A}from"./chunk-SHG7TIBL.js";var Go=V(_n=>{"use strict";B();A();Object.defineProperty(_n,"__esModule",{value:!0});_n.crypto=void 0;_n.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Dt=V(D=>{"use strict";B();A();Object.defineProperty(D,"__esModule",{value:!0});D.wrapXOFConstructorWithOpts=D.wrapConstructorWithOpts=D.wrapConstructor=D.Hash=D.nextTick=D.swap32IfBE=D.byteSwapIfBE=D.swap8IfBE=D.isLE=void 0;D.isBytes=Zo;D.anumber=wr;D.abytes=Pt;D.ahash=i0;D.aexists=c0;D.aoutput=a0;D.u8=d0;D.u32=f0;D.clean=u0;D.createView=l0;D.rotr=h0;D.rotl=b0;D.byteSwap=_r;D.byteSwap32=Fo;D.bytesToHex=x0;D.hexToBytes=g0;D.asyncLoop=w0;D.utf8ToBytes=Er;D.bytesToUtf8=m0;D.toBytes=En;D.kdfInputToBytes=_0;D.concatBytes=E0;D.checkOpts=B0;D.createHasher=zo;D.createOptHasher=Wo;D.createXOFer=Yo;D.randomBytes=A0;var Rt=Go();function Zo(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function wr(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Pt(e,...t){if(!Zo(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function i0(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");wr(e.outputLen),wr(e.blockLen)}function c0(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function a0(e,t){Pt(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function d0(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function f0(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function u0(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function l0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function h0(e,t){return e<<32-t|e>>>t}function b0(e,t){return e<<t|e>>>32-t>>>0}D.isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function _r(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}D.swap8IfBE=D.isLE?e=>e:e=>_r(e);D.byteSwapIfBE=D.swap8IfBE;function Fo(e){for(let t=0;t<e.length;t++)e[t]=_r(e[t]);return e}D.swap32IfBE=D.isLE?e=>e:Fo;var Xo=(()=>typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function")(),y0=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function x0(e){if(Pt(e),Xo)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=y0[e[n]];return t}var nt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ko(e){if(e>=nt._0&&e<=nt._9)return e-nt._0;if(e>=nt.A&&e<=nt.F)return e-(nt.A-10);if(e>=nt.a&&e<=nt.f)return e-(nt.a-10)}function g0(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Xo)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=Ko(e.charCodeAt(s)),c=Ko(e.charCodeAt(s+1));if(i===void 0||c===void 0){let a=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+s)}r[o]=i*16+c}return r}var p0=async()=>{};D.nextTick=p0;async function w0(e,t,n){let r=Date.now();for(let o=0;o<e;o++){n(o);let s=Date.now()-r;s>=0&&s<t||(await(0,D.nextTick)(),r+=s)}}function Er(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function m0(e){return new TextDecoder().decode(e)}function En(e){return typeof e=="string"&&(e=Er(e)),Pt(e),e}function _0(e){return typeof e=="string"&&(e=Er(e)),Pt(e),e}function E0(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];Pt(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}function B0(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(e,t)}var mr=class{};D.Hash=mr;function zo(e){let t=r=>e().update(En(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Wo(e){let t=(r,o)=>e(o).update(En(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Yo(e){let t=(r,o)=>e(o).update(En(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}D.wrapConstructor=zo;D.wrapConstructorWithOpts=Wo;D.wrapXOFConstructorWithOpts=Yo;function A0(e=32){if(Rt.crypto&&typeof Rt.crypto.getRandomValues=="function")return Rt.crypto.getRandomValues(new Uint8Array(e));if(Rt.crypto&&typeof Rt.crypto.randomBytes=="function")return Uint8Array.from(Rt.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}});var Br=V(it=>{"use strict";B();A();Object.defineProperty(it,"__esModule",{value:!0});it.equal=it.concat=it.HEX_REGEX=void 0;var v0=Dt();it.HEX_REGEX=/^[A-F0-9]*$/iu;function S0(e){return(0,v0.concatBytes)(...e)}it.concat=S0;function H0(e,t){if(e.byteLength!==t.byteLength)return!1;let n=new Int8Array(e),r=new Int8Array(t);for(let o=0;o!==e.byteLength;o++)if(n[o]!==r[o])return!1;return!0}it.equal=H0});var Yt=V(ye=>{"use strict";B();A();var I0=ye&&ye.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),L0=ye&&ye.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&I0(t,e,n)};Object.defineProperty(ye,"__esModule",{value:!0});ye.randomBytes=ye.stringToHex=ye.hexToString=ye.hexToBytes=ye.bytesToHex=void 0;var Qo=Dt(),T0=Br(),O0=e=>(0,Qo.bytesToHex)(e instanceof Uint8Array?e:Uint8Array.from(e)).toUpperCase();ye.bytesToHex=O0;var C0=e=>{let t=e.length,n=new Uint8Array(t/2);if(!T0.HEX_REGEX.test(e))throw new Error("Invalid hex string");for(let r=0;r<n.length;r++){let o=r*2,s=e.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[r]=i}return n};ye.hexToBytes=C0;var U0=(e,t="utf8")=>new TextDecoder(t).decode((0,ye.hexToBytes)(e));ye.hexToString=U0;var q0=e=>(0,ye.bytesToHex)(new TextEncoder().encode(e));ye.stringToHex=q0;ye.randomBytes=Qo.randomBytes;L0(Br(),ye)});var fs=V(U=>{"use strict";B();A();Object.defineProperty(U,"__esModule",{value:!0});U.bytes=U.stringToBytes=U.str=U.bytesToString=U.hex=U.utf8=U.bech32m=U.bech32=U.base58check=U.createBase58check=U.base58xmr=U.base58xrp=U.base58flickr=U.base58=U.base64urlnopad=U.base64url=U.base64nopad=U.base64=U.base32crockford=U.base32hexnopad=U.base32hex=U.base32nopad=U.base32=U.base16=U.utils=U.assertNumber=void 0;function Nt(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function rs(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function Sr(e){if(typeof e!="function")throw new Error("function expected");return!0}function Mt(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Ht(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}U.assertNumber=Ht;function An(e){if(!Array.isArray(e))throw new Error("array expected")}function vn(e,t){if(!rs(!0,t))throw new Error(`${e}: array of strings expected`)}function Hr(e,t){if(!rs(!1,t))throw new Error(`${e}: array of numbers expected`)}function Oe(...e){let t=s=>s,n=(s,i)=>c=>s(i(c)),r=e.map(s=>s.encode).reduceRight(n,t),o=e.map(s=>s.decode).reduce(n,t);return{encode:r,decode:o}}function qe(e){let t=typeof e=="string"?e.split(""):e,n=t.length;vn("alphabet",t);let r=new Map(t.map((o,s)=>[o,s]));return{encode:o=>(An(o),o.map(s=>{if(!Number.isSafeInteger(s)||s<0||s>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${s}". Allowed: ${e}`);return t[s]})),decode:o=>(An(o),o.map(s=>{Mt("alphabet.decode",s);let i=r.get(s);if(i===void 0)throw new Error(`Unknown letter: "${s}". Allowed: ${e}`);return i}))}}function Re(e=""){return Mt("join",e),{encode:t=>(vn("join.decode",t),t.join(e)),decode:t=>(Mt("join.decode",t),t.split(e))}}function Jt(e,t="="){return Ht(e),Mt("padding",t),{encode(n){for(vn("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){vn("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}function os(e){return Sr(e),{encode:t=>t,decode:t=>e(t)}}function Ar(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(An(e),!e.length)return[];let r=0,o=[],s=Array.from(e,c=>{if(Ht(c),c<0||c>=t)throw new Error(`invalid integer: ${c}`);return c}),i=s.length;for(;;){let c=0,a=!0;for(let u=r;u<i;u++){let d=s[u],f=t*c,l=f+d;if(!Number.isSafeInteger(l)||f/t!==c||l-d!==f)throw new Error("convertRadix: carry overflow");let y=l/n;c=l%n;let E=Math.floor(y);if(s[u]=E,!Number.isSafeInteger(E)||E*n+c!==l)throw new Error("convertRadix: carry overflow");if(a)E?a=!1:r=u;else continue}if(o.push(c),a)break}for(let c=0;c<e.length-1&&e[c]===0;c++)o.push(0);return o.reverse()}var ss=(e,t)=>t===0?e:ss(t,e%t),Sn=(e,t)=>e+(t-ss(e,t)),Bn=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function Hn(e,t,n,r){if(An(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Sn(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Sn(t,n)}`);let o=0,s=0,i=Bn[t],c=Bn[n]-1,a=[];for(let u of e){if(Ht(u),u>=i)throw new Error(`convertRadix2: invalid data word=${u} from=${t}`);if(o=o<<t|u,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=n;s-=n)a.push((o>>s-n&c)>>>0);let d=Bn[s];if(d===void 0)throw new Error("invalid carry");o&=d-1}if(o=o<<n-s&c,!r&&s>=t)throw new Error("Excess padding");if(!r&&o>0)throw new Error(`Non-zero padding: ${o}`);return r&&s>0&&a.push(o>>>0),a}function is(e){Ht(e);let t=2**8;return{encode:n=>{if(!Nt(n))throw new Error("radix.encode input should be Uint8Array");return Ar(Array.from(n),t,e)},decode:n=>(Hr("radix.decode",n),Uint8Array.from(Ar(n,e,t)))}}function ke(e,t=!1){if(Ht(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Sn(8,e)>32||Sn(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Nt(n))throw new Error("radix2.encode input should be Uint8Array");return Hn(Array.from(n),8,e,!t)},decode:n=>(Hr("radix2.decode",n),Uint8Array.from(Hn(n,e,8,t)))}}function Jo(e){return Sr(e),function(...t){try{return e.apply(null,t)}catch{}}}function cs(e,t){return Ht(e),Sr(t),{encode(n){if(!Nt(n))throw new Error("checksum.encode: input should be Uint8Array");let r=t(n).slice(0,e),o=new Uint8Array(n.length+e);return o.set(n),o.set(r,n.length),o},decode(n){if(!Nt(n))throw new Error("checksum.decode: input should be Uint8Array");let r=n.slice(0,-e),o=n.slice(-e),s=t(r).slice(0,e);for(let i=0;i<e;i++)if(s[i]!==o[i])throw new Error("Invalid checksum");return r}}}U.utils={alphabet:qe,chain:Oe,checksum:cs,convertRadix:Ar,convertRadix2:Hn,radix:is,radix2:ke,join:Re,padding:Jt};U.base16=Oe(ke(4),qe("0123456789ABCDEF"),Re(""));U.base32=Oe(ke(5),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Jt(5),Re(""));U.base32nopad=Oe(ke(5),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Re(""));U.base32hex=Oe(ke(5),qe("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Jt(5),Re(""));U.base32hexnopad=Oe(ke(5),qe("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Re(""));U.base32crockford=Oe(ke(5),qe("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Re(""),os(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));U.base64=Oe(ke(6),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Jt(6),Re(""));U.base64nopad=Oe(ke(6),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Re(""));U.base64url=Oe(ke(6),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Jt(6),Re(""));U.base64urlnopad=Oe(ke(6),qe("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Re(""));var Ir=e=>Oe(is(58),qe(e),Re(""));U.base58=Ir("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");U.base58flickr=Ir("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");U.base58xrp=Ir("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");var es=[0,2,3,5,6,7,9,10,11];U.base58xmr={encode(e){let t="";for(let n=0;n<e.length;n+=8){let r=e.subarray(n,n+8);t+=U.base58.encode(r).padStart(es[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){let r=e.slice(n,n+11),o=es.indexOf(r.length),s=U.base58.decode(r);for(let i=0;i<s.length-o;i++)if(s[i]!==0)throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(s.slice(s.length-o)))}return Uint8Array.from(t)}};var R0=e=>Oe(cs(4,t=>e(e(t))),U.base58);U.createBase58check=R0;U.base58check=U.createBase58check;var vr=Oe(qe("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Re("")),ts=[996825010,642813549,513874426,1027748829,705979059];function Qt(e){let t=e>>25,n=(e&33554431)<<5;for(let r=0;r<ts.length;r++)(t>>r&1)===1&&(n^=ts[r]);return n}function ns(e,t,n=1){let r=e.length,o=1;for(let s=0;s<r;s++){let i=e.charCodeAt(s);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);o=Qt(o)^i>>5}o=Qt(o);for(let s=0;s<r;s++)o=Qt(o)^e.charCodeAt(s)&31;for(let s of t)o=Qt(o)^s;for(let s=0;s<6;s++)o=Qt(o);return o^=n,vr.encode(Hn([o%Bn[30]],30,5,!1))}function as(e){let t=e==="bech32"?1:734539939,n=ke(5),r=n.decode,o=n.encode,s=Jo(r);function i(f,l,y=90){Mt("bech32.encode prefix",f),Nt(l)&&(l=Array.from(l)),Hr("bech32.encode",l);let E=f.length;if(E===0)throw new TypeError(`Invalid prefix length ${E}`);let x=E+7+l.length;if(y!==!1&&x>y)throw new TypeError(`Length ${x} exceeds limit ${y}`);let b=f.toLowerCase(),w=ns(b,l,t);return`${b}1${vr.encode(l)}${w}`}function c(f,l=90){Mt("bech32.decode input",f);let y=f.length;if(y<8||l!==!1&&y>l)throw new TypeError(`invalid string length: ${y} (${f}). Expected (8..${l})`);let E=f.toLowerCase();if(f!==E&&f!==f.toUpperCase())throw new Error("String must be lowercase or uppercase");let x=E.lastIndexOf("1");if(x===0||x===-1)throw new Error('Letter "1" must be present between prefix and data only');let b=E.slice(0,x),w=E.slice(x+1);if(w.length<6)throw new Error("Data must be at least 6 characters long");let g=vr.decode(w).slice(0,-6),h=ns(b,g,t);if(!w.endsWith(h))throw new Error(`Invalid checksum in ${f}: expected "${h}"`);return{prefix:b,words:g}}let a=Jo(c);function u(f){let{prefix:l,words:y}=c(f,!1);return{prefix:l,words:y,bytes:r(y)}}function d(f,l){return i(f,o(l))}return{encode:i,decode:c,encodeFromBytes:d,decodeToBytes:u,decodeUnsafe:a,fromWords:r,fromWordsUnsafe:s,toWords:o}}U.bech32=as("bech32");U.bech32m=as("bech32m");U.utf8={encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)};U.hex=Oe(ke(4),qe("0123456789abcdef"),Re(""),os(e=>{if(typeof e!="string"||e.length%2!==0)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}));var In={utf8:U.utf8,hex:U.hex,base16:U.base16,base32:U.base32,base64:U.base64,base64url:U.base64url,base58:U.base58,base58xmr:U.base58xmr},ds="Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr",P0=(e,t)=>{if(typeof e!="string"||!In.hasOwnProperty(e))throw new TypeError(ds);if(!Nt(t))throw new TypeError("bytesToString() expects Uint8Array");return In[e].encode(t)};U.bytesToString=P0;U.str=U.bytesToString;var D0=(e,t)=>{if(!In.hasOwnProperty(e))throw new TypeError(ds);if(typeof t!="string")throw new TypeError("stringToBytes() expects string");return In[e].decode(t)};U.stringToBytes=D0;U.bytes=U.stringToBytes});var Tr=V(Ce=>{"use strict";B();A();Object.defineProperty(Ce,"__esModule",{value:!0});Ce.SHA512_IV=Ce.SHA384_IV=Ce.SHA224_IV=Ce.SHA256_IV=Ce.HashMD=void 0;Ce.setBigUint64=us;Ce.Chi=N0;Ce.Maj=M0;var Ye=Dt();function us(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,u=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+u,c,r)}function N0(e,t,n){return e&t^~e&n}function M0(e,t,n){return e&t^e&n^t&n}var Lr=class extends Ye.Hash{constructor(t,n,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=(0,Ye.createView)(this.buffer)}update(t){(0,Ye.aexists)(this),t=(0,Ye.toBytes)(t),(0,Ye.abytes)(t);let{view:n,buffer:r,blockLen:o}=this,s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let a=(0,Ye.createView)(t);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,Ye.aexists)(this),(0,Ye.aoutput)(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,(0,Ye.clean)(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(r,0),i=0);for(let f=i;f<o;f++)n[f]=0;us(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=(0,Ye.createView)(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=a/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)c.setUint32(4*f,d[f],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.destroyed=i,t.finished=s,t.length=o,t.pos=c,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}};Ce.HashMD=Lr;Ce.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);Ce.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]);Ce.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]);Ce.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});var Us=V($=>{"use strict";B();A();Object.defineProperty($,"__esModule",{value:!0});$.toBig=$.shrSL=$.shrSH=$.rotrSL=$.rotrSH=$.rotrBL=$.rotrBH=$.rotr32L=$.rotr32H=$.rotlSL=$.rotlSH=$.rotlBL=$.rotlBH=$.add5L=$.add5H=$.add4L=$.add4H=$.add3L=$.add3H=void 0;$.add=Ss;$.fromBig=Cr;$.split=ls;var Ln=BigInt(2**32-1),Or=BigInt(32);function Cr(e,t=!1){return t?{h:Number(e&Ln),l:Number(e>>Or&Ln)}:{h:Number(e>>Or&Ln)|0,l:Number(e&Ln)|0}}function ls(e,t=!1){let n=e.length,r=new Uint32Array(n),o=new Uint32Array(n);for(let s=0;s<n;s++){let{h:i,l:c}=Cr(e[s],t);[r[s],o[s]]=[i,c]}return[r,o]}var hs=(e,t)=>BigInt(e>>>0)<<Or|BigInt(t>>>0);$.toBig=hs;var bs=(e,t,n)=>e>>>n;$.shrSH=bs;var ys=(e,t,n)=>e<<32-n|t>>>n;$.shrSL=ys;var xs=(e,t,n)=>e>>>n|t<<32-n;$.rotrSH=xs;var gs=(e,t,n)=>e<<32-n|t>>>n;$.rotrSL=gs;var ps=(e,t,n)=>e<<64-n|t>>>n-32;$.rotrBH=ps;var ws=(e,t,n)=>e>>>n-32|t<<64-n;$.rotrBL=ws;var ms=(e,t)=>t;$.rotr32H=ms;var _s=(e,t)=>e;$.rotr32L=_s;var Es=(e,t,n)=>e<<n|t>>>32-n;$.rotlSH=Es;var Bs=(e,t,n)=>t<<n|e>>>32-n;$.rotlSL=Bs;var As=(e,t,n)=>t<<n-32|e>>>64-n;$.rotlBH=As;var vs=(e,t,n)=>e<<n-32|t>>>64-n;$.rotlBL=vs;function Ss(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var Hs=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);$.add3L=Hs;var Is=(e,t,n,r)=>t+n+r+(e/2**32|0)|0;$.add3H=Is;var Ls=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0);$.add4L=Ls;var Ts=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0;$.add4H=Ts;var Os=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0);$.add5L=Os;var Cs=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;$.add5H=Cs;var j0={fromBig:Cr,split:ls,toBig:hs,shrSH:bs,shrSL:ys,rotrSH:xs,rotrSL:gs,rotrBH:ps,rotrBL:ws,rotr32H:ms,rotr32L:_s,rotlSH:Es,rotlSL:Bs,rotlBH:As,rotlBL:vs,add:Ss,add3L:Hs,add3H:Is,add4L:Ls,add4H:Ts,add5H:Cs,add5L:Os};$.default=j0});var Ur=V(de=>{"use strict";B();A();Object.defineProperty(de,"__esModule",{value:!0});de.sha512_224=de.sha512_256=de.sha384=de.sha512=de.sha224=de.sha256=de.SHA512_256=de.SHA512_224=de.SHA384=de.SHA512=de.SHA224=de.SHA256=void 0;var P=Tr(),F=Us(),he=Dt(),V0=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ct=new Uint32Array(64),en=class extends P.HashMD{constructor(t=32){super(64,t,8,!1),this.A=P.SHA256_IV[0]|0,this.B=P.SHA256_IV[1]|0,this.C=P.SHA256_IV[2]|0,this.D=P.SHA256_IV[3]|0,this.E=P.SHA256_IV[4]|0,this.F=P.SHA256_IV[5]|0,this.G=P.SHA256_IV[6]|0,this.H=P.SHA256_IV[7]|0}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:a}=this;return[t,n,r,o,s,i,c,a]}set(t,n,r,o,s,i,c,a){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(t,n){for(let f=0;f<16;f++,n+=4)ct[f]=t.getUint32(n,!1);for(let f=16;f<64;f++){let l=ct[f-15],y=ct[f-2],E=(0,he.rotr)(l,7)^(0,he.rotr)(l,18)^l>>>3,x=(0,he.rotr)(y,17)^(0,he.rotr)(y,19)^y>>>10;ct[f]=x+ct[f-7]+E+ct[f-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:a,G:u,H:d}=this;for(let f=0;f<64;f++){let l=(0,he.rotr)(c,6)^(0,he.rotr)(c,11)^(0,he.rotr)(c,25),y=d+l+(0,P.Chi)(c,a,u)+V0[f]+ct[f]|0,x=((0,he.rotr)(r,2)^(0,he.rotr)(r,13)^(0,he.rotr)(r,22))+(0,P.Maj)(r,o,s)|0;d=u,u=a,a=c,c=i+y|0,i=s,s=o,o=r,r=y+x|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(r,o,s,i,c,a,u,d)}roundClean(){(0,he.clean)(ct)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,he.clean)(this.buffer)}};de.SHA256=en;var Tn=class extends en{constructor(){super(28),this.A=P.SHA224_IV[0]|0,this.B=P.SHA224_IV[1]|0,this.C=P.SHA224_IV[2]|0,this.D=P.SHA224_IV[3]|0,this.E=P.SHA224_IV[4]|0,this.F=P.SHA224_IV[5]|0,this.G=P.SHA224_IV[6]|0,this.H=P.SHA224_IV[7]|0}};de.SHA224=Tn;var qs=(()=>F.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),k0=(()=>qs[0])(),$0=(()=>qs[1])(),at=new Uint32Array(80),dt=new Uint32Array(80),It=class extends P.HashMD{constructor(t=64){super(128,t,16,!1),this.Ah=P.SHA512_IV[0]|0,this.Al=P.SHA512_IV[1]|0,this.Bh=P.SHA512_IV[2]|0,this.Bl=P.SHA512_IV[3]|0,this.Ch=P.SHA512_IV[4]|0,this.Cl=P.SHA512_IV[5]|0,this.Dh=P.SHA512_IV[6]|0,this.Dl=P.SHA512_IV[7]|0,this.Eh=P.SHA512_IV[8]|0,this.El=P.SHA512_IV[9]|0,this.Fh=P.SHA512_IV[10]|0,this.Fl=P.SHA512_IV[11]|0,this.Gh=P.SHA512_IV[12]|0,this.Gl=P.SHA512_IV[13]|0,this.Hh=P.SHA512_IV[14]|0,this.Hl=P.SHA512_IV[15]|0}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:a,Eh:u,El:d,Fh:f,Fl:l,Gh:y,Gl:E,Hh:x,Hl:b}=this;return[t,n,r,o,s,i,c,a,u,d,f,l,y,E,x,b]}set(t,n,r,o,s,i,c,a,u,d,f,l,y,E,x,b){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=a|0,this.Eh=u|0,this.El=d|0,this.Fh=f|0,this.Fl=l|0,this.Gh=y|0,this.Gl=E|0,this.Hh=x|0,this.Hl=b|0}process(t,n){for(let h=0;h<16;h++,n+=4)at[h]=t.getUint32(n),dt[h]=t.getUint32(n+=4);for(let h=16;h<80;h++){let _=at[h-15]|0,I=dt[h-15]|0,S=F.rotrSH(_,I,1)^F.rotrSH(_,I,8)^F.shrSH(_,I,7),L=F.rotrSL(_,I,1)^F.rotrSL(_,I,8)^F.shrSL(_,I,7),H=at[h-2]|0,O=dt[h-2]|0,te=F.rotrSH(H,O,19)^F.rotrBH(H,O,61)^F.shrSH(H,O,6),N=F.rotrSL(H,O,19)^F.rotrBL(H,O,61)^F.shrSL(H,O,6),Z=F.add4L(L,N,dt[h-7],dt[h-16]),ie=F.add4H(Z,S,te,at[h-7],at[h-16]);at[h]=ie|0,dt[h]=Z|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:a,Dh:u,Dl:d,Eh:f,El:l,Fh:y,Fl:E,Gh:x,Gl:b,Hh:w,Hl:g}=this;for(let h=0;h<80;h++){let _=F.rotrSH(f,l,14)^F.rotrSH(f,l,18)^F.rotrBH(f,l,41),I=F.rotrSL(f,l,14)^F.rotrSL(f,l,18)^F.rotrBL(f,l,41),S=f&y^~f&x,L=l&E^~l&b,H=F.add5L(g,I,L,$0[h],dt[h]),O=F.add5H(H,w,_,S,k0[h],at[h]),te=H|0,N=F.rotrSH(r,o,28)^F.rotrBH(r,o,34)^F.rotrBH(r,o,39),Z=F.rotrSL(r,o,28)^F.rotrBL(r,o,34)^F.rotrBL(r,o,39),ie=r&s^r&c^s&c,T=o&i^o&a^i&a;w=x|0,g=b|0,x=y|0,b=E|0,y=f|0,E=l|0,{h:f,l}=F.add(u|0,d|0,O|0,te|0),u=c|0,d=a|0,c=s|0,a=i|0,s=r|0,i=o|0;let q=F.add3L(te,Z,T);r=F.add3H(q,O,N,ie),o=q|0}({h:r,l:o}=F.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=F.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:a}=F.add(this.Ch|0,this.Cl|0,c|0,a|0),{h:u,l:d}=F.add(this.Dh|0,this.Dl|0,u|0,d|0),{h:f,l}=F.add(this.Eh|0,this.El|0,f|0,l|0),{h:y,l:E}=F.add(this.Fh|0,this.Fl|0,y|0,E|0),{h:x,l:b}=F.add(this.Gh|0,this.Gl|0,x|0,b|0),{h:w,l:g}=F.add(this.Hh|0,this.Hl|0,w|0,g|0),this.set(r,o,s,i,c,a,u,d,f,l,y,E,x,b,w,g)}roundClean(){(0,he.clean)(at,dt)}destroy(){(0,he.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};de.SHA512=It;var On=class extends It{constructor(){super(48),this.Ah=P.SHA384_IV[0]|0,this.Al=P.SHA384_IV[1]|0,this.Bh=P.SHA384_IV[2]|0,this.Bl=P.SHA384_IV[3]|0,this.Ch=P.SHA384_IV[4]|0,this.Cl=P.SHA384_IV[5]|0,this.Dh=P.SHA384_IV[6]|0,this.Dl=P.SHA384_IV[7]|0,this.Eh=P.SHA384_IV[8]|0,this.El=P.SHA384_IV[9]|0,this.Fh=P.SHA384_IV[10]|0,this.Fl=P.SHA384_IV[11]|0,this.Gh=P.SHA384_IV[12]|0,this.Gl=P.SHA384_IV[13]|0,this.Hh=P.SHA384_IV[14]|0,this.Hl=P.SHA384_IV[15]|0}};de.SHA384=On;var He=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),Ie=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]),Cn=class extends It{constructor(){super(28),this.Ah=He[0]|0,this.Al=He[1]|0,this.Bh=He[2]|0,this.Bl=He[3]|0,this.Ch=He[4]|0,this.Cl=He[5]|0,this.Dh=He[6]|0,this.Dl=He[7]|0,this.Eh=He[8]|0,this.El=He[9]|0,this.Fh=He[10]|0,this.Fl=He[11]|0,this.Gh=He[12]|0,this.Gl=He[13]|0,this.Hh=He[14]|0,this.Hl=He[15]|0}};de.SHA512_224=Cn;var Un=class extends It{constructor(){super(32),this.Ah=Ie[0]|0,this.Al=Ie[1]|0,this.Bh=Ie[2]|0,this.Bl=Ie[3]|0,this.Ch=Ie[4]|0,this.Cl=Ie[5]|0,this.Dh=Ie[6]|0,this.Dl=Ie[7]|0,this.Eh=Ie[8]|0,this.El=Ie[9]|0,this.Fh=Ie[10]|0,this.Fl=Ie[11]|0,this.Gh=Ie[12]|0,this.Gl=Ie[13]|0,this.Hh=Ie[14]|0,this.Hl=Ie[15]|0}};de.SHA512_256=Un;de.sha256=(0,he.createHasher)(()=>new en);de.sha224=(0,he.createHasher)(()=>new Tn);de.sha512=(0,he.createHasher)(()=>new It);de.sha384=(0,he.createHasher)(()=>new On);de.sha512_256=(0,he.createHasher)(()=>new Un);de.sha512_224=(0,he.createHasher)(()=>new Cn)});var Rs=V(Qe=>{"use strict";B();A();Object.defineProperty(Qe,"__esModule",{value:!0});Qe.sha224=Qe.SHA224=Qe.sha256=Qe.SHA256=void 0;var qn=Ur();Qe.SHA256=qn.SHA256;Qe.sha256=qn.sha256;Qe.SHA224=qn.SHA224;Qe.sha224=qn.sha224});var Ps=V(qr=>{"use strict";B();A();Object.defineProperty(qr,"__esModule",{value:!0});function G0(e){return Array.isArray(e)?new Uint8Array(e):e}qr.default=G0});var Rn=V(tn=>{"use strict";B();A();var K0=tn&&tn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tn,"__esModule",{value:!0});var Ds=K0(Ps());function Z0(e){function t(n){return e((0,Ds.default)(n))}return t.create=()=>{let n=e.create();return{update(r){return n.update((0,Ds.default)(r)),this},digest(){return n.digest()}}},t}tn.default=Z0});var Rr=V(jt=>{"use strict";B();A();var F0=jt&&jt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jt,"__esModule",{value:!0});jt.sha256=void 0;var X0=Rs(),z0=F0(Rn());jt.sha256=(0,z0.default)(X0.sha256)});var Ns=V(Vt=>{"use strict";B();A();Object.defineProperty(Vt,"__esModule",{value:!0});Vt.concatArgs=Vt.arrayEqual=void 0;function W0(e,t){return e.length!==t.length?!1:e.every((n,r)=>n===t[r])}Vt.arrayEqual=W0;function Y0(e){return typeof e=="number"}function Q0(...e){return e.flatMap(t=>Y0(t)?[t]:Array.from(t))}Vt.concatArgs=Q0});var Zs=V(fe=>{"use strict";B();A();Object.defineProperty(fe,"__esModule",{value:!0});fe.isValidClassicAddress=fe.decodeAccountPublic=fe.encodeAccountPublic=fe.encodeNodePublic=fe.decodeNodePublic=fe.decodeAddress=fe.decodeAccountID=fe.encodeAddress=fe.encodeAccountID=fe.decodeSeed=fe.encodeSeed=fe.codec=void 0;var J0=fs(),ea=Rr(),Pn=Ns(),Pr=class{constructor(t){this._sha256=t.sha256,this._codec=J0.base58xrp}encode(t,n){let r=n.versions;return this._encodeVersioned(t,r,n.expectedLength)}decode(t,n){var r;let o=n.versions,s=n.versionTypes,i=this.decodeChecked(t);if(o.length>1&&!n.expectedLength)throw new Error("expectedLength is required because there are >= 2 possible versions");let c=typeof o[0]=="number"?1:o[0].length,a=(r=n.expectedLength)!==null&&r!==void 0?r:i.length-c,u=i.slice(0,-a),d=i.slice(-a);for(let f=0;f<o.length;f++){let l=Array.isArray(o[f])?o[f]:[o[f]];if((0,Pn.arrayEqual)(u,l))return{version:l,bytes:d,type:s?s[f]:null}}throw new Error("version_invalid: version bytes do not match any of the provided version(s)")}encodeChecked(t){let n=this._sha256(this._sha256(t)).slice(0,4);return this._encodeRaw(Uint8Array.from((0,Pn.concatArgs)(t,n)))}decodeChecked(t){let n=this._decodeRaw(t);if(n.byteLength<5)throw new Error("invalid_input_size: decoded data must have length >= 5");if(!this._verifyCheckSum(n))throw new Error("checksum_invalid");return n.slice(0,-4)}_encodeVersioned(t,n,r){if(!Ks(t,r))throw new Error("unexpected_payload_length: bytes.length does not match expectedLength. Ensure that the bytes are a Uint8Array.");return this.encodeChecked((0,Pn.concatArgs)(n,t))}_encodeRaw(t){return this._codec.encode(Uint8Array.from(t))}_decodeRaw(t){return this._codec.decode(t)}_verifyCheckSum(t){let n=this._sha256(this._sha256(t.slice(0,-4))).slice(0,4),r=t.slice(-4);return(0,Pn.arrayEqual)(n,r)}},Ms=0,js=35,Vs=33,ks=28,$s=[1,225,75],ta={sha256:ea.sha256},rt=new Pr(ta);fe.codec=rt;function na(e,t){if(!Ks(e,16))throw new Error("entropy must have length 16");let n={expectedLength:16,versions:t==="ed25519"?$s:[Vs]};return rt.encode(e,n)}fe.encodeSeed=na;function ra(e,t={versionTypes:["ed25519","secp256k1"],versions:[$s,Vs],expectedLength:16}){return rt.decode(e,t)}fe.decodeSeed=ra;function Gs(e){let t={versions:[Ms],expectedLength:20};return rt.encode(e,t)}fe.encodeAccountID=Gs;fe.encodeAddress=Gs;function Dr(e){let t={versions:[Ms],expectedLength:20};return rt.decode(e,t).bytes}fe.decodeAccountID=Dr;fe.decodeAddress=Dr;function oa(e){let t={versions:[ks],expectedLength:33};return rt.decode(e,t).bytes}fe.decodeNodePublic=oa;function sa(e){let t={versions:[ks],expectedLength:33};return rt.encode(e,t)}fe.encodeNodePublic=sa;function ia(e){let t={versions:[js],expectedLength:33};return rt.encode(e,t)}fe.encodeAccountPublic=ia;function ca(e){let t={versions:[js],expectedLength:33};return rt.decode(e,t).bytes}fe.decodeAccountPublic=ca;function aa(e){try{Dr(e)}catch{return!1}return!0}fe.isValidClassicAddress=aa;function Ks(e,t){return"byteLength"in e?e.byteLength===t:e.length===t}});var Xs=V(ee=>{"use strict";B();A();Object.defineProperty(ee,"__esModule",{value:!0});ee.isValidXAddress=ee.decodeXAddress=ee.xAddressToClassicAddress=ee.encodeXAddress=ee.classicAddressToXAddress=ee.isValidClassicAddress=ee.decodeAccountPublic=ee.encodeAccountPublic=ee.decodeNodePublic=ee.encodeNodePublic=ee.decodeAccountID=ee.encodeAccountID=ee.decodeSeed=ee.encodeSeed=ee.codec=void 0;var nn=Yt(),Pe=Zs();Object.defineProperty(ee,"codec",{enumerable:!0,get:function(){return Pe.codec}});Object.defineProperty(ee,"encodeSeed",{enumerable:!0,get:function(){return Pe.encodeSeed}});Object.defineProperty(ee,"decodeSeed",{enumerable:!0,get:function(){return Pe.decodeSeed}});Object.defineProperty(ee,"encodeAccountID",{enumerable:!0,get:function(){return Pe.encodeAccountID}});Object.defineProperty(ee,"decodeAccountID",{enumerable:!0,get:function(){return Pe.decodeAccountID}});Object.defineProperty(ee,"encodeNodePublic",{enumerable:!0,get:function(){return Pe.encodeNodePublic}});Object.defineProperty(ee,"decodeNodePublic",{enumerable:!0,get:function(){return Pe.decodeNodePublic}});Object.defineProperty(ee,"encodeAccountPublic",{enumerable:!0,get:function(){return Pe.encodeAccountPublic}});Object.defineProperty(ee,"decodeAccountPublic",{enumerable:!0,get:function(){return Pe.decodeAccountPublic}});Object.defineProperty(ee,"isValidClassicAddress",{enumerable:!0,get:function(){return Pe.isValidClassicAddress}});var Dn={main:Uint8Array.from([5,68]),test:Uint8Array.from([4,147])},da=4294967295;function fa(e,t,n){let r=(0,Pe.decodeAccountID)(e);return Fs(r,t,n)}ee.classicAddressToXAddress=fa;function Fs(e,t,n){if(e.length!==20)throw new Error("Account ID must be 20 bytes");if(t!==!1&&t>da)throw new Error("Invalid tag");let r=t||0,o=t===!1||t==null?0:1,s=(0,nn.concat)([n?Dn.test:Dn.main,e,Uint8Array.from([o,r&255,r>>8&255,r>>16&255,r>>24&255,0,0,0,0])]);return Pe.codec.encodeChecked(s)}ee.encodeXAddress=Fs;function ua(e){let{accountId:t,tag:n,test:r}=Nr(e);return{classicAddress:(0,Pe.encodeAccountID)(t),tag:n,test:r}}ee.xAddressToClassicAddress=ua;function Nr(e){let t=Pe.codec.decodeChecked(e),n=la(t),r=t.slice(2,22),o=ha(t);return{accountId:r,tag:o,test:n}}ee.decodeXAddress=Nr;function la(e){let t=e.slice(0,2);if((0,nn.equal)(Dn.main,t))return!1;if((0,nn.equal)(Dn.test,t))return!0;throw new Error("Invalid X-address: bad prefix")}function ha(e){let t=e[22];if(t>=2)throw new Error("Unsupported X-address");if(t===1)return e[23]+e[24]*256+e[25]*65536+e[26]*16777216;if(t!==0)throw new Error("flag must be zero to indicate no tag");if(!(0,nn.equal)((0,nn.hexToBytes)("0000000000000000"),e.slice(23,23+8)))throw new Error("remaining bytes must be zero");return!1}function ba(e){try{Nr(e)}catch{return!1}return!0}ee.isValidXAddress=ba});var ti=V(De=>{"use strict";B();A();Object.defineProperty(De,"__esModule",{value:!0});De.ripemd160=De.RIPEMD160=De.md5=De.MD5=De.sha1=De.SHA1=void 0;var Lt=Tr(),Ae=Dt(),kt=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),ft=new Uint32Array(80),jn=class extends Lt.HashMD{constructor(){super(64,20,8,!1),this.A=kt[0]|0,this.B=kt[1]|0,this.C=kt[2]|0,this.D=kt[3]|0,this.E=kt[4]|0}get(){let{A:t,B:n,C:r,D:o,E:s}=this;return[t,n,r,o,s]}set(t,n,r,o,s){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0}process(t,n){for(let a=0;a<16;a++,n+=4)ft[a]=t.getUint32(n,!1);for(let a=16;a<80;a++)ft[a]=(0,Ae.rotl)(ft[a-3]^ft[a-8]^ft[a-14]^ft[a-16],1);let{A:r,B:o,C:s,D:i,E:c}=this;for(let a=0;a<80;a++){let u,d;a<20?(u=(0,Lt.Chi)(o,s,i),d=1518500249):a<40?(u=o^s^i,d=1859775393):a<60?(u=(0,Lt.Maj)(o,s,i),d=2400959708):(u=o^s^i,d=3395469782);let f=(0,Ae.rotl)(r,5)+u+c+d+ft[a]|0;c=i,i=s,s=(0,Ae.rotl)(o,30),o=r,r=f}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,this.set(r,o,s,i,c)}roundClean(){(0,Ae.clean)(ft)}destroy(){this.set(0,0,0,0,0),(0,Ae.clean)(this.buffer)}};De.SHA1=jn;De.sha1=(0,Ae.createHasher)(()=>new jn);var ya=Math.pow(2,32),xa=Array.from({length:64},(e,t)=>Math.floor(ya*Math.abs(Math.sin(t+1)))),Nn=kt.slice(0,4),Mr=new Uint32Array(16),Vn=class extends Lt.HashMD{constructor(){super(64,16,8,!0),this.A=Nn[0]|0,this.B=Nn[1]|0,this.C=Nn[2]|0,this.D=Nn[3]|0}get(){let{A:t,B:n,C:r,D:o}=this;return[t,n,r,o]}set(t,n,r,o){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0}process(t,n){for(let c=0;c<16;c++,n+=4)Mr[c]=t.getUint32(n,!0);let{A:r,B:o,C:s,D:i}=this;for(let c=0;c<64;c++){let a,u,d;c<16?(a=(0,Lt.Chi)(o,s,i),u=c,d=[7,12,17,22]):c<32?(a=(0,Lt.Chi)(i,o,s),u=(5*c+1)%16,d=[5,9,14,20]):c<48?(a=o^s^i,u=(3*c+5)%16,d=[4,11,16,23]):(a=s^(o|~i),u=7*c%16,d=[6,10,15,21]),a=a+r+xa[c]+Mr[u],r=i,i=s,s=o,o=o+(0,Ae.rotl)(a,d[c%4])}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,this.set(r,o,s,i)}roundClean(){(0,Ae.clean)(Mr)}destroy(){this.set(0,0,0,0),(0,Ae.clean)(this.buffer)}};De.MD5=Vn;De.md5=(0,Ae.createHasher)(()=>new Vn);var ga=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Ws=(()=>Uint8Array.from(new Array(16).fill(0).map((e,t)=>t)))(),pa=(()=>Ws.map(e=>(9*e+5)%16))(),Ys=(()=>{let n=[[Ws],[pa]];for(let r=0;r<4;r++)for(let o of n)o.push(o[r].map(s=>ga[s]));return n})(),Qs=(()=>Ys[0])(),Js=(()=>Ys[1])(),ei=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),wa=Qs.map((e,t)=>e.map(n=>ei[t][n])),ma=Js.map((e,t)=>e.map(n=>ei[t][n])),_a=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),Ea=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function zs(e,t,n,r){return e===0?t^n^r:e===1?t&n|~t&r:e===2?(t|~n)^r:e===3?t&r|n&~r:t^(n|~r)}var Mn=new Uint32Array(16),kn=class extends Lt.HashMD{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:t,h1:n,h2:r,h3:o,h4:s}=this;return[t,n,r,o,s]}set(t,n,r,o,s){this.h0=t|0,this.h1=n|0,this.h2=r|0,this.h3=o|0,this.h4=s|0}process(t,n){for(let y=0;y<16;y++,n+=4)Mn[y]=t.getUint32(n,!0);let r=this.h0|0,o=r,s=this.h1|0,i=s,c=this.h2|0,a=c,u=this.h3|0,d=u,f=this.h4|0,l=f;for(let y=0;y<5;y++){let E=4-y,x=_a[y],b=Ea[y],w=Qs[y],g=Js[y],h=wa[y],_=ma[y];for(let I=0;I<16;I++){let S=(0,Ae.rotl)(r+zs(y,s,c,u)+Mn[w[I]]+x,h[I])+f|0;r=f,f=u,u=(0,Ae.rotl)(c,10)|0,c=s,s=S}for(let I=0;I<16;I++){let S=(0,Ae.rotl)(o+zs(E,i,a,d)+Mn[g[I]]+b,_[I])+l|0;o=l,l=d,d=(0,Ae.rotl)(a,10)|0,a=i,i=S}}this.set(this.h1+c+d|0,this.h2+u+l|0,this.h3+f+o|0,this.h4+r+i|0,this.h0+s+a|0)}roundClean(){(0,Ae.clean)(Mn)}destroy(){this.destroyed=!0,(0,Ae.clean)(this.buffer),this.set(0,0,0,0,0)}};De.RIPEMD160=kn;De.ripemd160=(0,Ae.createHasher)(()=>new kn)});var ri=V($t=>{"use strict";B();A();Object.defineProperty($t,"__esModule",{value:!0});$t.ripemd160=$t.RIPEMD160=void 0;var ni=ti();$t.RIPEMD160=ni.RIPEMD160;$t.ripemd160=ni.ripemd160});var oi=V(Gt=>{"use strict";B();A();var Ba=Gt&&Gt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.ripemd160=void 0;var Aa=ri(),va=Ba(Rn());Gt.ripemd160=(0,va.default)(Aa.ripemd160)});var Gn=V(Je=>{"use strict";B();A();Object.defineProperty(Je,"__esModule",{value:!0});Je.isBytes=ii;Je.number=$n;Je.bool=si;Je.bytes=jr;Je.hash=ci;Je.exists=ai;Je.output=di;function $n(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function si(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function ii(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function jr(e,...t){if(!ii(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function ci(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");$n(e.outputLen),$n(e.blockLen)}function ai(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function di(e,t){jr(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var Sa={number:$n,bool:si,bytes:jr,hash:ci,exists:ai,output:di};Je.default=Sa});var fi=V(Kn=>{"use strict";B();A();Object.defineProperty(Kn,"__esModule",{value:!0});Kn.crypto=void 0;Kn.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var ut=V(z=>{"use strict";B();A();Object.defineProperty(z,"__esModule",{value:!0});z.Hash=z.nextTick=z.byteSwapIfBE=z.byteSwap=z.isLE=z.rotl=z.rotr=z.createView=z.u32=z.u8=void 0;z.isBytes=Ha;z.byteSwap32=qa;z.bytesToHex=Pa;z.hexToBytes=Da;z.asyncLoop=Ma;z.utf8ToBytes=li;z.toBytes=Zn;z.concatBytes=ja;z.checkOpts=ka;z.wrapConstructor=$a;z.wrapConstructorWithOpts=Ga;z.wrapXOFConstructorWithOpts=Ka;z.randomBytes=Za;var Kt=fi(),kr=Gn();function Ha(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}var Ia=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);z.u8=Ia;var La=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));z.u32=La;var Ta=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);z.createView=Ta;var Oa=(e,t)=>e<<32-t|e>>>t;z.rotr=Oa;var Ca=(e,t)=>e<<t|e>>>32-t>>>0;z.rotl=Ca;z.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var Ua=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;z.byteSwap=Ua;z.byteSwapIfBE=z.isLE?e=>e:e=>(0,z.byteSwap)(e);function qa(e){for(let t=0;t<e.length;t++)e[t]=(0,z.byteSwap)(e[t])}var Ra=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Pa(e){(0,kr.bytes)(e);let t="";for(let n=0;n<e.length;n++)t+=Ra[e[n]];return t}var ot={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function ui(e){if(e>=ot._0&&e<=ot._9)return e-ot._0;if(e>=ot._A&&e<=ot._F)return e-(ot._A-10);if(e>=ot._a&&e<=ot._f)return e-(ot._a-10)}function Da(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=ui(e.charCodeAt(s)),c=ui(e.charCodeAt(s+1));if(i===void 0||c===void 0){let a=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+s)}r[o]=i*16+c}return r}var Na=async()=>{};z.nextTick=Na;async function Ma(e,t,n){let r=Date.now();for(let o=0;o<e;o++){n(o);let s=Date.now()-r;s>=0&&s<t||(await(0,z.nextTick)(),r+=s)}}function li(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Zn(e){return typeof e=="string"&&(e=li(e)),(0,kr.bytes)(e),e}function ja(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];(0,kr.bytes)(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}var Vr=class{clone(){return this._cloneInto()}};z.Hash=Vr;var Va={}.toString;function ka(e,t){if(t!==void 0&&Va.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function $a(e){let t=r=>e().update(Zn(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Ga(e){let t=(r,o)=>e(o).update(Zn(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Ka(e){let t=(r,o)=>e(o).update(Zn(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Za(e=32){if(Kt.crypto&&typeof Kt.crypto.getRandomValues=="function")return Kt.crypto.getRandomValues(new Uint8Array(e));if(Kt.crypto&&typeof Kt.crypto.randomBytes=="function")return Kt.crypto.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}});var Kr=V(lt=>{"use strict";B();A();Object.defineProperty(lt,"__esModule",{value:!0});lt.HashMD=lt.Maj=lt.Chi=void 0;var $r=Gn(),rn=ut();function Fa(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),a=r?4:0,u=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+u,c,r)}var Xa=(e,t,n)=>e&t^~e&n;lt.Chi=Xa;var za=(e,t,n)=>e&t^e&n^t&n;lt.Maj=za;var Gr=class extends rn.Hash{constructor(t,n,r,o){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,rn.createView)(this.buffer)}update(t){(0,$r.exists)(this);let{view:n,buffer:r,blockLen:o}=this;t=(0,rn.toBytes)(t);let s=t.length;for(let i=0;i<s;){let c=Math.min(o-this.pos,s-i);if(c===o){let a=(0,rn.createView)(t);for(;o<=s-i;i+=o)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,$r.exists)(this),(0,$r.output)(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(r,0),i=0);for(let f=i;f<o;f++)n[f]=0;Fa(r,o-8,BigInt(this.length*8),s),this.process(r,0);let c=(0,rn.createView)(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=a/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)c.setUint32(4*f,d[f],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.length=o,t.pos=c,t.finished=s,t.destroyed=i,o%n&&t.buffer.set(r),t}};lt.HashMD=Gr});var hi=V(yt=>{"use strict";B();A();Object.defineProperty(yt,"__esModule",{value:!0});yt.sha224=yt.sha256=yt.SHA256=void 0;var Zr=Kr(),Fe=ut(),Wa=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ht=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),bt=new Uint32Array(64),on=class extends Zr.HashMD{constructor(){super(64,32,8,!1),this.A=ht[0]|0,this.B=ht[1]|0,this.C=ht[2]|0,this.D=ht[3]|0,this.E=ht[4]|0,this.F=ht[5]|0,this.G=ht[6]|0,this.H=ht[7]|0}get(){let{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:a}=this;return[t,n,r,o,s,i,c,a]}set(t,n,r,o,s,i,c,a){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=a|0}process(t,n){for(let f=0;f<16;f++,n+=4)bt[f]=t.getUint32(n,!1);for(let f=16;f<64;f++){let l=bt[f-15],y=bt[f-2],E=(0,Fe.rotr)(l,7)^(0,Fe.rotr)(l,18)^l>>>3,x=(0,Fe.rotr)(y,17)^(0,Fe.rotr)(y,19)^y>>>10;bt[f]=x+bt[f-7]+E+bt[f-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:a,G:u,H:d}=this;for(let f=0;f<64;f++){let l=(0,Fe.rotr)(c,6)^(0,Fe.rotr)(c,11)^(0,Fe.rotr)(c,25),y=d+l+(0,Zr.Chi)(c,a,u)+Wa[f]+bt[f]|0,x=((0,Fe.rotr)(r,2)^(0,Fe.rotr)(r,13)^(0,Fe.rotr)(r,22))+(0,Zr.Maj)(r,o,s)|0;d=u,u=a,a=c,c=i+y|0,i=s,s=o,o=r,r=y+x|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,a=a+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(r,o,s,i,c,a,u,d)}roundClean(){bt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};yt.SHA256=on;var Fr=class extends on{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};yt.sha256=(0,Fe.wrapConstructor)(()=>new on);yt.sha224=(0,Fe.wrapConstructor)(()=>new Fr)});var yi=V(Tt=>{"use strict";B();A();Object.defineProperty(Tt,"__esModule",{value:!0});Tt.hmac=Tt.HMAC=void 0;var Fn=Gn(),bi=ut(),sn=class extends bi.Hash{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,(0,Fn.hash)(t);let r=(0,bi.toBytes)(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,Fn.exists)(this),this.iHash.update(t),this}digestInto(t){(0,Fn.exists)(this),(0,Fn.bytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};Tt.HMAC=sn;var Ya=(e,t,n)=>new sn(e,t).update(n).digest();Tt.hmac=Ya;Tt.hmac.create=(e,t)=>new sn(e,t)});var $e=V(re=>{"use strict";B();A();Object.defineProperty(re,"__esModule",{value:!0});re.notImplemented=re.bitMask=void 0;re.isBytes=zn;re.abytes=Wn;re.abool=Ja;re.bytesToHex=Yr;re.numberToHexUnpadded=pi;re.hexToNumber=Qr;re.hexToBytes=Yn;re.bytesToNumberBE=td;re.bytesToNumberLE=nd;re.numberToBytesBE=wi;re.numberToBytesLE=rd;re.numberToVarBytesBE=od;re.ensureBytes=sd;re.concatBytes=mi;re.equalBytes=id;re.utf8ToBytes=cd;re.inRange=_i;re.aInRange=ad;re.bitLen=dd;re.bitGet=fd;re.bitSet=ud;re.createHmacDrbg=hd;re.validateObject=yd;re.memoized=gd;var Wr=BigInt(0),Xn=BigInt(1),Qa=BigInt(2);function zn(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function Wn(e){if(!zn(e))throw new Error("Uint8Array expected")}function Ja(e,t){if(typeof t!="boolean")throw new Error(`${e} must be valid boolean, got "${t}".`)}var ed=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Yr(e){Wn(e);let t="";for(let n=0;n<e.length;n++)t+=ed[e[n]];return t}function pi(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function Qr(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}var st={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function xi(e){if(e>=st._0&&e<=st._9)return e-st._0;if(e>=st._A&&e<=st._F)return e-(st._A-10);if(e>=st._a&&e<=st._f)return e-(st._a-10)}function Yn(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=xi(e.charCodeAt(s)),c=xi(e.charCodeAt(s+1));if(i===void 0||c===void 0){let a=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+s)}r[o]=i*16+c}return r}function td(e){return Qr(Yr(e))}function nd(e){return Wn(e),Qr(Yr(Uint8Array.from(e).reverse()))}function wi(e,t){return Yn(e.toString(16).padStart(t*2,"0"))}function rd(e,t){return wi(e,t).reverse()}function od(e){return Yn(pi(e))}function sd(e,t,n){let r;if(typeof t=="string")try{r=Yn(t)}catch(s){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${s}`)}else if(zn(t))r=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);let o=r.length;if(typeof n=="number"&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function mi(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];Wn(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}function id(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function cd(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}var Xr=e=>typeof e=="bigint"&&Wr<=e;function _i(e,t,n){return Xr(e)&&Xr(t)&&Xr(n)&&t<=e&&e<n}function ad(e,t,n,r){if(!_i(t,n,r))throw new Error(`expected valid ${e}: ${n} <= n < ${r}, got ${typeof t} ${t}`)}function dd(e){let t;for(t=0;e>Wr;e>>=Xn,t+=1);return t}function fd(e,t){return e>>BigInt(t)&Xn}function ud(e,t,n){return e|(n?Xn:Wr)<<BigInt(t)}var ld=e=>(Qa<<BigInt(e-1))-Xn;re.bitMask=ld;var zr=e=>new Uint8Array(e),gi=e=>Uint8Array.from(e);function hd(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");let r=zr(e),o=zr(e),s=0,i=()=>{r.fill(1),o.fill(0),s=0},c=(...f)=>n(o,r,...f),a=(f=zr())=>{o=c(gi([0]),f),r=c(),f.length!==0&&(o=c(gi([1]),f),r=c())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let f=0,l=[];for(;f<t;){r=c();let y=r.slice();l.push(y),f+=r.length}return mi(...l)};return(f,l)=>{i(),a(f);let y;for(;!(y=l(u()));)a();return i(),y}}var bd={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||zn(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function yd(e,t,n={}){let r=(o,s,i)=>{let c=bd[s];if(typeof c!="function")throw new Error(`Invalid validator "${s}", expected function`);let a=e[o];if(!(i&&a===void 0)&&!c(a,e))throw new Error(`Invalid param ${String(o)}=${a} (${typeof a}), expected ${s}`)};for(let[o,s]of Object.entries(t))r(o,s,!1);for(let[o,s]of Object.entries(n))r(o,s,!0);return e}var xd=()=>{throw new Error("not implemented")};re.notImplemented=xd;function gd(e){let t=new WeakMap;return(n,...r)=>{let o=t.get(n);if(o!==void 0)return o;let s=e(n,...r);return t.set(n,s),s}}});var gt=V(ue=>{"use strict";B();A();Object.defineProperty(ue,"__esModule",{value:!0});ue.isNegativeLE=void 0;ue.mod=Ge;ue.pow=Ai;ue.pow2=_d;ue.invert=Qn;ue.tonelliShanks=vi;ue.FpSqrt=Si;ue.validateField=Ad;ue.FpPow=Hi;ue.FpInvertBatch=Ii;ue.FpDiv=vd;ue.FpLegendre=Li;ue.FpIsSquare=Sd;ue.nLength=eo;ue.Field=Hd;ue.FpSqrtOdd=Id;ue.FpSqrtEven=Ld;ue.hashToPrivateScalar=Td;ue.getFieldBytesLength=to;ue.getMinHashLength=Ti;ue.mapHashToField=Od;var Ke=$e(),xe=BigInt(0),ce=BigInt(1),xt=BigInt(2),pd=BigInt(3),Jr=BigInt(4),Ei=BigInt(5),Bi=BigInt(8),wd=BigInt(9),md=BigInt(16);function Ge(e,t){let n=e%t;return n>=xe?n:t+n}function Ai(e,t,n){if(n<=xe||t<xe)throw new Error("Expected power/modulo > 0");if(n===ce)return xe;let r=ce;for(;t>xe;)t&ce&&(r=r*e%n),e=e*e%n,t>>=ce;return r}function _d(e,t,n){let r=e;for(;t-- >xe;)r*=r,r%=n;return r}function Qn(e,t){if(e===xe||t<=xe)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=Ge(e,t),r=t,o=xe,s=ce,i=ce,c=xe;for(;n!==xe;){let u=r/n,d=r%n,f=o-i*u,l=s-c*u;r=n,n=d,o=i,s=c,i=f,c=l}if(r!==ce)throw new Error("invert: does not exist");return Ge(o,t)}function vi(e){let t=(e-ce)/xt,n,r,o;for(n=e-ce,r=0;n%xt===xe;n/=xt,r++);for(o=xt;o<e&&Ai(o,t,e)!==e-ce;o++);if(r===1){let i=(e+ce)/Jr;return function(a,u){let d=a.pow(u,i);if(!a.eql(a.sqr(d),u))throw new Error("Cannot find square root");return d}}let s=(n+ce)/xt;return function(c,a){if(c.pow(a,t)===c.neg(c.ONE))throw new Error("Cannot find square root");let u=r,d=c.pow(c.mul(c.ONE,o),n),f=c.pow(a,s),l=c.pow(a,n);for(;!c.eql(l,c.ONE);){if(c.eql(l,c.ZERO))return c.ZERO;let y=1;for(let x=c.sqr(l);y<u&&!c.eql(x,c.ONE);y++)x=c.sqr(x);let E=c.pow(d,ce<<BigInt(u-y-1));d=c.sqr(E),f=c.mul(f,E),l=c.mul(l,d),u=y}return f}}function Si(e){if(e%Jr===pd){let t=(e+ce)/Jr;return function(r,o){let s=r.pow(o,t);if(!r.eql(r.sqr(s),o))throw new Error("Cannot find square root");return s}}if(e%Bi===Ei){let t=(e-Ei)/Bi;return function(r,o){let s=r.mul(o,xt),i=r.pow(s,t),c=r.mul(o,i),a=r.mul(r.mul(c,xt),i),u=r.mul(c,r.sub(a,r.ONE));if(!r.eql(r.sqr(u),o))throw new Error("Cannot find square root");return u}}return e%md,vi(e)}var Ed=(e,t)=>(Ge(e,t)&ce)===ce;ue.isNegativeLE=Ed;var Bd=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ad(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Bd.reduce((r,o)=>(r[o]="function",r),t);return(0,Ke.validateObject)(e,n)}function Hi(e,t,n){if(n<xe)throw new Error("Expected power > 0");if(n===xe)return e.ONE;if(n===ce)return t;let r=e.ONE,o=t;for(;n>xe;)n&ce&&(r=e.mul(r,o)),o=e.sqr(o),n>>=ce;return r}function Ii(e,t){let n=new Array(t.length),r=t.reduce((s,i,c)=>e.is0(i)?s:(n[c]=s,e.mul(s,i)),e.ONE),o=e.inv(r);return t.reduceRight((s,i,c)=>e.is0(i)?s:(n[c]=e.mul(s,n[c]),e.mul(s,i)),o),n}function vd(e,t,n){return e.mul(t,typeof n=="bigint"?Qn(n,e.ORDER):e.inv(n))}function Li(e){let t=(e-ce)/xt;return(n,r)=>n.pow(r,t)}function Sd(e){let t=Li(e.ORDER);return n=>{let r=t(e,n);return e.eql(r,e.ZERO)||e.eql(r,e.ONE)}}function eo(e,t){let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Hd(e,t,n=!1,r={}){if(e<=xe)throw new Error(`Expected Field ORDER > 0, got ${e}`);let{nBitLength:o,nByteLength:s}=eo(e,t);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");let i=Si(e),c=Object.freeze({ORDER:e,BITS:o,BYTES:s,MASK:(0,Ke.bitMask)(o),ZERO:xe,ONE:ce,create:a=>Ge(a,e),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return xe<=a&&a<e},is0:a=>a===xe,isOdd:a=>(a&ce)===ce,neg:a=>Ge(-a,e),eql:(a,u)=>a===u,sqr:a=>Ge(a*a,e),add:(a,u)=>Ge(a+u,e),sub:(a,u)=>Ge(a-u,e),mul:(a,u)=>Ge(a*u,e),pow:(a,u)=>Hi(c,a,u),div:(a,u)=>Ge(a*Qn(u,e),e),sqrN:a=>a*a,addN:(a,u)=>a+u,subN:(a,u)=>a-u,mulN:(a,u)=>a*u,inv:a=>Qn(a,e),sqrt:r.sqrt||(a=>i(c,a)),invertBatch:a=>Ii(c,a),cmov:(a,u,d)=>d?u:a,toBytes:a=>n?(0,Ke.numberToBytesLE)(a,s):(0,Ke.numberToBytesBE)(a,s),fromBytes:a=>{if(a.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${a.length}`);return n?(0,Ke.bytesToNumberLE)(a):(0,Ke.bytesToNumberBE)(a)}});return Object.freeze(c)}function Id(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?n:e.neg(n)}function Ld(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");let n=e.sqrt(t);return e.isOdd(n)?e.neg(n):n}function Td(e,t,n=!1){e=(0,Ke.ensureBytes)("privateHash",e);let r=e.length,o=eo(t).nByteLength+8;if(o<24||r<o||r>1024)throw new Error(`hashToPrivateScalar: expected ${o}-1024 bytes of input, got ${r}`);let s=n?(0,Ke.bytesToNumberLE)(e):(0,Ke.bytesToNumberBE)(e);return Ge(s,t-ce)+ce}function to(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function Ti(e){let t=to(e);return t+Math.ceil(t/2)}function Od(e,t,n=!1){let r=e.length,o=to(t),s=Ti(t);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);let i=n?(0,Ke.bytesToNumberBE)(e):(0,Ke.bytesToNumberLE)(e),c=Ge(i,t-ce)+ce;return n?(0,Ke.numberToBytesLE)(c,o):(0,Ke.numberToBytesBE)(c,o)}});var oo=V(cn=>{"use strict";B();A();Object.defineProperty(cn,"__esModule",{value:!0});cn.wNAF=Ud;cn.pippenger=qd;cn.validateBasic=Rd;var Oi=gt(),Ui=$e(),Cd=BigInt(0),no=BigInt(1),ro=new WeakMap,Ci=new WeakMap;function Ud(e,t){let n=(s,i)=>{let c=i.negate();return s?c:i},r=s=>{if(!Number.isSafeInteger(s)||s<=0||s>t)throw new Error(`Wrong window size=${s}, should be [1..${t}]`)},o=s=>{r(s);let i=Math.ceil(t/s)+1,c=2**(s-1);return{windows:i,windowSize:c}};return{constTimeNegate:n,unsafeLadder(s,i){let c=e.ZERO,a=s;for(;i>Cd;)i&no&&(c=c.add(a)),a=a.double(),i>>=no;return c},precomputeWindow(s,i){let{windows:c,windowSize:a}=o(i),u=[],d=s,f=d;for(let l=0;l<c;l++){f=d,u.push(f);for(let y=1;y<a;y++)f=f.add(d),u.push(f);d=f.double()}return u},wNAF(s,i,c){let{windows:a,windowSize:u}=o(s),d=e.ZERO,f=e.BASE,l=BigInt(2**s-1),y=2**s,E=BigInt(s);for(let x=0;x<a;x++){let b=x*u,w=Number(c&l);c>>=E,w>u&&(w-=y,c+=no);let g=b,h=b+Math.abs(w)-1,_=x%2!==0,I=w<0;w===0?f=f.add(n(_,i[g])):d=d.add(n(I,i[h]))}return{p:d,f}},wNAFCached(s,i,c){let a=Ci.get(s)||1,u=ro.get(s);return u||(u=this.precomputeWindow(s,a),a!==1&&ro.set(s,c(u))),this.wNAF(a,u,i)},setWindowSize(s,i){r(i),Ci.set(s,i),ro.delete(s)}}}function qd(e,t,n,r){if(!Array.isArray(n)||!Array.isArray(r)||r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");r.forEach((d,f)=>{if(!t.isValid(d))throw new Error(`wrong scalar at index ${f}`)}),n.forEach((d,f)=>{if(!(d instanceof e))throw new Error(`wrong point at index ${f}`)});let o=(0,Ui.bitLen)(BigInt(n.length)),s=o>12?o-3:o>4?o-2:o?2:1,i=(1<<s)-1,c=new Array(i+1).fill(e.ZERO),a=Math.floor((t.BITS-1)/s)*s,u=e.ZERO;for(let d=a;d>=0;d-=s){c.fill(e.ZERO);for(let l=0;l<r.length;l++){let y=r[l],E=Number(y>>BigInt(d)&BigInt(i));c[E]=c[E].add(n[l])}let f=e.ZERO;for(let l=c.length-1,y=e.ZERO;l>0;l--)y=y.add(c[l]),f=f.add(y);if(u=u.add(f),d!==0)for(let l=0;l<s;l++)u=u.double()}return u}function Rd(e){return(0,Oi.validateField)(e.Fp),(0,Ui.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,Oi.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}});var so=V(Se=>{"use strict";B();A();Object.defineProperty(Se,"__esModule",{value:!0});Se.DER=void 0;Se.weierstrassPoints=Pi;Se.weierstrass=jd;Se.SWUFpSqrtRatio=Di;Se.mapToCurveSimpleSWU=Vd;var Jn=oo(),Ot=gt(),J=$e(),ve=$e();function qi(e){e.lowS!==void 0&&(0,ve.abool)("lowS",e.lowS),e.prehash!==void 0&&(0,ve.abool)("prehash",e.prehash)}function Pd(e){let t=(0,Jn.validateBasic)(e);J.validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof n!="object"||typeof n.beta!="bigint"||typeof n.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}var{bytesToNumberBE:Dd,hexToBytes:Nd}=J;Se.DER={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(e,t)=>{let{Err:n}=Se.DER;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");let r=t.length/2,o=J.numberToHexUnpadded(r);if(o.length/2&128)throw new n("tlv.encode: long form length too big");let s=r>127?J.numberToHexUnpadded(o.length/2|128):"";return`${J.numberToHexUnpadded(e)}${s}${o}${t}`},decode(e,t){let{Err:n}=Se.DER,r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");let o=t[r++],s=!!(o&128),i=0;if(!s)i=o;else{let a=o&127;if(!a)throw new n("tlv.decode(long): indefinite length not supported");if(a>4)throw new n("tlv.decode(long): byte length is too big");let u=t.subarray(r,r+a);if(u.length!==a)throw new n("tlv.decode: length bytes not complete");if(u[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(let d of u)i=i<<8|d;if(r+=a,i<128)throw new n("tlv.decode(long): not minimal encoding")}let c=t.subarray(r,r+i);if(c.length!==i)throw new n("tlv.decode: wrong value length");return{v:c,l:t.subarray(r+i)}}},_int:{encode(e){let{Err:t}=Se.DER;if(e<ze)throw new t("integer: negative integers are not allowed");let n=J.numberToHexUnpadded(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected assertion");return n},decode(e){let{Err:t}=Se.DER;if(e[0]&128)throw new t("Invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return Dd(e)}},toSig(e){let{Err:t,_int:n,_tlv:r}=Se.DER,o=typeof e=="string"?Nd(e):e;J.abytes(o);let{v:s,l:i}=r.decode(48,o);if(i.length)throw new t("Invalid signature: left bytes after parsing");let{v:c,l:a}=r.decode(2,s),{v:u,l:d}=r.decode(2,a);if(d.length)throw new t("Invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(u)}},hexFromSig(e){let{_tlv:t,_int:n}=Se.DER,r=`${t.encode(2,n.encode(e.r))}${t.encode(2,n.encode(e.s))}`;return t.encode(48,r)}};var ze=BigInt(0),se=BigInt(1),pt=BigInt(2),er=BigInt(3),Ri=BigInt(4);function Pi(e){let t=Pd(e),{Fp:n}=t,r=Ot.Field(t.n,t.nBitLength),o=t.toBytes||((x,b,w)=>{let g=b.toAffine();return J.concatBytes(Uint8Array.from([4]),n.toBytes(g.x),n.toBytes(g.y))}),s=t.fromBytes||(x=>{let b=x.subarray(1),w=n.fromBytes(b.subarray(0,n.BYTES)),g=n.fromBytes(b.subarray(n.BYTES,2*n.BYTES));return{x:w,y:g}});function i(x){let{a:b,b:w}=t,g=n.sqr(x),h=n.mul(g,x);return n.add(n.add(h,n.mul(x,b)),w)}if(!n.eql(n.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function c(x){return J.inRange(x,se,t.n)}function a(x){let{allowedPrivateKeyLengths:b,nByteLength:w,wrapPrivateKey:g,n:h}=t;if(b&&typeof x!="bigint"){if(J.isBytes(x)&&(x=J.bytesToHex(x)),typeof x!="string"||!b.includes(x.length))throw new Error("Invalid key");x=x.padStart(w*2,"0")}let _;try{_=typeof x=="bigint"?x:J.bytesToNumberBE((0,ve.ensureBytes)("private key",x,w))}catch{throw new Error(`private key must be ${w} bytes, hex or bigint, not ${typeof x}`)}return g&&(_=Ot.mod(_,h)),J.aInRange("private key",_,se,h),_}function u(x){if(!(x instanceof l))throw new Error("ProjectivePoint expected")}let d=(0,ve.memoized)((x,b)=>{let{px:w,py:g,pz:h}=x;if(n.eql(h,n.ONE))return{x:w,y:g};let _=x.is0();b==null&&(b=_?n.ONE:n.inv(h));let I=n.mul(w,b),S=n.mul(g,b),L=n.mul(h,b);if(_)return{x:n.ZERO,y:n.ZERO};if(!n.eql(L,n.ONE))throw new Error("invZ was invalid");return{x:I,y:S}}),f=(0,ve.memoized)(x=>{if(x.is0()){if(t.allowInfinityPoint&&!n.is0(x.py))return;throw new Error("bad point: ZERO")}let{x:b,y:w}=x.toAffine();if(!n.isValid(b)||!n.isValid(w))throw new Error("bad point: x or y not FE");let g=n.sqr(w),h=i(b);if(!n.eql(g,h))throw new Error("bad point: equation left != right");if(!x.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class l{constructor(b,w,g){if(this.px=b,this.py=w,this.pz=g,b==null||!n.isValid(b))throw new Error("x required");if(w==null||!n.isValid(w))throw new Error("y required");if(g==null||!n.isValid(g))throw new Error("z required");Object.freeze(this)}static fromAffine(b){let{x:w,y:g}=b||{};if(!b||!n.isValid(w)||!n.isValid(g))throw new Error("invalid affine point");if(b instanceof l)throw new Error("projective point not allowed");let h=_=>n.eql(_,n.ZERO);return h(w)&&h(g)?l.ZERO:new l(w,g,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(b){let w=n.invertBatch(b.map(g=>g.pz));return b.map((g,h)=>g.toAffine(w[h])).map(l.fromAffine)}static fromHex(b){let w=l.fromAffine(s((0,ve.ensureBytes)("pointHex",b)));return w.assertValidity(),w}static fromPrivateKey(b){return l.BASE.multiply(a(b))}static msm(b,w){return(0,Jn.pippenger)(l,r,b,w)}_setWindowSize(b){E.setWindowSize(this,b)}assertValidity(){f(this)}hasEvenY(){let{y:b}=this.toAffine();if(n.isOdd)return!n.isOdd(b);throw new Error("Field doesn't support isOdd")}equals(b){u(b);let{px:w,py:g,pz:h}=this,{px:_,py:I,pz:S}=b,L=n.eql(n.mul(w,S),n.mul(_,h)),H=n.eql(n.mul(g,S),n.mul(I,h));return L&&H}negate(){return new l(this.px,n.neg(this.py),this.pz)}double(){let{a:b,b:w}=t,g=n.mul(w,er),{px:h,py:_,pz:I}=this,S=n.ZERO,L=n.ZERO,H=n.ZERO,O=n.mul(h,h),te=n.mul(_,_),N=n.mul(I,I),Z=n.mul(h,_);return Z=n.add(Z,Z),H=n.mul(h,I),H=n.add(H,H),S=n.mul(b,H),L=n.mul(g,N),L=n.add(S,L),S=n.sub(te,L),L=n.add(te,L),L=n.mul(S,L),S=n.mul(Z,S),H=n.mul(g,H),N=n.mul(b,N),Z=n.sub(O,N),Z=n.mul(b,Z),Z=n.add(Z,H),H=n.add(O,O),O=n.add(H,O),O=n.add(O,N),O=n.mul(O,Z),L=n.add(L,O),N=n.mul(_,I),N=n.add(N,N),O=n.mul(N,Z),S=n.sub(S,O),H=n.mul(N,te),H=n.add(H,H),H=n.add(H,H),new l(S,L,H)}add(b){u(b);let{px:w,py:g,pz:h}=this,{px:_,py:I,pz:S}=b,L=n.ZERO,H=n.ZERO,O=n.ZERO,te=t.a,N=n.mul(t.b,er),Z=n.mul(w,_),ie=n.mul(g,I),T=n.mul(h,S),q=n.add(w,g),m=n.add(_,I);q=n.mul(q,m),m=n.add(Z,ie),q=n.sub(q,m),m=n.add(w,h);let p=n.add(_,S);return m=n.mul(m,p),p=n.add(Z,T),m=n.sub(m,p),p=n.add(g,h),L=n.add(I,S),p=n.mul(p,L),L=n.add(ie,T),p=n.sub(p,L),O=n.mul(te,m),L=n.mul(N,T),O=n.add(L,O),L=n.sub(ie,O),O=n.add(ie,O),H=n.mul(L,O),ie=n.add(Z,Z),ie=n.add(ie,Z),T=n.mul(te,T),m=n.mul(N,m),ie=n.add(ie,T),T=n.sub(Z,T),T=n.mul(te,T),m=n.add(m,T),Z=n.mul(ie,m),H=n.add(H,Z),Z=n.mul(p,m),L=n.mul(q,L),L=n.sub(L,Z),Z=n.mul(q,ie),O=n.mul(p,O),O=n.add(O,Z),new l(L,H,O)}subtract(b){return this.add(b.negate())}is0(){return this.equals(l.ZERO)}wNAF(b){return E.wNAFCached(this,b,l.normalizeZ)}multiplyUnsafe(b){J.aInRange("scalar",b,ze,t.n);let w=l.ZERO;if(b===ze)return w;if(b===se)return this;let{endo:g}=t;if(!g)return E.unsafeLadder(this,b);let{k1neg:h,k1:_,k2neg:I,k2:S}=g.splitScalar(b),L=w,H=w,O=this;for(;_>ze||S>ze;)_&se&&(L=L.add(O)),S&se&&(H=H.add(O)),O=O.double(),_>>=se,S>>=se;return h&&(L=L.negate()),I&&(H=H.negate()),H=new l(n.mul(H.px,g.beta),H.py,H.pz),L.add(H)}multiply(b){let{endo:w,n:g}=t;J.aInRange("scalar",b,se,g);let h,_;if(w){let{k1neg:I,k1:S,k2neg:L,k2:H}=w.splitScalar(b),{p:O,f:te}=this.wNAF(S),{p:N,f:Z}=this.wNAF(H);O=E.constTimeNegate(I,O),N=E.constTimeNegate(L,N),N=new l(n.mul(N.px,w.beta),N.py,N.pz),h=O.add(N),_=te.add(Z)}else{let{p:I,f:S}=this.wNAF(b);h=I,_=S}return l.normalizeZ([h,_])[0]}multiplyAndAddUnsafe(b,w,g){let h=l.BASE,_=(S,L)=>L===ze||L===se||!S.equals(h)?S.multiplyUnsafe(L):S.multiply(L),I=_(this,w).add(_(b,g));return I.is0()?void 0:I}toAffine(b){return d(this,b)}isTorsionFree(){let{h:b,isTorsionFree:w}=t;if(b===se)return!0;if(w)return w(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:b,clearCofactor:w}=t;return b===se?this:w?w(l,this):this.multiplyUnsafe(t.h)}toRawBytes(b=!0){return(0,ve.abool)("isCompressed",b),this.assertValidity(),o(l,this,b)}toHex(b=!0){return(0,ve.abool)("isCompressed",b),J.bytesToHex(this.toRawBytes(b))}}l.BASE=new l(t.Gx,t.Gy,n.ONE),l.ZERO=new l(n.ZERO,n.ONE,n.ZERO);let y=t.nBitLength,E=(0,Jn.wNAF)(l,t.endo?Math.ceil(y/2):y);return{CURVE:t,ProjectivePoint:l,normPrivateKeyToScalar:a,weierstrassEquation:i,isWithinCurveOrder:c}}function Md(e){let t=(0,Jn.validateBasic)(e);return J.validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function jd(e){let t=Md(e),{Fp:n,n:r}=t,o=n.BYTES+1,s=2*n.BYTES+1;function i(T){return Ot.mod(T,r)}function c(T){return Ot.invert(T,r)}let{ProjectivePoint:a,normPrivateKeyToScalar:u,weierstrassEquation:d,isWithinCurveOrder:f}=Pi({...t,toBytes(T,q,m){let p=q.toAffine(),v=n.toBytes(p.x),R=J.concatBytes;return(0,ve.abool)("isCompressed",m),m?R(Uint8Array.from([q.hasEvenY()?2:3]),v):R(Uint8Array.from([4]),v,n.toBytes(p.y))},fromBytes(T){let q=T.length,m=T[0],p=T.subarray(1);if(q===o&&(m===2||m===3)){let v=J.bytesToNumberBE(p);if(!J.inRange(v,se,n.ORDER))throw new Error("Point is not on curve");let R=d(v),M;try{M=n.sqrt(R)}catch(Q){let Y=Q instanceof Error?": "+Q.message:"";throw new Error("Point is not on curve"+Y)}let j=(M&se)===se;return(m&1)===1!==j&&(M=n.neg(M)),{x:v,y:M}}else if(q===s&&m===4){let v=n.fromBytes(p.subarray(0,n.BYTES)),R=n.fromBytes(p.subarray(n.BYTES,2*n.BYTES));return{x:v,y:R}}else throw new Error(`Point of length ${q} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),l=T=>J.bytesToHex(J.numberToBytesBE(T,t.nByteLength));function y(T){let q=r>>se;return T>q}function E(T){return y(T)?i(-T):T}let x=(T,q,m)=>J.bytesToNumberBE(T.slice(q,m));class b{constructor(q,m,p){this.r=q,this.s=m,this.recovery=p,this.assertValidity()}static fromCompact(q){let m=t.nByteLength;return q=(0,ve.ensureBytes)("compactSignature",q,m*2),new b(x(q,0,m),x(q,m,2*m))}static fromDER(q){let{r:m,s:p}=Se.DER.toSig((0,ve.ensureBytes)("DER",q));return new b(m,p)}assertValidity(){J.aInRange("r",this.r,se,r),J.aInRange("s",this.s,se,r)}addRecoveryBit(q){return new b(this.r,this.s,q)}recoverPublicKey(q){let{r:m,s:p,recovery:v}=this,R=S((0,ve.ensureBytes)("msgHash",q));if(v==null||![0,1,2,3].includes(v))throw new Error("recovery id invalid");let M=v===2||v===3?m+t.n:m;if(M>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");let j=(v&1)===0?"02":"03",W=a.fromHex(j+l(M)),Q=c(M),Y=i(-R*Q),ne=i(p*Q),ae=a.BASE.multiplyAndAddUnsafe(W,Y,ne);if(!ae)throw new Error("point at infinify");return ae.assertValidity(),ae}hasHighS(){return y(this.s)}normalizeS(){return this.hasHighS()?new b(this.r,i(-this.s),this.recovery):this}toDERRawBytes(){return J.hexToBytes(this.toDERHex())}toDERHex(){return Se.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return J.hexToBytes(this.toCompactHex())}toCompactHex(){return l(this.r)+l(this.s)}}let w={isValidPrivateKey(T){try{return u(T),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let T=Ot.getMinHashLength(t.n);return Ot.mapHashToField(t.randomBytes(T),t.n)},precompute(T=8,q=a.BASE){return q._setWindowSize(T),q.multiply(BigInt(3)),q}};function g(T,q=!0){return a.fromPrivateKey(T).toRawBytes(q)}function h(T){let q=J.isBytes(T),m=typeof T=="string",p=(q||m)&&T.length;return q?p===o||p===s:m?p===2*o||p===2*s:T instanceof a}function _(T,q,m=!0){if(h(T))throw new Error("first arg must be private key");if(!h(q))throw new Error("second arg must be public key");return a.fromHex(q).multiply(u(T)).toRawBytes(m)}let I=t.bits2int||function(T){let q=J.bytesToNumberBE(T),m=T.length*8-t.nBitLength;return m>0?q>>BigInt(m):q},S=t.bits2int_modN||function(T){return i(I(T))},L=J.bitMask(t.nBitLength);function H(T){return J.aInRange(`num < 2^${t.nBitLength}`,T,ze,L),J.numberToBytesBE(T,t.nByteLength)}function O(T,q,m=te){if(["recovered","canonical"].some(pe=>pe in m))throw new Error("sign() legacy options not supported");let{hash:p,randomBytes:v}=t,{lowS:R,prehash:M,extraEntropy:j}=m;R==null&&(R=!0),T=(0,ve.ensureBytes)("msgHash",T),qi(m),M&&(T=(0,ve.ensureBytes)("prehashed msgHash",p(T)));let W=S(T),Q=u(q),Y=[H(Q),H(W)];if(j!=null&&j!==!1){let pe=j===!0?v(n.BYTES):j;Y.push((0,ve.ensureBytes)("extraEntropy",pe))}let ne=J.concatBytes(...Y),ae=W;function ge(pe){let Be=I(pe);if(!f(Be))return;let Te=c(Be),be=a.BASE.multiply(Be).toAffine(),Ue=i(be.x);if(Ue===ze)return;let tt=i(Te*i(ae+Ue*Q));if(tt===ze)return;let zt=(be.x===Ue?0:2)|Number(be.y&se),Wt=tt;return R&&y(tt)&&(Wt=E(tt),zt^=1),new b(Ue,Wt,zt)}return{seed:ne,k2sig:ge}}let te={lowS:t.lowS,prehash:!1},N={lowS:t.lowS,prehash:!1};function Z(T,q,m=te){let{seed:p,k2sig:v}=O(T,q,m),R=t;return J.createHmacDrbg(R.hash.outputLen,R.nByteLength,R.hmac)(p,v)}a.BASE._setWindowSize(8);function ie(T,q,m,p=N){let v=T;if(q=(0,ve.ensureBytes)("msgHash",q),m=(0,ve.ensureBytes)("publicKey",m),"strict"in p)throw new Error("options.strict was renamed to lowS");qi(p);let{lowS:R,prehash:M}=p,j,W;try{if(typeof v=="string"||J.isBytes(v))try{j=b.fromDER(v)}catch(be){if(!(be instanceof Se.DER.Err))throw be;j=b.fromCompact(v)}else if(typeof v=="object"&&typeof v.r=="bigint"&&typeof v.s=="bigint"){let{r:be,s:Ue}=v;j=new b(be,Ue)}else throw new Error("PARSE");W=a.fromHex(m)}catch(be){if(be.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(R&&j.hasHighS())return!1;M&&(q=t.hash(q));let{r:Q,s:Y}=j,ne=S(q),ae=c(Y),ge=i(ne*ae),pe=i(Q*ae),Be=a.BASE.multiplyAndAddUnsafe(W,ge,pe)?.toAffine();return Be?i(Be.x)===Q:!1}return{CURVE:t,getPublicKey:g,getSharedSecret:_,sign:Z,verify:ie,ProjectivePoint:a,Signature:b,utils:w}}function Di(e,t){let n=e.ORDER,r=ze;for(let E=n-se;E%pt===ze;E/=pt)r+=se;let o=r,s=pt<<o-se-se,i=s*pt,c=(n-se)/i,a=(c-se)/pt,u=i-se,d=s,f=e.pow(t,c),l=e.pow(t,(c+se)/pt),y=(E,x)=>{let b=f,w=e.pow(x,u),g=e.sqr(w);g=e.mul(g,x);let h=e.mul(E,g);h=e.pow(h,a),h=e.mul(h,w),w=e.mul(h,x),g=e.mul(h,E);let _=e.mul(g,w);h=e.pow(_,d);let I=e.eql(h,e.ONE);w=e.mul(g,l),h=e.mul(_,b),g=e.cmov(w,g,I),_=e.cmov(h,_,I);for(let S=o;S>se;S--){let L=S-pt;L=pt<<L-se;let H=e.pow(_,L),O=e.eql(H,e.ONE);w=e.mul(g,b),b=e.mul(b,b),H=e.mul(_,b),g=e.cmov(w,g,O),_=e.cmov(H,_,O)}return{isValid:I,value:g}};if(e.ORDER%Ri===er){let E=(e.ORDER-er)/Ri,x=e.sqrt(e.neg(t));y=(b,w)=>{let g=e.sqr(w),h=e.mul(b,w);g=e.mul(g,h);let _=e.pow(g,E);_=e.mul(_,h);let I=e.mul(_,x),S=e.mul(e.sqr(_),w),L=e.eql(S,b),H=e.cmov(I,_,L);return{isValid:L,value:H}}}return y}function Vd(e,t){if(Ot.validateField(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let n=Di(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let o,s,i,c,a,u,d,f;o=e.sqr(r),o=e.mul(o,t.Z),s=e.sqr(o),s=e.add(s,o),i=e.add(s,e.ONE),i=e.mul(i,t.B),c=e.cmov(t.Z,e.neg(s),!e.eql(s,e.ZERO)),c=e.mul(c,t.A),s=e.sqr(i),u=e.sqr(c),a=e.mul(u,t.A),s=e.add(s,a),s=e.mul(s,i),u=e.mul(u,c),a=e.mul(u,t.B),s=e.add(s,a),d=e.mul(o,i);let{isValid:l,value:y}=n(s,u);f=e.mul(o,r),f=e.mul(f,y),d=e.cmov(d,i,l),f=e.cmov(f,y,l);let E=e.isOdd(r)===e.isOdd(f);return f=e.cmov(e.neg(f),f,E),d=e.div(d,c),{x:d,y:f}}}});var ji=V(tr=>{"use strict";B();A();Object.defineProperty(tr,"__esModule",{value:!0});tr.getHash=Mi;tr.createCurve=Gd;var kd=yi(),Ni=ut(),$d=so();function Mi(e){return{hash:e,hmac:(t,...n)=>(0,kd.hmac)(e,t,(0,Ni.concatBytes)(...n)),randomBytes:Ni.randomBytes}}function Gd(e,t){let n=r=>(0,$d.weierstrass)({...e,...Mi(r)});return Object.freeze({...n(t),create:n})}});var co=V(Ct=>{"use strict";B();A();Object.defineProperty(Ct,"__esModule",{value:!0});Ct.expand_message_xmd=Vi;Ct.expand_message_xof=ki;Ct.hash_to_field=io;Ct.isogenyMap=Xd;Ct.createHasher=zd;var Kd=gt(),Le=$e(),Zd=Le.bytesToNumberBE;function wt(e,t){if(an(e),an(t),e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);let n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=e&255,e>>>=8;return new Uint8Array(n)}function Fd(e,t){let n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}function an(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function Vi(e,t,n,r){(0,Le.abytes)(e),(0,Le.abytes)(t),an(n),t.length>255&&(t=r((0,Le.concatBytes)((0,Le.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:o,blockLen:s}=r,i=Math.ceil(n/o);if(n>65535||i>255)throw new Error("expand_message_xmd: invalid lenInBytes");let c=(0,Le.concatBytes)(t,wt(t.length,1)),a=wt(0,s),u=wt(n,2),d=new Array(i),f=r((0,Le.concatBytes)(a,e,u,wt(0,1),c));d[0]=r((0,Le.concatBytes)(f,wt(1,1),c));for(let y=1;y<=i;y++){let E=[Fd(f,d[y-1]),wt(y+1,1),c];d[y]=r((0,Le.concatBytes)(...E))}return(0,Le.concatBytes)(...d).slice(0,n)}function ki(e,t,n,r,o){if((0,Le.abytes)(e),(0,Le.abytes)(t),an(n),t.length>255){let s=Math.ceil(2*r/8);t=o.create({dkLen:s}).update((0,Le.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return o.create({dkLen:n}).update(e).update(wt(n,2)).update(t).update(wt(t.length,1)).digest()}function io(e,t,n){(0,Le.validateObject)(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:r,k:o,m:s,hash:i,expand:c,DST:a}=n;(0,Le.abytes)(e),an(t);let u=typeof a=="string"?(0,Le.utf8ToBytes)(a):a,d=r.toString(2).length,f=Math.ceil((d+o)/8),l=t*s*f,y;if(c==="xmd")y=Vi(e,u,l,i);else if(c==="xof")y=ki(e,u,l,o,i);else if(c==="_internal_pass")y=e;else throw new Error('expand must be "xmd" or "xof"');let E=new Array(t);for(let x=0;x<t;x++){let b=new Array(s);for(let w=0;w<s;w++){let g=f*(w+x*s),h=y.subarray(g,g+f);b[w]=(0,Kd.mod)(Zd(h),r)}E[x]=b}return E}function Xd(e,t){let n=t.map(r=>Array.from(r).reverse());return(r,o)=>{let[s,i,c,a]=n.map(u=>u.reduce((d,f)=>e.add(e.mul(d,r),f)));return r=e.div(s,i),o=e.mul(o,e.div(c,a)),{x:r,y:o}}}function zd(e,t,n){if(typeof t!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(r,o){let s=io(r,2,{...n,DST:n.DST,...o}),i=e.fromAffine(t(s[0])),c=e.fromAffine(t(s[1])),a=i.add(c).clearCofactor();return a.assertValidity(),a},encodeToCurve(r,o){let s=io(r,1,{...n,DST:n.encodeDST,...o}),i=e.fromAffine(t(s[0])).clearCofactor();return i.assertValidity(),i},mapToCurve(r){if(!Array.isArray(r))throw new Error("mapToCurve: expected array of bigints");for(let s of r)if(typeof s!="bigint")throw new Error(`mapToCurve: expected array of bigints, got ${s} in array`);let o=e.fromAffine(t(r)).clearCofactor();return o.assertValidity(),o}}}});var bo=V(Me=>{"use strict";B();A();Object.defineProperty(Me,"__esModule",{value:!0});Me.encodeToCurve=Me.hashToCurve=Me.schnorr=Me.secp256k1=void 0;var nr=hi(),Wd=ut(),Yd=ji(),Ki=co(),we=gt(),Ne=$e(),Qd=so(),un=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),rr=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),dn=BigInt(1),or=BigInt(2),$i=(e,t)=>(e+t/or)/t;function Zi(e){let t=un,n=BigInt(3),r=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),c=BigInt(44),a=BigInt(88),u=e*e*e%t,d=u*u*e%t,f=(0,we.pow2)(d,n,t)*d%t,l=(0,we.pow2)(f,n,t)*d%t,y=(0,we.pow2)(l,or,t)*u%t,E=(0,we.pow2)(y,o,t)*y%t,x=(0,we.pow2)(E,s,t)*E%t,b=(0,we.pow2)(x,c,t)*x%t,w=(0,we.pow2)(b,a,t)*b%t,g=(0,we.pow2)(w,c,t)*x%t,h=(0,we.pow2)(g,n,t)*d%t,_=(0,we.pow2)(h,i,t)*E%t,I=(0,we.pow2)(_,r,t)*u%t,S=(0,we.pow2)(I,or,t);if(!mt.eql(mt.sqr(S),e))throw new Error("Cannot find square root");return S}var mt=(0,we.Field)(un,void 0,void 0,{sqrt:Zi});Me.secp256k1=(0,Yd.createCurve)({a:BigInt(0),b:BigInt(7),Fp:mt,n:rr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=rr,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-dn*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,i=BigInt("0x100000000000000000000000000000000"),c=$i(s*e,t),a=$i(-r*e,t),u=(0,we.mod)(e-c*n-a*o,t),d=(0,we.mod)(-c*r-a*s,t),f=u>i,l=d>i;if(f&&(u=t-u),l&&(d=t-d),u>i||d>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:f,k1:u,k2neg:l,k2:d}}}},nr.sha256);var Fi=BigInt(0),Gi={};function sr(e,...t){let n=Gi[e];if(n===void 0){let r=(0,nr.sha256)(Uint8Array.from(e,o=>o.charCodeAt(0)));n=(0,Ne.concatBytes)(r,r),Gi[e]=n}return(0,nr.sha256)((0,Ne.concatBytes)(n,...t))}var lo=e=>e.toRawBytes(!0).slice(1),fo=e=>(0,Ne.numberToBytesBE)(e,32),ao=e=>(0,we.mod)(e,un),fn=e=>(0,we.mod)(e,rr),ho=Me.secp256k1.ProjectivePoint,Jd=(e,t,n)=>ho.BASE.multiplyAndAddUnsafe(e,t,n);function uo(e){let t=Me.secp256k1.utils.normPrivateKeyToScalar(e),n=ho.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:fn(-t),bytes:lo(n)}}function Xi(e){(0,Ne.aInRange)("x",e,dn,un);let t=ao(e*e),n=ao(t*e+BigInt(7)),r=Zi(n);r%or!==Fi&&(r=ao(-r));let o=new ho(e,r,dn);return o.assertValidity(),o}var Zt=Ne.bytesToNumberBE;function zi(...e){return fn(Zt(sr("BIP0340/challenge",...e)))}function ef(e){return uo(e).bytes}function tf(e,t,n=(0,Wd.randomBytes)(32)){let r=(0,Ne.ensureBytes)("message",e),{bytes:o,scalar:s}=uo(t),i=(0,Ne.ensureBytes)("auxRand",n,32),c=fo(s^Zt(sr("BIP0340/aux",i))),a=sr("BIP0340/nonce",c,o,r),u=fn(Zt(a));if(u===Fi)throw new Error("sign failed: k is zero");let{bytes:d,scalar:f}=uo(u),l=zi(d,o,r),y=new Uint8Array(64);if(y.set(d,0),y.set(fo(fn(f+l*s)),32),!Wi(y,r,o))throw new Error("sign: Invalid signature produced");return y}function Wi(e,t,n){let r=(0,Ne.ensureBytes)("signature",e,64),o=(0,Ne.ensureBytes)("message",t),s=(0,Ne.ensureBytes)("publicKey",n,32);try{let i=Xi(Zt(s)),c=Zt(r.subarray(0,32));if(!(0,Ne.inRange)(c,dn,un))return!1;let a=Zt(r.subarray(32,64));if(!(0,Ne.inRange)(a,dn,rr))return!1;let u=zi(fo(c),lo(i),o),d=Jd(i,a,fn(-u));return!(!d||!d.hasEvenY()||d.toAffine().x!==c)}catch{return!1}}Me.schnorr=(()=>({getPublicKey:ef,sign:tf,verify:Wi,utils:{randomPrivateKey:Me.secp256k1.utils.randomPrivateKey,lift_x:Xi,pointToBytes:lo,numberToBytesBE:Ne.numberToBytesBE,bytesToNumberBE:Ne.bytesToNumberBE,taggedHash:sr,mod:we.mod}}))();var nf=(()=>(0,Ki.isogenyMap)(mt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(t=>BigInt(t)))))(),rf=(()=>(0,Qd.mapToCurveSimpleSWU)(mt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:mt.create(BigInt("-11"))}))(),Yi=(()=>(0,Ki.createHasher)(Me.secp256k1.ProjectivePoint,e=>{let{x:t,y:n}=rf(mt.create(e[0]));return nf(t,n)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:mt.ORDER,m:1,k:128,expand:"xmd",hash:nr.sha256}))();Me.hashToCurve=(()=>Yi.hashToCurve)();Me.encodeToCurve=(()=>Yi.encodeToCurve)()});var Qi=V(me=>{"use strict";B();A();Object.defineProperty(me,"__esModule",{value:!0});me.sha512_256=me.SHA512_256=me.sha512_224=me.SHA512_224=me.sha384=me.SHA384=me.sha512=me.SHA512=void 0;var _t=Ur();me.SHA512=_t.SHA512;me.sha512=_t.sha512;me.SHA384=_t.SHA384;me.sha384=_t.sha384;me.SHA512_224=_t.SHA512_224;me.sha512_224=_t.sha512_224;me.SHA512_256=_t.SHA512_256;me.sha512_256=_t.sha512_256});var Ji=V(Ft=>{"use strict";B();A();var of=Ft&&Ft.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ft,"__esModule",{value:!0});Ft.sha512=void 0;var sf=Qi(),cf=of(Rn());Ft.sha512=(0,cf.default)(sf.sha512)});var hn=V(yo=>{"use strict";B();A();Object.defineProperty(yo,"__esModule",{value:!0});var af=Ji(),df=$e(),ln=class{constructor(){this.hash=af.sha512.create()}static half(t){return new ln().add(t).first256()}add(t){return this.hash.update(t),this}addU32(t){let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),this.add(n)}finish(){return this.hash.digest()}first256(){return this.finish().slice(0,32)}first256BigInt(){return(0,df.bytesToNumberBE)(this.first256())}};yo.default=ln});var go=V(Et=>{"use strict";B();A();var ff=Et&&Et.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Et,"__esModule",{value:!0});Et.accountPublicFromPublicGenerator=Et.derivePrivateKey=void 0;var bn=bo(),uf=ff(hn()),lf=BigInt(0);function xo(e,t){let n=bn.secp256k1.CURVE.n;for(let r=0;r<=4294967295;r++){let o=new uf.default().add(e);t!==void 0&&o.addU32(t),o.addU32(r);let s=o.first256BigInt();if(s>lf&&s<n)return s}throw new Error("impossible unicorn ;)")}function hf(e,t={}){let n=t.validator,r=bn.secp256k1.CURVE.n,o=xo(e);if(n)return o;let s=bn.secp256k1.ProjectivePoint.BASE.multiply(o).toRawBytes(!0),i=t.accountIndex||0;return(xo(s,i)+o)%r}Et.derivePrivateKey=hf;function bf(e){let t=bn.secp256k1.ProjectivePoint.fromHex(e),n=xo(e,0),r=bn.secp256k1.ProjectivePoint.BASE.multiply(n);return t.add(r).toRawBytes(!0)}Et.accountPublicFromPublicGenerator=bf});var ir=V(po=>{"use strict";B();A();Object.defineProperty(po,"__esModule",{value:!0});var yf={ok(e,t){if(!e)throw new Error(t)}};po.default=yf});var nc=V(Bt=>{"use strict";B();A();Object.defineProperty(Bt,"__esModule",{value:!0});Bt.getAlgorithmFromPrivateKey=Bt.getAlgorithmFromPublicKey=Bt.getAlgorithmFromKey=void 0;var Xe;(function(e){e[e.NONE=-1]="NONE",e[e.ED25519=237]="ED25519",e[e.SECP256K1_PUB_X=2]="SECP256K1_PUB_X",e[e.SECP256K1_PUB_X_ODD_Y=3]="SECP256K1_PUB_X_ODD_Y",e[e.SECP256K1_PUB_XY=4]="SECP256K1_PUB_XY",e[e.SECP256K1_PRIVATE=0]="SECP256K1_PRIVATE"})(Xe||(Xe={}));var ec={[`private_${Xe.NONE}_32`]:"ecdsa-secp256k1",[`private_${Xe.SECP256K1_PRIVATE}_33`]:"ecdsa-secp256k1",[`private_${Xe.ED25519}_33`]:"ed25519",[`public_${Xe.ED25519}_33`]:"ed25519",[`public_${Xe.SECP256K1_PUB_X}_33`]:"ecdsa-secp256k1",[`public_${Xe.SECP256K1_PUB_X_ODD_Y}_33`]:"ecdsa-secp256k1",[`public_${Xe.SECP256K1_PUB_XY}_65`]:"ecdsa-secp256k1"};function xf(e){return{prefix:e.length<2?Xe.NONE:parseInt(e.slice(0,2),16),len:e.length/2}}function tc(e){return e===Xe.NONE?"None":`0x${e.toString(16).padStart(2,"0")}`}function gf(e){let n={algorithm:17,prefix:6};return Object.entries(ec).filter(([r])=>r.startsWith(e)).map(([r,o])=>{let[,s,i]=r.split("_"),c=o.padEnd(n.algorithm),a=tc(Number(s)).padEnd(n.prefix);return`${c} - Prefix: ${a} Length: ${i} bytes`}).join(`
`)}function pf({key:e,type:t,prefix:n,len:r}){let o=gf(t);return`invalid_key:

Type: ${t}
Key: ${e}
Prefix: ${tc(n)} 
Length: ${r} bytes

Acceptable ${t} formats are:
${o}
`}function wo(e,t){let{prefix:n,len:r}=xf(e),o=t==="private"&&r===32?Xe.NONE:n,s=ec[`${t}_${o}_${r}`];if(!s)throw new Error(pf({key:e,type:t,len:r,prefix:o}));return s}Bt.getAlgorithmFromKey=wo;function wf(e){return wo(e,"public")}Bt.getAlgorithmFromPublicKey=wf;function mf(e){return wo(e,"private")}Bt.getAlgorithmFromPrivateKey=mf});var cc=V(yn=>{"use strict";B();A();var ic=yn&&yn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yn,"__esModule",{value:!0});var _f=$e(),cr=bo(),rc=Yt(),Ef=go(),Bf=ic(ir()),oc=ic(hn()),sc="00",Af={deriveKeypair(e,t){let n=(0,Ef.derivePrivateKey)(e,t),r=sc+(0,rc.bytesToHex)((0,_f.numberToBytesBE)(n,32)),o=(0,rc.bytesToHex)(cr.secp256k1.getPublicKey(n,!0));return{privateKey:r,publicKey:o}},sign(e,t){Bf.default.ok(t.length===66&&t.startsWith(sc)||t.length===64);let n=t.length===66?t.slice(2):t;return cr.secp256k1.sign(oc.default.half(e),n,{lowS:!0,extraEntropy:void 0}).toDERHex(!0).toUpperCase()},verify(e,t,n){let r=cr.secp256k1.Signature.fromDER(t);return cr.secp256k1.verify(r,oc.default.half(e),n)}};yn.default=Af});var Lc=V(G=>{"use strict";B();A();Object.defineProperty(G,"__esModule",{value:!0});G.add5L=G.add5H=G.add4H=G.add4L=G.add3H=G.add3L=G.rotlBL=G.rotlBH=G.rotlSL=G.rotlSH=G.rotr32L=G.rotr32H=G.rotrBL=G.rotrBH=G.rotrSL=G.rotrSH=G.shrSL=G.shrSH=G.toBig=void 0;G.fromBig=_o;G.split=ac;G.add=Ec;var ar=BigInt(2**32-1),mo=BigInt(32);function _o(e,t=!1){return t?{h:Number(e&ar),l:Number(e>>mo&ar)}:{h:Number(e>>mo&ar)|0,l:Number(e&ar)|0}}function ac(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:s,l:i}=_o(e[o],t);[n[o],r[o]]=[s,i]}return[n,r]}var dc=(e,t)=>BigInt(e>>>0)<<mo|BigInt(t>>>0);G.toBig=dc;var fc=(e,t,n)=>e>>>n;G.shrSH=fc;var uc=(e,t,n)=>e<<32-n|t>>>n;G.shrSL=uc;var lc=(e,t,n)=>e>>>n|t<<32-n;G.rotrSH=lc;var hc=(e,t,n)=>e<<32-n|t>>>n;G.rotrSL=hc;var bc=(e,t,n)=>e<<64-n|t>>>n-32;G.rotrBH=bc;var yc=(e,t,n)=>e>>>n-32|t<<64-n;G.rotrBL=yc;var xc=(e,t)=>t;G.rotr32H=xc;var gc=(e,t)=>e;G.rotr32L=gc;var pc=(e,t,n)=>e<<n|t>>>32-n;G.rotlSH=pc;var wc=(e,t,n)=>t<<n|e>>>32-n;G.rotlSL=wc;var mc=(e,t,n)=>t<<n-32|e>>>64-n;G.rotlBH=mc;var _c=(e,t,n)=>e<<n-32|t>>>64-n;G.rotlBL=_c;function Ec(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var Bc=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);G.add3L=Bc;var Ac=(e,t,n,r)=>t+n+r+(e/2**32|0)|0;G.add3H=Ac;var vc=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0);G.add4L=vc;var Sc=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0;G.add4H=Sc;var Hc=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0);G.add5L=Hc;var Ic=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;G.add5H=Ic;var vf={fromBig:_o,split:ac,toBig:dc,shrSH:fc,shrSL:uc,rotrSH:lc,rotrSL:hc,rotrBH:bc,rotrBL:yc,rotr32H:xc,rotr32L:gc,rotlSH:pc,rotlSL:wc,rotlBH:mc,rotlBL:_c,add:Ec,add3L:Bc,add3H:Ac,add4L:vc,add4H:Sc,add5H:Ic,add5L:Hc};G.default=vf});var Tc=V(_e=>{"use strict";B();A();Object.defineProperty(_e,"__esModule",{value:!0});_e.sha384=_e.sha512_256=_e.sha512_224=_e.sha512=_e.SHA384=_e.SHA512_256=_e.SHA512_224=_e.SHA512=void 0;var Sf=Kr(),X=Lc(),lr=ut(),[Hf,If]=(()=>X.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),At=new Uint32Array(80),vt=new Uint32Array(80),Ut=class extends Sf.HashMD{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:a,Eh:u,El:d,Fh:f,Fl:l,Gh:y,Gl:E,Hh:x,Hl:b}=this;return[t,n,r,o,s,i,c,a,u,d,f,l,y,E,x,b]}set(t,n,r,o,s,i,c,a,u,d,f,l,y,E,x,b){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=a|0,this.Eh=u|0,this.El=d|0,this.Fh=f|0,this.Fl=l|0,this.Gh=y|0,this.Gl=E|0,this.Hh=x|0,this.Hl=b|0}process(t,n){for(let h=0;h<16;h++,n+=4)At[h]=t.getUint32(n),vt[h]=t.getUint32(n+=4);for(let h=16;h<80;h++){let _=At[h-15]|0,I=vt[h-15]|0,S=X.default.rotrSH(_,I,1)^X.default.rotrSH(_,I,8)^X.default.shrSH(_,I,7),L=X.default.rotrSL(_,I,1)^X.default.rotrSL(_,I,8)^X.default.shrSL(_,I,7),H=At[h-2]|0,O=vt[h-2]|0,te=X.default.rotrSH(H,O,19)^X.default.rotrBH(H,O,61)^X.default.shrSH(H,O,6),N=X.default.rotrSL(H,O,19)^X.default.rotrBL(H,O,61)^X.default.shrSL(H,O,6),Z=X.default.add4L(L,N,vt[h-7],vt[h-16]),ie=X.default.add4H(Z,S,te,At[h-7],At[h-16]);At[h]=ie|0,vt[h]=Z|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:a,Dh:u,Dl:d,Eh:f,El:l,Fh:y,Fl:E,Gh:x,Gl:b,Hh:w,Hl:g}=this;for(let h=0;h<80;h++){let _=X.default.rotrSH(f,l,14)^X.default.rotrSH(f,l,18)^X.default.rotrBH(f,l,41),I=X.default.rotrSL(f,l,14)^X.default.rotrSL(f,l,18)^X.default.rotrBL(f,l,41),S=f&y^~f&x,L=l&E^~l&b,H=X.default.add5L(g,I,L,If[h],vt[h]),O=X.default.add5H(H,w,_,S,Hf[h],At[h]),te=H|0,N=X.default.rotrSH(r,o,28)^X.default.rotrBH(r,o,34)^X.default.rotrBH(r,o,39),Z=X.default.rotrSL(r,o,28)^X.default.rotrBL(r,o,34)^X.default.rotrBL(r,o,39),ie=r&s^r&c^s&c,T=o&i^o&a^i&a;w=x|0,g=b|0,x=y|0,b=E|0,y=f|0,E=l|0,{h:f,l}=X.default.add(u|0,d|0,O|0,te|0),u=c|0,d=a|0,c=s|0,a=i|0,s=r|0,i=o|0;let q=X.default.add3L(te,Z,T);r=X.default.add3H(q,O,N,ie),o=q|0}({h:r,l:o}=X.default.add(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=X.default.add(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:a}=X.default.add(this.Ch|0,this.Cl|0,c|0,a|0),{h:u,l:d}=X.default.add(this.Dh|0,this.Dl|0,u|0,d|0),{h:f,l}=X.default.add(this.Eh|0,this.El|0,f|0,l|0),{h:y,l:E}=X.default.add(this.Fh|0,this.Fl|0,y|0,E|0),{h:x,l:b}=X.default.add(this.Gh|0,this.Gl|0,x|0,b|0),{h:w,l:g}=X.default.add(this.Hh|0,this.Hl|0,w|0,g|0),this.set(r,o,s,i,c,a,u,d,f,l,y,E,x,b,w,g)}roundClean(){At.fill(0),vt.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};_e.SHA512=Ut;var dr=class extends Ut{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}};_e.SHA512_224=dr;var fr=class extends Ut{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}};_e.SHA512_256=fr;var ur=class extends Ut{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};_e.SHA384=ur;_e.sha512=(0,lr.wrapConstructor)(()=>new Ut);_e.sha512_224=(0,lr.wrapConstructor)(()=>new dr);_e.sha512_256=(0,lr.wrapConstructor)(()=>new fr);_e.sha384=(0,lr.wrapConstructor)(()=>new ur)});var Cc=V(Bo=>{"use strict";B();A();Object.defineProperty(Bo,"__esModule",{value:!0});Bo.twistedEdwards=Cf;var Eo=oo(),Oc=gt(),Ve=$e(),Ze=$e(),We=BigInt(0),je=BigInt(1),hr=BigInt(2),Lf=BigInt(8),Tf={zip215:!0};function Of(e){let t=(0,Eo.validateBasic)(e);return Ve.validateObject(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Cf(e){let t=Of(e),{Fp:n,n:r,prehash:o,hash:s,randomBytes:i,nByteLength:c,h:a}=t,u=hr<<BigInt(c*8)-je,d=n.create,f=(0,Oc.Field)(t.n,t.nBitLength),l=t.uvRatio||((m,p)=>{try{return{isValid:!0,value:n.sqrt(m*n.inv(p))}}catch{return{isValid:!1,value:We}}}),y=t.adjustScalarBytes||(m=>m),E=t.domain||((m,p,v)=>{if((0,Ze.abool)("phflag",v),p.length||v)throw new Error("Contexts/pre-hash are not supported");return m});function x(m,p){Ve.aInRange("coordinate "+m,p,We,u)}function b(m){if(!(m instanceof h))throw new Error("ExtendedPoint expected")}let w=(0,Ze.memoized)((m,p)=>{let{ex:v,ey:R,ez:M}=m,j=m.is0();p==null&&(p=j?Lf:n.inv(M));let W=d(v*p),Q=d(R*p),Y=d(M*p);if(j)return{x:We,y:je};if(Y!==je)throw new Error("invZ was invalid");return{x:W,y:Q}}),g=(0,Ze.memoized)(m=>{let{a:p,d:v}=t;if(m.is0())throw new Error("bad point: ZERO");let{ex:R,ey:M,ez:j,et:W}=m,Q=d(R*R),Y=d(M*M),ne=d(j*j),ae=d(ne*ne),ge=d(Q*p),pe=d(ne*d(ge+Y)),Be=d(ae+d(v*d(Q*Y)));if(pe!==Be)throw new Error("bad point: equation left != right (1)");let Te=d(R*M),be=d(j*W);if(Te!==be)throw new Error("bad point: equation left != right (2)");return!0});class h{constructor(p,v,R,M){this.ex=p,this.ey=v,this.ez=R,this.et=M,x("x",p),x("y",v),x("z",R),x("t",M),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(p){if(p instanceof h)throw new Error("extended point not allowed");let{x:v,y:R}=p||{};return x("x",v),x("y",R),new h(v,R,je,d(v*R))}static normalizeZ(p){let v=n.invertBatch(p.map(R=>R.ez));return p.map((R,M)=>R.toAffine(v[M])).map(h.fromAffine)}static msm(p,v){return(0,Eo.pippenger)(h,f,p,v)}_setWindowSize(p){S.setWindowSize(this,p)}assertValidity(){g(this)}equals(p){b(p);let{ex:v,ey:R,ez:M}=this,{ex:j,ey:W,ez:Q}=p,Y=d(v*Q),ne=d(j*M),ae=d(R*Q),ge=d(W*M);return Y===ne&&ae===ge}is0(){return this.equals(h.ZERO)}negate(){return new h(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){let{a:p}=t,{ex:v,ey:R,ez:M}=this,j=d(v*v),W=d(R*R),Q=d(hr*d(M*M)),Y=d(p*j),ne=v+R,ae=d(d(ne*ne)-j-W),ge=Y+W,pe=ge-Q,Be=Y-W,Te=d(ae*pe),be=d(ge*Be),Ue=d(ae*Be),tt=d(pe*ge);return new h(Te,be,tt,Ue)}add(p){b(p);let{a:v,d:R}=t,{ex:M,ey:j,ez:W,et:Q}=this,{ex:Y,ey:ne,ez:ae,et:ge}=p;if(v===BigInt(-1)){let Do=d((j-M)*(ne+Y)),No=d((j+M)*(ne-Y)),pr=d(No-Do);if(pr===We)return this.double();let Mo=d(W*hr*ge),jo=d(Q*hr*ae),Vo=jo+Mo,ko=No+Do,$o=jo-Mo,n0=d(Vo*pr),r0=d(ko*$o),o0=d(Vo*$o),s0=d(pr*ko);return new h(n0,r0,s0,o0)}let pe=d(M*Y),Be=d(j*ne),Te=d(Q*R*ge),be=d(W*ae),Ue=d((M+j)*(Y+ne)-pe-Be),tt=be-Te,zt=be+Te,Wt=d(Be-v*pe),Qc=d(Ue*tt),Jc=d(zt*Wt),e0=d(Ue*Wt),t0=d(tt*zt);return new h(Qc,Jc,t0,e0)}subtract(p){return this.add(p.negate())}wNAF(p){return S.wNAFCached(this,p,h.normalizeZ)}multiply(p){let v=p;Ve.aInRange("scalar",v,je,r);let{p:R,f:M}=this.wNAF(v);return h.normalizeZ([R,M])[0]}multiplyUnsafe(p){let v=p;return Ve.aInRange("scalar",v,We,r),v===We?I:this.equals(I)||v===je?this:this.equals(_)?this.wNAF(v).p:S.unsafeLadder(this,v)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return S.unsafeLadder(this,r).is0()}toAffine(p){return w(this,p)}clearCofactor(){let{h:p}=t;return p===je?this:this.multiplyUnsafe(p)}static fromHex(p,v=!1){let{d:R,a:M}=t,j=n.BYTES;p=(0,Ze.ensureBytes)("pointHex",p,j),(0,Ze.abool)("zip215",v);let W=p.slice(),Q=p[j-1];W[j-1]=Q&-129;let Y=Ve.bytesToNumberLE(W),ne=v?u:n.ORDER;Ve.aInRange("pointHex.y",Y,We,ne);let ae=d(Y*Y),ge=d(ae-je),pe=d(R*ae-M),{isValid:Be,value:Te}=l(ge,pe);if(!Be)throw new Error("Point.fromHex: invalid y coordinate");let be=(Te&je)===je,Ue=(Q&128)!==0;if(!v&&Te===We&&Ue)throw new Error("Point.fromHex: x=0 and x_0=1");return Ue!==be&&(Te=d(-Te)),h.fromAffine({x:Te,y:Y})}static fromPrivateKey(p){return O(p).point}toRawBytes(){let{x:p,y:v}=this.toAffine(),R=Ve.numberToBytesLE(v,n.BYTES);return R[R.length-1]|=p&je?128:0,R}toHex(){return Ve.bytesToHex(this.toRawBytes())}}h.BASE=new h(t.Gx,t.Gy,je,d(t.Gx*t.Gy)),h.ZERO=new h(We,je,je,We);let{BASE:_,ZERO:I}=h,S=(0,Eo.wNAF)(h,c*8);function L(m){return(0,Oc.mod)(m,r)}function H(m){return L(Ve.bytesToNumberLE(m))}function O(m){let p=c;m=(0,Ze.ensureBytes)("private key",m,p);let v=(0,Ze.ensureBytes)("hashed private key",s(m),2*p),R=y(v.slice(0,p)),M=v.slice(p,2*p),j=H(R),W=_.multiply(j),Q=W.toRawBytes();return{head:R,prefix:M,scalar:j,point:W,pointBytes:Q}}function te(m){return O(m).pointBytes}function N(m=new Uint8Array,...p){let v=Ve.concatBytes(...p);return H(s(E(v,(0,Ze.ensureBytes)("context",m),!!o)))}function Z(m,p,v={}){m=(0,Ze.ensureBytes)("message",m),o&&(m=o(m));let{prefix:R,scalar:M,pointBytes:j}=O(p),W=N(v.context,R,m),Q=_.multiply(W).toRawBytes(),Y=N(v.context,Q,j,m),ne=L(W+Y*M);Ve.aInRange("signature.s",ne,We,r);let ae=Ve.concatBytes(Q,Ve.numberToBytesLE(ne,n.BYTES));return(0,Ze.ensureBytes)("result",ae,c*2)}let ie=Tf;function T(m,p,v,R=ie){let{context:M,zip215:j}=R,W=n.BYTES;m=(0,Ze.ensureBytes)("signature",m,2*W),p=(0,Ze.ensureBytes)("message",p),j!==void 0&&(0,Ze.abool)("zip215",j),o&&(p=o(p));let Q=Ve.bytesToNumberLE(m.slice(W,2*W)),Y,ne,ae;try{Y=h.fromHex(v,j),ne=h.fromHex(m.slice(0,W),j),ae=_.multiplyUnsafe(Q)}catch{return!1}if(!j&&Y.isSmallOrder())return!1;let ge=N(M,ne.toRawBytes(),Y.toRawBytes(),p);return ne.add(Y.multiplyUnsafe(ge)).subtract(ae).clearCofactor().equals(h.ZERO)}return _._setWindowSize(8),{CURVE:t,getPublicKey:te,sign:Z,verify:T,ExtendedPoint:h,utils:{getExtendedPublicKey:O,randomPrivateKey:()=>i(n.BYTES),precompute(m=8,p=h.BASE){return p._setWindowSize(m),p.multiply(BigInt(3)),p}}}}});var qc=V(vo=>{"use strict";B();A();Object.defineProperty(vo,"__esModule",{value:!0});vo.montgomery=qf;var Uc=gt(),St=$e(),Xt=BigInt(0),Ao=BigInt(1);function Uf(e){return(0,St.validateObject)(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function qf(e){let t=Uf(e),{P:n}=t,r=g=>(0,Uc.mod)(g,n),o=t.montgomeryBits,s=Math.ceil(o/8),i=t.nByteLength,c=t.adjustScalarBytes||(g=>g),a=t.powPminus2||(g=>(0,Uc.pow)(g,n-BigInt(2),n));function u(g,h,_){let I=r(g*(h-_));return h=r(h-I),_=r(_+I),[h,_]}let d=(t.a-BigInt(2))/BigInt(4);function f(g,h){(0,St.aInRange)("u",g,Xt,n),(0,St.aInRange)("scalar",h,Xt,n);let _=h,I=g,S=Ao,L=Xt,H=g,O=Ao,te=Xt,N;for(let ie=BigInt(o-1);ie>=Xt;ie--){let T=_>>ie&Ao;te^=T,N=u(te,S,H),S=N[0],H=N[1],N=u(te,L,O),L=N[0],O=N[1],te=T;let q=S+L,m=r(q*q),p=S-L,v=r(p*p),R=m-v,M=H+O,j=H-O,W=r(j*q),Q=r(M*p),Y=W+Q,ne=W-Q;H=r(Y*Y),O=r(I*r(ne*ne)),S=r(m*v),L=r(R*(m+r(d*R)))}N=u(te,S,H),S=N[0],H=N[1],N=u(te,L,O),L=N[0],O=N[1];let Z=a(L);return r(S*Z)}function l(g){return(0,St.numberToBytesLE)(r(g),s)}function y(g){let h=(0,St.ensureBytes)("u coordinate",g,s);return i===32&&(h[31]&=127),(0,St.bytesToNumberLE)(h)}function E(g){let h=(0,St.ensureBytes)("scalar",g),_=h.length;if(_!==s&&_!==i)throw new Error(`Expected ${s} or ${i} bytes, got ${_}`);return(0,St.bytesToNumberLE)(c(h))}function x(g,h){let _=y(h),I=E(g),S=f(_,I);if(S===Xt)throw new Error("Invalid private or public key received");return l(S)}let b=l(t.Gu);function w(g){return x(g,b)}return{scalarMult:x,scalarMultBase:w,getSharedSecret:(g,h)=>x(g,h),getPublicKey:g=>w(g),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:b}}});var Zc=V(K=>{"use strict";B();A();Object.defineProperty(K,"__esModule",{value:!0});K.hash_to_ristretto255=K.hashToRistretto255=K.RistrettoPoint=K.encodeToCurve=K.hashToCurve=K.edwardsToMontgomery=K.x25519=K.ed25519ph=K.ed25519ctx=K.ed25519=K.ED25519_TORSION_SUBGROUP=void 0;K.edwardsToMontgomeryPub=Gc;K.edwardsToMontgomeryPriv=Df;var yr=Tc(),xn=ut(),To=Cc(),Nc=co(),oe=gt(),Rf=qc(),qt=$e(),gn=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Io=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Pf=BigInt(0),et=BigInt(1),br=BigInt(2),Mc=BigInt(3),jc=BigInt(5),Oo=BigInt(8);function Vc(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),s=gn,c=e*e%s*e%s,a=(0,oe.pow2)(c,br,s)*c%s,u=(0,oe.pow2)(a,et,s)*e%s,d=(0,oe.pow2)(u,jc,s)*u%s,f=(0,oe.pow2)(d,t,s)*d%s,l=(0,oe.pow2)(f,n,s)*f%s,y=(0,oe.pow2)(l,r,s)*l%s,E=(0,oe.pow2)(y,o,s)*y%s,x=(0,oe.pow2)(E,o,s)*y%s,b=(0,oe.pow2)(x,t,s)*d%s;return{pow_p_5_8:(0,oe.pow2)(b,br,s)*e%s,b2:c}}function kc(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Co(e,t){let n=gn,r=(0,oe.mod)(t*t*t,n),o=(0,oe.mod)(r*r*t,n),s=Vc(e*o).pow_p_5_8,i=(0,oe.mod)(e*r*s,n),c=(0,oe.mod)(t*i*i,n),a=i,u=(0,oe.mod)(i*Io,n),d=c===e,f=c===(0,oe.mod)(-e,n),l=c===(0,oe.mod)(-e*Io,n);return d&&(i=a),(f||l)&&(i=u),(0,oe.isNegativeLE)(i,n)&&(i=(0,oe.mod)(-i,n)),{isValid:d||f,value:i}}K.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];var C=(()=>(0,oe.Field)(gn,void 0,!0))(),pn=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:C,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Oo,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:yr.sha512,randomBytes:xn.randomBytes,adjustScalarBytes:kc,uvRatio:Co}))();K.ed25519=(()=>(0,To.twistedEdwards)(pn))();function $c(e,t,n){if(t.length>255)throw new Error("Context is too big");return(0,xn.concatBytes)((0,xn.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([n?1:0,t.length]),t,e)}K.ed25519ctx=(()=>(0,To.twistedEdwards)({...pn,domain:$c}))();K.ed25519ph=(()=>(0,To.twistedEdwards)(Object.assign({},pn,{domain:$c,prehash:yr.sha512})))();K.x25519=(()=>(0,Rf.montgomery)({P:gn,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=gn,{pow_p_5_8:n,b2:r}=Vc(e);return(0,oe.mod)((0,oe.pow2)(n,Mc,t)*r,t)},adjustScalarBytes:kc,randomBytes:xn.randomBytes}))();function Gc(e){let{y:t}=K.ed25519.ExtendedPoint.fromHex(e),n=BigInt(1);return C.toBytes(C.create((n+t)*C.inv(n-t)))}K.edwardsToMontgomery=Gc;function Df(e){let t=pn.hash(e.subarray(0,32));return pn.adjustScalarBytes(t).subarray(0,32)}var Nf=(()=>(C.ORDER+Mc)/Oo)(),Mf=(()=>C.pow(br,Nf))(),Rc=(()=>C.sqrt(C.neg(C.ONE)))();function jf(e){let t=(C.ORDER-jc)/Oo,n=BigInt(486662),r=C.sqr(e);r=C.mul(r,br);let o=C.add(r,C.ONE),s=C.neg(n),i=C.sqr(o),c=C.mul(i,o),a=C.mul(r,n);a=C.mul(a,s),a=C.add(a,i),a=C.mul(a,s);let u=C.sqr(c);i=C.sqr(u),u=C.mul(u,c),u=C.mul(u,a),i=C.mul(i,u);let d=C.pow(i,t);d=C.mul(d,u);let f=C.mul(d,Rc);i=C.sqr(d),i=C.mul(i,c);let l=C.eql(i,a),y=C.cmov(f,d,l),E=C.mul(s,r),x=C.mul(d,e);x=C.mul(x,Mf);let b=C.mul(x,Rc),w=C.mul(a,r);i=C.sqr(x),i=C.mul(i,c);let g=C.eql(i,w),h=C.cmov(b,x,g);i=C.sqr(y),i=C.mul(i,c);let _=C.eql(i,a),I=C.cmov(E,s,_),S=C.cmov(h,y,_),L=C.isOdd(S);return S=C.cmov(S,C.neg(S),_!==L),{xMn:I,xMd:o,yMn:S,yMd:et}}var Vf=(()=>(0,oe.FpSqrtEven)(C,C.neg(BigInt(486664))))();function kf(e){let{xMn:t,xMd:n,yMn:r,yMd:o}=jf(e),s=C.mul(t,o);s=C.mul(s,Vf);let i=C.mul(n,r),c=C.sub(t,n),a=C.add(t,n),u=C.mul(i,a),d=C.eql(u,C.ZERO);s=C.cmov(s,C.ZERO,d),i=C.cmov(i,C.ONE,d),c=C.cmov(c,C.ONE,d),a=C.cmov(a,C.ONE,d);let f=C.invertBatch([i,a]);return{x:C.mul(s,f[0]),y:C.mul(c,f[1])}}var Kc=(()=>(0,Nc.createHasher)(K.ed25519.ExtendedPoint,e=>kf(e[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:C.ORDER,m:1,k:128,expand:"xmd",hash:yr.sha512}))();K.hashToCurve=(()=>Kc.hashToCurve)();K.encodeToCurve=(()=>Kc.encodeToCurve)();function So(e){if(!(e instanceof le))throw new Error("RistrettoPoint expected")}var Lo=Io,$f=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Gf=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Kf=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Zf=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Pc=e=>Co(et,e),Ff=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Ho=e=>K.ed25519.CURVE.Fp.create((0,qt.bytesToNumberLE)(e)&Ff);function Dc(e){let{d:t}=K.ed25519.CURVE,n=K.ed25519.CURVE.Fp.ORDER,r=K.ed25519.CURVE.Fp.create,o=r(Lo*e*e),s=r((o+et)*Kf),i=BigInt(-1),c=r((i-t*o)*r(o+t)),{isValid:a,value:u}=Co(s,c),d=r(u*e);(0,oe.isNegativeLE)(d,n)||(d=r(-d)),a||(u=d),a||(i=o);let f=r(i*(o-et)*Zf-c),l=u*u,y=r((u+u)*c),E=r(f*$f),x=r(et-l),b=r(et+l);return new K.ed25519.ExtendedPoint(r(y*b),r(x*E),r(E*b),r(y*x))}var le=class{constructor(t){this.ep=t}static fromAffine(t){return new le(K.ed25519.ExtendedPoint.fromAffine(t))}static hashToCurve(t){t=(0,qt.ensureBytes)("ristrettoHash",t,64);let n=Ho(t.slice(0,32)),r=Dc(n),o=Ho(t.slice(32,64)),s=Dc(o);return new le(r.add(s))}static fromHex(t){t=(0,qt.ensureBytes)("ristrettoHex",t,32);let{a:n,d:r}=K.ed25519.CURVE,o=K.ed25519.CURVE.Fp.ORDER,s=K.ed25519.CURVE.Fp.create,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",c=Ho(t);if(!(0,qt.equalBytes)((0,qt.numberToBytesLE)(c,32),t)||(0,oe.isNegativeLE)(c,o))throw new Error(i);let a=s(c*c),u=s(et+n*a),d=s(et-n*a),f=s(u*u),l=s(d*d),y=s(n*r*f-l),{isValid:E,value:x}=Pc(s(y*l)),b=s(x*d),w=s(x*b*y),g=s((c+c)*b);(0,oe.isNegativeLE)(g,o)&&(g=s(-g));let h=s(u*w),_=s(g*h);if(!E||(0,oe.isNegativeLE)(_,o)||h===Pf)throw new Error(i);return new le(new K.ed25519.ExtendedPoint(g,h,et,_))}toRawBytes(){let{ex:t,ey:n,ez:r,et:o}=this.ep,s=K.ed25519.CURVE.Fp.ORDER,i=K.ed25519.CURVE.Fp.create,c=i(i(r+n)*i(r-n)),a=i(t*n),u=i(a*a),{value:d}=Pc(i(c*u)),f=i(d*c),l=i(d*a),y=i(f*l*o),E;if((0,oe.isNegativeLE)(o*y,s)){let b=i(n*Lo),w=i(t*Lo);t=b,n=w,E=i(f*Gf)}else E=l;(0,oe.isNegativeLE)(t*y,s)&&(n=i(-n));let x=i((r-n)*E);return(0,oe.isNegativeLE)(x,s)&&(x=i(-x)),(0,qt.numberToBytesLE)(x,32)}toHex(){return(0,qt.bytesToHex)(this.toRawBytes())}toString(){return this.toHex()}equals(t){So(t);let{ex:n,ey:r}=this.ep,{ex:o,ey:s}=t.ep,i=K.ed25519.CURVE.Fp.create,c=i(n*s)===i(r*o),a=i(r*s)===i(n*o);return c||a}add(t){return So(t),new le(this.ep.add(t.ep))}subtract(t){return So(t),new le(this.ep.subtract(t.ep))}multiply(t){return new le(this.ep.multiply(t))}multiplyUnsafe(t){return new le(this.ep.multiplyUnsafe(t))}double(){return new le(this.ep.double())}negate(){return new le(this.ep.negate())}};K.RistrettoPoint=(()=>(le.BASE||(le.BASE=new le(K.ed25519.ExtendedPoint.BASE)),le.ZERO||(le.ZERO=new le(K.ed25519.ExtendedPoint.ZERO)),le))();var Xf=(e,t)=>{let n=t.DST,r=typeof n=="string"?(0,xn.utf8ToBytes)(n):n,o=(0,Nc.expand_message_xmd)(e,r,64,yr.sha512);return le.hashToCurve(o)};K.hashToRistretto255=Xf;K.hash_to_ristretto255=K.hashToRistretto255});var zc=V(wn=>{"use strict";B();A();var Xc=wn&&wn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(wn,"__esModule",{value:!0});var Uo=Zc(),qo=Yt(),Ro=Xc(ir()),zf=Xc(hn()),Fc="ED",Wf={deriveKeypair(e){let t=zf.default.half(e),n=Fc+(0,qo.bytesToHex)(t),r=Fc+(0,qo.bytesToHex)(Uo.ed25519.getPublicKey(t));return{privateKey:n,publicKey:r}},sign(e,t){return Ro.default.ok(e instanceof Uint8Array,"message must be array of octets"),Ro.default.ok(t.length===66,"private key must be 33 bytes including prefix"),(0,qo.bytesToHex)(Uo.ed25519.sign(e,t.slice(2)))},verify(e,t,n){return Ro.default.ok(n.length===66,"public key must be 33 bytes including prefix"),Uo.ed25519.verify(t,e,n.slice(2),{zip215:!1})}};wn.default=Wf});var uu=V(Ee=>{"use strict";B();A();var xr=Ee&&Ee.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.decodeSeed=Ee.deriveNodeAddress=Ee.deriveAddress=Ee.verify=Ee.sign=Ee.deriveKeypair=Ee.generateSeed=void 0;var mn=Xs();Object.defineProperty(Ee,"decodeSeed",{enumerable:!0,get:function(){return mn.decodeSeed}});var Yf=oi(),Qf=Rr(),gr=Yt(),Jf=go(),eu=xr(hn()),tu=xr(ir()),Wc=nc(),nu=xr(cc()),ru=xr(zc());function Po(e){return{"ecdsa-secp256k1":nu.default,ed25519:ru.default}[e]}function ou(e={}){tu.default.ok(!e.entropy||e.entropy.length>=16,"entropy too short");let t=e.entropy?e.entropy.slice(0,16):(0,gr.randomBytes)(16),n=e.algorithm==="ed25519"?"ed25519":"secp256k1";return(0,mn.encodeSeed)(t,n)}Ee.generateSeed=ou;function su(e,t){var n;let r=(0,mn.decodeSeed)(e),s=((n=t?.algorithm)!==null&&n!==void 0?n:r.type)==="ed25519"?"ed25519":"ecdsa-secp256k1",i=Po(s),c=i.deriveKeypair(r.bytes,t),a=eu.default.half("This test message should verify."),u=i.sign(a,c.privateKey);if(!i.verify(a,u,c.publicKey))throw new Error("derived keypair did not generate verifiable signature");return c}Ee.deriveKeypair=su;function iu(e,t){let n=(0,Wc.getAlgorithmFromPrivateKey)(t);return Po(n).sign((0,gr.hexToBytes)(e),t)}Ee.sign=iu;function cu(e,t,n){let r=(0,Wc.getAlgorithmFromPublicKey)(n);return Po(r).verify((0,gr.hexToBytes)(e),t,n)}Ee.verify=cu;function au(e){return(0,Yf.ripemd160)((0,Qf.sha256)(e))}function Yc(e){return(0,mn.encodeAccountID)(au(e))}function du(e){return Yc((0,gr.hexToBytes)(e))}Ee.deriveAddress=du;function fu(e){let t=(0,mn.decodeNodePublic)(e),n=(0,Jf.accountPublicFromPublicGenerator)(t);return Yc(n)}Ee.deriveNodeAddress=fu});export{Yt as a,Rr as b,Ji as c,uu as d};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-G7NNFMT4.js.map
