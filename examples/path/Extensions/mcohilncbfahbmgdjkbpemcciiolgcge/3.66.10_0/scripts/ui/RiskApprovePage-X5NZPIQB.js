import{a as V}from"./chunk-OFQ6Z6PM.js";import{a as G,b as H}from"./chunk-R4EC6ZNT.js";import{a as S}from"./chunk-GRRARPFJ.js";import"./chunk-LWCVE2GP.js";import{a as K,b as O}from"./chunk-VBAUMIUV.js";import"./chunk-L37MOKNV.js";import"./chunk-WPAZ67JY.js";import{c as N}from"./chunk-RQRUTXST.js";import{c as j}from"./chunk-RIGKKYH2.js";import"./chunk-7C7MBE2C.js";import"./chunk-KJWX5V23.js";import"./chunk-QYDRYMWS.js";import{a as F}from"./chunk-Y5K5NJ6U.js";import{a as C}from"./chunk-Q7FGM7BT.js";import"./chunk-TKE74ERX.js";import{wb as I}from"./chunk-QMENNGDH.js";import"./chunk-KANXVZ35.js";import"./chunk-WGVA2GGS.js";import"./chunk-APGT6UVG.js";import"./chunk-V34MB2FG.js";import{o as se}from"./chunk-XP3TNE3R.js";import{jc as ie}from"./chunk-QRHYK2TW.js";import"./chunk-QO4JMOUQ.js";import"./chunk-7N263AYH.js";import{a as le}from"./chunk-532YJKK4.js";import"./chunk-M6J3OOFH.js";import"./chunk-ZDOH3CEJ.js";import"./chunk-AS4Z3FNS.js";import"./chunk-L524QXHA.js";import"./chunk-ZFTHPYIG.js";import"./chunk-N6DAHVYW.js";import"./chunk-YCFHPQAJ.js";import"./chunk-4EIUGT5A.js";import"./chunk-7FRDKLRJ.js";import"./chunk-P7VKC6DQ.js";import"./chunk-D7FW64MN.js";import"./chunk-6ZZOO2CD.js";import"./chunk-JPTLCZ2Y.js";import{d as R}from"./chunk-AVC4ODUV.js";import"./chunk-RJ3YTAFM.js";import"./chunk-OCAFSBNZ.js";import{c as m}from"./chunk-62ZAND24.js";import"./chunk-SIITVWZR.js";import"./chunk-QHXUL3YM.js";import{B as a,H as ne,m as w}from"./chunk-MOTAOJVG.js";import"./chunk-FYTT4U7M.js";import{G as h,e as E}from"./chunk-XR4SQWL7.js";import"./chunk-NCGYY6X6.js";import"./chunk-LMBQGBLO.js";import"./chunk-QWIXUG3W.js";import"./chunk-Z3JMRMVO.js";import"./chunk-CYTB2B6Q.js";import"./chunk-CAFKDDXA.js";import"./chunk-CTOTVO2J.js";import"./chunk-T2ETCKOI.js";import"./chunk-6P63CWAB.js";import"./chunk-RJPAKY6O.js";import"./chunk-ZCK5UHUS.js";import"./chunk-ANUO2YYF.js";import{ka as u}from"./chunk-6M3PZK2X.js";import"./chunk-TPIKSUHH.js";import{b as re}from"./chunk-OL67KS7C.js";import"./chunk-TVBFJITU.js";import{a as ae}from"./chunk-2EEW2VNF.js";import"./chunk-NLMDM2WF.js";import"./chunk-BJAL3374.js";import"./chunk-KDUIZVRC.js";import"./chunk-263G66VF.js";import"./chunk-SUANL2KV.js";import"./chunk-2OVRHWIW.js";import"./chunk-32ZJ4F2J.js";import"./chunk-WIP2REO7.js";import"./chunk-JBHIVXO6.js";import"./chunk-LECESFCD.js";import"./chunk-NW4HKKTQ.js";import"./chunk-EBMX24YQ.js";import"./chunk-3C4MEE67.js";import"./chunk-R4BHRBC7.js";import{f as k,o as _,q as v}from"./chunk-SHG7TIBL.js";_();v();var e=k(re()),T=k(ie()),z=k(le()),M=k(se()),b=k(ae());ne();_();v();var l={"retina-border-basic":"_retina-border-basic_11rve_1",retinaBorderBasic:"_retina-border-basic_11rve_1",container:"_container_11rve_29","img-wrapper":"_img-wrapper_11rve_32",imgWrapper:"_img-wrapper_11rve_32",pic:"_pic_11rve_38",img:"_img_11rve_32",text:"_text_11rve_46","risk-addr":"_risk-addr_11rve_57",riskAddr:"_risk-addr_11rve_57"};var W=(s,p)=>s.every(d=>d.status===p),$=s=>{let p=W(s,2),d=W(s,3);return{loading:p||d,loadingTextKey:p?"wallet_extension_approval_btn_revoking":"wallet_extension_approval_btn_approving"}},ce=()=>{let s=(0,z.useHistory)(),p=R({light:"/cdn/assets/imgs/253/4AD3248AD93516C7.png",dark:"/cdn/assets/imgs/253/4E618AEF79838D4F.png"}),d=(0,T.useDispatch)(),L=K(),{loading:P,run:x,error:Y}=(0,M.useRequest)(async()=>await L(),{manual:!0}),i=S(),g=(0,T.useSelector)(j);(0,e.useEffect)(()=>{!g&&x()},[g,x]),(0,e.useEffect)(()=>{g&&!i.length&&s.goBack()},[g,i.length]);let Z=i?.length||0;O();let B=(0,e.useCallback)(async({tokens:t,chainId:r})=>{if((0,b.isEmpty)(t))return[];let o=t.filter(c=>c.status===1).map(async({coinId:c,tokenAddress:A,approvalAddress:y,permit2Address:ee,address:te,approvalNum:oe})=>await V({address:te,chainId:r,tokenAddress:A,approvalAddress:y,permit2Address:ee,coinId:c,approvalNum:oe}));return await Promise.all(o)},[]),q=async()=>{let t=i.map(async o=>await B({tokens:o.tokens,chainId:o.chainId}));return(await Promise.all(t))?.flat()||[]},D=(0,e.useCallback)(t=>{if(t.some(o=>(0,b.isEmpty)(o))){h.error({title:a("wallet_extension_approval_toast_initiate_fail"),duration:3,showClose:!0,placement:h.DIRECTION.top});return}d(N({type:"approve",data:t})),s.push(`${I}?type=approve`)},[]),J=async({tokens:t,chainId:r})=>{let n=await B({tokens:t,chainId:r});D(n)},{revokeAllBtnLoading:U,revokeAllBtnLoadingTextKey:X}=(0,e.useMemo)(()=>{let t=i.map(o=>o?.tokens||[]).flat(),{loading:r,loadingTextKey:n}=$(t);return{revokeAllBtnLoading:r,revokeAllBtnLoadingTextKey:n}},[i]),Q=async()=>{let t=await q();D(t)};return e.default.createElement(m.Container,{loading:!1,className:l.container},e.default.createElement(F,{bordered:!1,closeable:!1}),e.default.createElement(H,{isError:!!Y,isLoading:P,reload:x},e.default.createElement(e.default.Fragment,null,e.default.createElement(m.Box,{className:l.imgWrapper},e.default.createElement(E,{src:p,pictureClassName:l.pic,className:l.img})),e.default.createElement(m.Box,{className:l.text},a("wallet_extension_approval_header_num_risky",{num:w(Z,{needZero:!1})})),e.default.createElement(m.Box,{className:l.riskAddr},a("wallet_extension_approval_label_malicious")),e.default.createElement(m.Box,null,i.map(t=>{let{projectIcon:r,projectName:n,network:o,approvalAddress:f,chainId:c}=t;if(!t?.tokens?.length)return null;let{loading:A,loadingTextKey:y}=$(t.tokens);return e.default.createElement(G,{title:n,desc:o,icon:r,btnText:a("wallet_extension_approval_btn_revoke"),btnLoading:A,key:`${f}-${c}`,btnLoadingText:a(y),btnClick:async()=>{await J({tokens:t.tokens,chainId:c})}})})),e.default.createElement(C.FooterActions,{zIndex:"100000"},e.default.createElement(u,{loading:U,loadingText:a(X),category:u.CATEGORY.fill,type:u.TYPE.highlight,size:u.SIZE.lg,onClick:Q},a("wallet_extension_approval_btn_revoke_all"))))))},Fe=ce;export{Fe as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=RiskApprovePage-X5NZPIQB.js.map
