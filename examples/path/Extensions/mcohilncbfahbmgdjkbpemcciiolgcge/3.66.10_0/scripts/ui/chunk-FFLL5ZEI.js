import{a as L}from"./chunk-4CAGK53A.js";import{a as F}from"./chunk-F2UY6S3K.js";import{a as k}from"./chunk-DDT324RS.js";import{b as N}from"./chunk-DBWXHHZT.js";import{a as D}from"./chunk-67F2WFQO.js";import{Ba as C}from"./chunk-QMENNGDH.js";import{U as A,V as E}from"./chunk-QRHYK2TW.js";import{a as j}from"./chunk-532YJKK4.js";import{c as y,e as J}from"./chunk-AS4Z3FNS.js";import{c as I,q as T}from"./chunk-4EIUGT5A.js";import{Zc as c,od as G,zc as f}from"./chunk-QHXUL3YM.js";import{H as v,y as i}from"./chunk-MOTAOJVG.js";import{H as _,o as w}from"./chunk-XR4SQWL7.js";import{L as R,ra as b}from"./chunk-CYTB2B6Q.js";import{b as B}from"./chunk-OL67KS7C.js";import{f as S,o as x,q as h}from"./chunk-SHG7TIBL.js";x();h();var p=S(B()),P=S(j());b();v();J();G();var M=({address:e,targetCoinId:a,registerPath:o})=>{let u=(0,P.useHistory)(),g=N();return async({coinId:r})=>{let{coin:t,baseCoin:n}=await g(r,!0);if(![String(r),String(n.coinId)].includes(String(a)))return!0;try{let{status:s}=await k({chainId:t.chainId,address:e});if(s===T.NOT_STARTED){let l=w.warn({title:i("wallet_dialog_modal_not_registered"),text:i("wallet_dialog_modal_register_before_using"),confirmText:i("wallet_dialog_modal_registerbtn"),cancelText:i("wallet_dialog_modal_backbtn"),alignBottom:!1,onConfirm:()=>{l.destroy(),u.push(o)},onCancel:()=>{l.destroy()}});return!1}if(s===T.PROCESSING)return _.warn({title:i("wallet_extension_transaction_notif_address_registering",{net:t.chainName})}),!1}catch(s){let l=s?.error_message||i("wallet_extension_transaction_notif_address_register_fail",{net:t.chainName});return _.error(l),!1}return!0}},rt=()=>{let e=D(f);return M({address:e,targetCoinId:c,registerPath:C})},ot=e=>{let[a,o]=(0,p.useState)({isLoading:!0,isError:!1,nonce:"0",gasFee:{overallFee:"0"}}),u=async()=>(await A({coinId:c,address:e},{fromAddr:e,toAddr:""}))?.info?.nonce,g=async r=>{let t={type:"deploy_account",nonce:r};return(await y().signTransaction(t,e,f))?.signature},m=async r=>{let{data:t={}}=await E({coinId:c,address:e,inputData:r});return t};return(0,p.useEffect)(()=>{(async()=>{try{let t=await u();if(R(t)){o(s=>({...s,isLoading:!1,isError:!0}));return}let n=await g(t),d=await m(n);o(s=>({...s,isLoading:!1,isError:!1,nonce:t,gasFee:{...d,resourceBounds:F(d)}}))}catch{o(n=>({...n,isLoading:!1,isError:!0}))}})()},[]),a},nt=({nonce:e,gasFee:a,address:o})=>{let u=L();return async()=>{let m={type:"deploy_account",nonce:e,resourceBounds:a?.resourceBounds},r=await y().signTransaction(m,o,f),t={type:"AccountActive",serviceChargeCoinId:c,nonce:e},n={signedTx:r?.signature,fromAdr:o,serviceCharge:a?.overallFee,toAdr:o,coinAmount:"0",coinId:c,txHash:r?.txId,txType:I.REGISTRATION,extJson:JSON.stringify(t)};return await u(n)}};export{rt as a,ot as b,nt as c};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-FFLL5ZEI.js.map
