import{b as v}from"./chunk-5TLDWKXV.js";import{a as M}from"./chunk-F2UY6S3K.js";import{a as G}from"./chunk-DDT324RS.js";import{p as D}from"./chunk-CDNJY7Z3.js";import{d as N}from"./chunk-7JSJY3SQ.js";import{b as k}from"./chunk-7C7MBE2C.js";import{a as A}from"./chunk-5CHE7P4E.js";import{o as H}from"./chunk-XP3TNE3R.js";import{U as L,V as C}from"./chunk-QRHYK2TW.js";import{c as P,e as z}from"./chunk-AS4Z3FNS.js";import{q as u}from"./chunk-4EIUGT5A.js";import{Zc as c,od as j,zc as g}from"./chunk-QHXUL3YM.js";import{H as K,y as l}from"./chunk-MOTAOJVG.js";import{b}from"./chunk-OL67KS7C.js";import{f as R,o as y,q as w}from"./chunk-SHG7TIBL.js";y();w();var t=R(b()),U=R(H());K();z();j();var J="0";function dt(d){let s=N(c)||{},o=A(g,d),[S,r]=(0,t.useState)(!0),[p,a]=(0,t.useState)(""),[E,_]=(0,t.useState)(""),f=async()=>{try{let{status:i}=await G({chainId:s?.chainId,coinId:c,address:o});_(i),i===u.NOT_STARTED?a(l("wallet_dialog_modal_not_registered")):i===u.PROCESSING?a(l("wallet_extension_transaction_notif_address_registering",{net:s?.chainName})):a("")}catch{a(l("wallet_extension_transaction_notif_address_register_fail",{net:s?.chainName}))}finally{r(!1)}},m=k("wallet-tx-status-toast",{onError:f,pollingInterval:10*1e3});return(0,t.useEffect)(()=>{f()},[m]),{loading:S,registerError:p,registerStatus:E}}function ft(d,s){let{transactions:o}=d?.params||{},S=(0,U.usePrevious)(s),r=A(g,d?.walletId),[p,a]=(0,t.useState)({overallFee:"0"}),{preExecuteRet:E,updateAndExecute:_}=v({coinId:c}),[f,m]=(0,t.useState)(!1),[i,I]=(0,t.useState)(!1),[B,O]=(0,t.useState)(null),q=async()=>{let e=await L({coinId:c,address:r},{fromAddr:r,toAddr:""});return O(e),e},h=async e=>{let n={type:"multi_contract_call",nonce:e?.info?.nonce,chainId:D.StarknetChainId.SN_MAIN,multiContractCallData:{from:r,calls:o}};return(await P().signTransaction(n,r,g))?.signature},W=async e=>{let{data:n}=await C({coinId:c,address:r,inputData:e});return m(n?.queryGasLimitErrorUseDefault),n?.queryGasLimitErrorUseDefault?{overallFee:J}:n},T=async()=>{try{let e=await q(),n=await h(e),x=await W(n),X=await h(e),F=o?.[0]?.contractAddress||o?.[0]?.contract_address;_({value:0,from:r,to:F,txType:3,tokenAddress:F,data:X}),a({...x,resourceBounds:M(x)})}catch{m(!0)}finally{I(!1)}};return(0,t.useEffect)(()=>{o&&(I(!0),T())},[o]),(0,t.useEffect)(()=>{S===u.PROCESSING&&s===u.COMPLETED&&(I(!0),T())},[s]),{gasFee:p,feeLoading:i,feeError:f,signInfo:B,preExecuteRet:E?.[0]}}export{dt as a,ft as b};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-TWSXR5WQ.js.map
