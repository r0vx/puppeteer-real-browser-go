import{b as Yt,d as $t}from"./chunk-PZSN2XKL.js";import{a as Vt,c as Gt,d as jt,e as Kt}from"./chunk-6Q4OK5GJ.js";import{a as Zt}from"./chunk-OAW4CIA6.js";import{a as Oe}from"./chunk-A267SEFJ.js";import{a as se}from"./chunk-VR7OPIR6.js";import{a as ve}from"./chunk-32XJE5HT.js";import{b as gt,c as kt,d as Tt,e as Et,f as xt,g as Ct,l as St,m as Nt,n as At,o as It}from"./chunk-MRHV2NKN.js";import{a as Ue,b as Ft}from"./chunk-U7FUSLT6.js";import{Aa as mt,F as lt,ia as ct,l as te}from"./chunk-NQAVUB4Q.js";import{a as Mt,c as zt,d as Ht}from"./chunk-NS7RQN2C.js";import{a as Dt}from"./chunk-7IRBVBKW.js";import{a as re}from"./chunk-OS3ZP336.js";import{a as Wt,b as Bt,c as Ut,d as Ot,e as vt}from"./chunk-WJ3PVDDF.js";import{h as nt}from"./chunk-BO5YOOQA.js";import{j as pt,k as dt,l as ft,m as ut}from"./chunk-QTKQMZ5K.js";import{a as Rt}from"./chunk-Y5K5NJ6U.js";import{a as ge}from"./chunk-Q7FGM7BT.js";import{b as ke,c as Te}from"./chunk-MONRGJFN.js";import{a as We}from"./chunk-CZZFLX67.js";import{i as z,j as H}from"./chunk-IK72BO4I.js";import{$a as Pt,E as _t,H as Be,N as yt,a as Y,pb as ht,qa as wt,z as we}from"./chunk-QMENNGDH.js";import{r as O}from"./chunk-WGVA2GGS.js";import{o as ce}from"./chunk-XP3TNE3R.js";import{Cb as ye,jc as Pe,yb as it}from"./chunk-QRHYK2TW.js";import{a as me}from"./chunk-532YJKK4.js";import{c as A,e as _e}from"./chunk-AS4Z3FNS.js";import{c as L,d as Lt,e as he,g as oe}from"./chunk-VL2YBSHB.js";import{d as bt}from"./chunk-AVC4ODUV.js";import{c as T}from"./chunk-62ZAND24.js";import{a as Vo}from"./chunk-SIITVWZR.js";import{B as de,I as Me,he as at,ja as fe,ka as zo,la as ue,oe as Ho,ra as Xe,t as qe,u as Je,v as Qe,x as Le}from"./chunk-QHXUL3YM.js";import{H as ne,y as p}from"./chunk-MOTAOJVG.js";import{D as ee,H as le,e as ot,o as rt,q as X,r as st}from"./chunk-XR4SQWL7.js";import{H as pe,N as Ze,l as Ye,o as $e,ra as be}from"./chunk-CYTB2B6Q.js";import{K as et,aa as tt,ka as k}from"./chunk-6M3PZK2X.js";import{b as K}from"./chunk-OL67KS7C.js";import{f as _,o as r,q as s}from"./chunk-SHG7TIBL.js";r();s();var C=_(K()),Ae=_(Pe()),Ve=_(me()),J=_(ce());ne();_e();r();s();var V=_(K()),Ee=_(ce());_e();zo();Me();r();s();r();s();function Go(){}var qt=Go;var Jt=qt;r();s();var v=_(K());ne();r();s();var $={root:"_root_15akf_1",image:"_image_15akf_4",title:"_title_15akf_7",desc:"_desc_15akf_15",btns:"_btns_15akf_23","cancel-width":"_cancel-width_15akf_26",cancelWidth:"_cancel-width_15akf_26"};function De({type:t,step:o,onCancel:e,onRetry:a}){let c=bt({light:"./static/images/passkey-light-big.png",dark:"./static/images/passkey-dark-big.png"}),i={["create"]:{title:{text:"wallet_extension_biometrics_drawer_title_verification",keys:{num:1,total:2},color:"var(--okd-color-content-primary)"},desc:"wallet_extension_biometrics_drawer_desc_verification",cancel:"commonall_text_btn_cancel",onCancel:e},["verify"]:{title:{text:t==="create"?"wallet_extension_biometrics_drawer_title_verification":"wallet_extension_biometrics_drawer_title_unlock",keys:{num:2,total:2},color:"var(--okd-color-content-primary)"},desc:t==="create"?"wallet_extension_biometrics_drawer_desc_verification":"wallet_extension_biometrics_drawer_desc_unlock",cancel:"commonall_text_btn_cancel",onCancel:e},["error"]:{title:{text:"wallet_extension_biometrics_drawer_title_fail_setup",color:"var(--okd-color-semantic-negative)"},desc:"wallet_extension_biometrics_drawer_desc_fail_setup",confirm:"commonall_emptystate_text_try_again",onConfirm:a,cancel:"commonall_text_btn_cancel",onCancel:e},["init"]:null,["success"]:null}[o];return i?v.default.createElement(T.Container,{className:$.root},v.default.createElement(T.FlexBox,{className:$.image,align:T.ALIGN.center,justify:"center"},v.default.createElement(ot,{src:c,width:120,height:120})),v.default.createElement(O.Text,{strong:700,className:$.title,style:{color:i.title.color}},p(i.title.text,i.title.keys)),v.default.createElement(O.Text,{strong:400,className:$.desc},p(i.desc)),v.default.createElement(T.FlexBox,{className:$.btns,align:T.ALIGN.center,justify:"center"},v.default.createElement(k,{block:i.confirm,category:k.CATEGORY.fill,type:k.TYPE.gray,size:k.SIZE.lg,onClick:()=>{i.onCancel()},className:Dt({[$.cancelWidth]:!i.confirm})},p(i.cancel)),i.confirm?v.default.createElement(k,{block:!0,category:k.CATEGORY.fill,type:k.TYPE.highlight,size:k.SIZE.lg,onClick:()=>{i.onConfirm()}},p(i.confirm)):null)):null}function Z(){let[t]=Te(ke.credentialId),[o,e]=(0,V.useState)("init"),[a,c]=(0,V.useState)("init"),l=(0,V.useRef)(null),i=(0,V.useRef)(h=>h),P=async(h,d)=>{try{c("create"),e("create"),i.current=h,await Oe(500);let{password:g,credential:G,credentialId:M}=await Ut(d??"");e("verify");try{await Ot({credential:G,password:g})}catch(j){Jt(),e("error"),await h(null,j);return}l.current?.destroy(),e("success"),await h({password:g,credentialId:M})}catch(g){e("error"),await h(null,g)}},m=async h=>{try{c("verify"),e("verify"),i.current=h;let{password:d}=await vt(t);await A().verifyPassword(d),l.current?.destroy(),e("success"),await h(!!d)}catch{e("error"),await h(!1)}},S=()=>{e("init"),c("init"),l.current?.destroy()},N=()=>{a==="create"&&P(i.current),a==="verify"&&m(i.current)},F=async()=>{fe()!==de&&(l.current||(l.current=rt.action({mask:!1})),await Oe(100),l.current.update({visible:!0,mask:!0,onClose:()=>{S()},children:V.default.createElement(De,{step:o,type:a,onRetry:()=>{N()},onCancel:()=>{S()}})}))};return(0,Ee.useUpdateEffect)(()=>{if(o==="init"||o==="success"){l.current?.destroy();return}F()},[o]),(0,Ee.useUnmount)(()=>{l.current?.destroy()}),{create:P,verify:m}}Xe();Me();r();s();var E=_(K()),Ce=_(ce());ne();r();s();var xe={root:"_root_cl85f_1",passwordInput:"_passwordInput_cl85f_6"};var Qt=({onBack:t,onComplete:o,title:e=void 0,desc:a=void 0,learnMoreProps:c={},showLearnMore:l=!0,disabled:i=!1,autoFocus:P=!1,customContent:m=E.default.createElement(E.default.Fragment,null),containerClassName:S=""})=>{let h=se().get("from")===w.HARDWARE,d=ee.useForm(),[g,G]=(0,E.useState)({}),[M,{setTrue:j,setFalse:ae}]=(0,Ce.useBoolean)(!1);Kt(d,g);let R=!g.password||!g.confirm||g.password?.length<Ue||g.confirm?.length<Ue||g.password!==g.confirm,Q=(0,Ce.useMemoizedFn)(async()=>{let{password:u,confirm:f}=g;if(!(M||R)){if(u!==f){Vt(d);return}mt(),j(),await o(f),ae()}},[R,g]),ie=(0,E.useCallback)(async u=>{(u?.key==="Enter"||u?.keyCode===13)&&await Q()},[]),n=jt();return(0,E.useEffect)(()=>(document.addEventListener("keydown",ie),()=>{document.removeEventListener("keydown",ie)}),[]),E.default.createElement(Gt,{className:xe.root,containerClassName:S,title:e||p("wallet_signup_maintitle_set_password"),desc:a||p(h?"wallet_extension_signup_subtitle_set_password_hardware":"wallet_extension_subtitle_password_unlock"),showLearnMore:l,learnMoreProps:c,onBack:t},({formClass:u,formErrorClass:f,itemClass:W})=>E.default.createElement(ee,{form:d,size:X.SIZE.lg,validateTrigger:["onChange","onBlur"],className:u,errorClassName:f,onValuesChange:(b,B)=>{G(B)}},E.default.createElement(ee.Item,{name:"password",style:{marginBottom:0},className:W,label:p("wallet_set_password_subtitle_password")},E.default.createElement(X.Password,{autoFocus:P,autoComplete:"off",size:X.SIZE.xl,inputClassName:xe.passwordInput,placeholder:p("wallet_settings_reset_passord_placeholder_input_desc")})),E.default.createElement(ee.Item,{noStyle:!0,shouldUpdate:(b,B)=>b.password!==B.password},({getFieldValue:b})=>{let B=b("password");return E.default.createElement(Ft,{password:B})}),E.default.createElement(ee.Item,{name:"confirm",className:W,label:p("wallet_settings_reset_passord_subtitle_password_confirmation"),style:{flex:1,marginTop:"32px"}},E.default.createElement(X.Password,{autoComplete:"off",size:X.SIZE.xl,inputClassName:xe.passwordInput,placeholder:p("wallet_settings_reset_passord_placeholder_input_password_confirmation"),onChange:()=>{d.cleanErrors("confirm")}})),m,E.default.createElement(ge.FooterActions,{usePortal:!0,renderNative:!0,affixStyle:n,buttonGroup:[{loading:M,disabled:i||R,block:!0,type:k.TYPE.highlight,category:k.CATEGORY.fill,size:k.SIZE.lg,btnText:p("wallet_set_password_btn_confirm"),onClick:Q}]})))};r();s();r();s();var I=_(K());var Xt=_(Vo());ne();r();s();var D={content:"_content_1cywj_1",title:"_title_1cywj_4",desc:"_desc_1cywj_12",list:"_list_1cywj_19",item:"_item_1cywj_22","item-select":"_item-select_1cywj_39",itemSelect:"_item-select_1cywj_39","item-content":"_item-content_1cywj_42",itemContent:"_item-content_1cywj_42","item-title":"_item-title_1cywj_46",itemTitle:"_item-title_1cywj_46","item-desc":"_item-desc_1cywj_54",itemDesc:"_item-desc_1cywj_54",link:"_link_1cywj_61",anchor:"_anchor_1cywj_65",icon:"_icon_1cywj_66"};function Fe({list:t,active:o,history:e}){return I.default.createElement(I.default.Fragment,null,t.map(a=>I.default.createElement(T.FlexBox,{className:(0,Xt.default)(D.item,{[D.itemSelect]:o(a.type)}),direction:T.DIRECTION.horizontal,align:T.ALIGN.center,justify:"space-between",onClick:()=>{a.onClick()}},I.default.createElement(T.Box,{className:D.itemContent},I.default.createElement(O.Text,{className:D.itemTitle},p(a.title)),I.default.createElement(O.Text,{className:D.itemDesc},p(a.desc)),a.link?I.default.createElement(T.FlexBox,{className:D.link,direction:T.DIRECTION.horizontal,align:T.ALIGN.center},I.default.createElement(et,{alt:p(a.link.text),rel:"nofollow",onClick:c=>{c.stopPropagation(),c.preventDefault(),nt(),e.push(a.link.url)},className:D.anchor},p(a.link.text)),I.default.createElement(tt,{iconName:"okds-arrow-chevron-right-centered-md",className:D.icon})):null,a.bottomElement??null),o(a.type)?I.default.createElement(st.Circle,{checked:!0}):null)))}var eo=Fe;r();s();var oo=_(K()),Re=_(Pe()),ro=_(me());ne();r();s();var to={"recommend-label":"_recommend-label_1iacj_1",recommendLabel:"_recommend-label_1iacj_1"};function so(){let t=(0,ro.useHistory)(),o=(0,Re.useSelector)(ye),e=(0,Re.useSelector)(it);o&&!e&&t.replace(Y)}var ao=({handleClickPasskey:t,handleClickPassword:o,completedOnboarding:e,passwordType:a})=>[{type:2,title:"wallet_extension_biometrics_radio_title_authentication",desc:"wallet_extension_biometrics_radio_desc_authentication",onClick:t,bottomElement:oo.default.createElement("div",{className:to.recommendLabel},p("wallet_biometrics_tag_recommend"))},{type:1,title:"wallet_extension_biometrics_radio_title_password",desc:"wallet_extension_biometrics_radio_desc_password",onClick:o,link:e&&a===1?{url:we,text:"wallet_extension_biometrics_btn_change_password"}:null}],io=async({result:t,modifyPassword:o})=>{let e=!1;return e=await o(t?.password),e},no=!1,lo=async()=>await Wt(),co=t=>{};r();s();var q={root:"_root_mpzi1_1",content:"_content_mpzi1_4",title:"_title_mpzi1_7",desc:"_desc_mpzi1_15",list:"_list_mpzi1_22",item:"_item_mpzi1_25","item-select":"_item-select_mpzi1_32",itemSelect:"_item-select_mpzi1_32","item-title":"_item-title_mpzi1_35",itemTitle:"_item-title_mpzi1_35","item-desc":"_item-desc_mpzi1_43",itemDesc:"_item-desc_mpzi1_43",link:"_link_mpzi1_50",anchor:"_anchor_mpzi1_54",icon:"_icon_mpzi1_55",forgot:"_forgot_mpzi1_67"};r();s();r();s();function jo(){let{verify:t}=Z();return async e=>{await t(a=>{a&&e()})}}var mo=jo;var po=mo;r();s();var ko=_(K()),Se=_(Pe()),To=_(me());be();_e();r();s();be();_e();var He={[he.addAccount]({hardware:t,account:o,baseChain:e,walletId:a}){return We(),A().addHardwareWalletAccount(t,o,e,a)},[he.addChain]({account:t,baseChain:o,walletId:e}){return A().addChainForHardwareWallet(t,o,e)},others({hardware:t,account:o,baseChain:e}){return We(),A().importHardwareWalletAccount(t,o,e)}},Ko={async[L.ledger](t){let{otherInfo:o}=t,{ledgerInfo:e}=o;t.hardwareWalletModel=e.productName||oe[L.ledger]},[L.trezor](t){t.hardwareWalletModel=oe[L.trezor]},[L.keystone](t){let{otherInfo:o}=t,{keystoneInfo:e}=o;t.hardwareWalletModel=e.device||oe[L.keystone]},[L.onekey](t){let{otherInfo:o}=t,{onekeyInfo:e}=o,a=e?.deviceType?`${Lt[L.onekey]} ${Ye(e?.deviceType)}`:"";t.hardwareWalletModel=a||oe[L.onekey]}},fo=({accounts:t,hardware:o,baseChain:e,walletId:a,type:c,...l})=>async()=>{let i;for(let P=0;P<t.length;P++){let m=$e(t[P]);m.otherInfo=l,await Ko[o](m),m.hardwareWalletType=oe[o];let S=He[c];S||(i?.walletId?(c=he.addAccount,a=i.walletId,S=He[c]):S=He.others);let N=await S({hardware:o,account:m,baseChain:e,walletId:a});i??=N}return i};r();s();var uo=_(me()),_o=_(ce());Ho();var Yo=()=>{let t=(0,uo.useHistory)();return(0,_o.useMemoizedFn)((...o)=>{let e=o[0];t.push({pathname:wt,search:`?type=${at.INITIALIZE}`,...e!==void 0&&{state:{hasPassword:e}}})})},yo=Yo;r();s();var Po=_(me()),ho=_(ce());be();r();s();var wo="NEW_USER_JUST_SET";function $o(){let t=(0,Po.useHistory)(),{isSyncSupported:o,hasSyncEnabled:e,hasWalletDataOnCloud:a,isDataValidated:c}=Zt();return(0,ho.useMemoizedFn)(l=>o&&c&&Ze(e)&&!a&&[w.CREATE,w.SEED,w.KEY].includes(l)?(t.replace({pathname:ht,search:`?user=${wo}&type=${l}`}),l):null)}var go=$o;Xe();Me();var Ne=t=>{let o=(0,To.useHistory)(),e=(0,Se.useDispatch)(),a=go(),c=yo(),{seedPhrase:l,privateKey:i,mpcInfo:P,unlockHardwareWallets:m,chooseNetworkList:S,isTonMnemonic:N}=(0,Se.useSelector)(n=>({seedPhrase:gt(n),isTonMnemonic:Ct(n),privateKey:kt(n),chooseNetworkList:xt(n),mpcInfo:Et(n),unlockHardwareWallets:Tt(n)})),{setValue:F}=$t(),{value:h}=Yt();(t===w.SEED&&!l||t===w.KEY&&!i||t===w.BULK&&!h||t===w.MPC&&(!P||pe(P))||t===w.HARDWARE&&(!m||pe(m)))&&o.push(Y);let d=n=>{if(a(t))return;let u=`${Be}/${t}`,{keyringName:f="",walletName:W=""}=n||{},b=`${f}-${W}`;o.push({pathname:u,state:{walletName:b,anim:"1",next:Y}})},g=async n=>{await e(pt(n)),await e(re()),a(t)||c(!0)},G=async n=>{let u=l?.trim().toLowerCase().match(/\w+/gu)?.join(" ")||"",f=await e(dt(n,{mnemonic:u,isTonMnemonic:N}));e(St()),await e(re()),d(f)},M=async n=>{let u=await e(ft(n,{baseChains:S,privateKey:i}));e(Nt()),await e(re()),d(u)},j=n=>{F(n),o.push(Pt)},ae=async(n,u)=>{pe(m)||(await A().setPassword(n,!0),await e(z(u?2:1)),await e(H(u)),await e(fo(m)),await e(re()),e(At()));let f=`${Be}/${w.HARDWARE}`;ue()===Qe&&globalThis.platform.openExtensionInPopup(`${f}?anim=1`)},R=async n=>{let{cipherText:u,privateKey:f,mpcId:W,userInfo:b}=P;if(u&&f&&W){let B=await e(ut(n,{cipherText:u,privateKey:f},{mpcId:W,userInfo:b},!0));e(It()),await e(re()),d(B)}},Q={[w.CREATE]:g,[w.SEED]:G,[w.KEY]:M,[w.BULK]:j,[w.HARDWARE]:ae,[w.MPC]:R};return(0,ko.useCallback)(async(n,u)=>{try{await Q[t](n,u)}catch(f){le.error(f.message?f.message:JSON.stringify(f))}},[t])};r();s();r();s();var Eo=_(Pe());var Zo=()=>{let{create:t}=Z(),e=se().get("from")||w.CREATE,a=Ne(e),c=(0,Eo.useDispatch)();return async(...l)=>{await t(async i=>{if(i){let{password:P,credentialId:m}=i;await a(P,m),await c(z(2)),await c(H(m)),te({button_name:"biometric",platform:"extension"})}},...l)}},xo=Zo;var Co=xo;var w={SEED:"seed",KEY:"key",HARDWARE:"hardware",CREATE:"create",MPC:"mpc",BULK:"bulk"},qo=()=>{let t=(0,Ve.useHistory)(),o=ue(),e=o===qe||o===Le,a=o===Je,c=o===Le;return{openNotification:()=>{let{pathname:P,search:m}=t.location,S=m?"&":"?",N="openFromThisPage=1";globalThis.platform.openExtensionInPopup(`${P}${m}${S}${N}`,null,!c)},closeNotification:()=>{window.close()},needOpenNotification:e,isNotification:a}};function Jo(){let t=(0,Ve.useHistory)(),o=(0,Ae.useDispatch)(),e=po(),{needOpenNotification:a,isNotification:c,openNotification:l,closeNotification:i}=qo(),P=()=>{a?t.goBack():t.push(Y)},[m]=Te(ke.passwordType),[,S]=Mt(),[N,F]=(0,C.useState)(2),h=fe()===de?"telegram":"extension";(0,J.useMount)(async()=>{await Bt()||F(1)});let d=(0,Ae.useSelector)(ye);so();let[g,G]=(0,C.useState)(!1);(0,J.useAsyncEffect)(async()=>{try{if(await lo(d))return;let U=d?yt:_t;t.replace({pathname:U,search:t.location.search})}finally{G(!0)}},[]);let M=se(),j=M.get("from")||w.CREATE,ae=Ne(j),R=M.get("openFromThisPage")==="1",Q=x=>d?m===x:N===x,[ie,{toggle:n}]=(0,J.useToggle)(!1),[u,{toggle:f}]=(0,J.useToggle)(!1),W=ve(ct),b=ve(lt),{create:B,verify:So}=Z(),No=Co(),Ao=async()=>{if(a){l();return}No()},Io=async()=>{f()},bo=async x=>{await B(async U=>{if(U){let Ke=!1,Ro=U?.credentialId;n(),Ke=await io({result:U,modifyPassword:A().modifyPassword}),Ke&&(le.success(p("wallet_edit_wallet_toast_renamed_success")),await o(z(2)),S(!0),await o(H(Ro)),te({button_name:"biometric",platform:h}),c&&R&&i())}},no?x:"")},Ge=async x=>{let U=null;x?(f(),U=await A().modifyPassword(x)):U=!0,U&&(le.success(p("wallet_edit_wallet_toast_renamed_success")),await o(z(1)),S(!0),await o(H(void 0)),te({button_name:"password",platform:h}),c&&R&&i())},Lo=()=>{if(!d){F(2);return}if(d&&m===2){t.goBack();return}if(a){l();return}n()},Mo=async()=>{if(!d){F(1);return}if(d&&m===1){t.goBack();return}if(a){l();return}await So(x=>{x&&f()})},Wo=()=>{n()},Bo=async()=>{await e(f,Ge)},[Uo,Ie]=(0,C.useState)(!1),Oo=async()=>{try{Ie(!0),N===2?(await Ao(),W()):(await Io(),b())}catch{Ie(!1)}finally{Ie(!1)}},je=async x=>{co(x),x?Wo():Bo()},vo=()=>{t.push({pathname:we})},Do=()=>ao({handleOpenVerify:je,handleSetPassword:vo,handleClickPasskey:Lo,handleClickPassword:Mo,completedOnboarding:d,passwordType:m});if(!g)return null;if(ie)return C.default.createElement(Ht,{onBack:n,callback:bo});if(u)return C.default.createElement(Qt,{onBack:f,onComplete:async x=>{d?await Ge(x):(await ae(x),await o(z(1)),await o(H(void 0)),te({button_name:"password",platform:h}))}});let Fo={list:Do(),active:Q,passwordType:m,history:t,handleOpenVerify:je};return C.default.createElement(T.Box,{className:q.root},C.default.createElement(Rt,{bordered:!1,closeable:!1,onBack:P}),C.default.createElement(T.Container,{className:q.content},C.default.createElement(O.Text,{className:q.title},p("wallet_extension_biometrics_header_title_unlock")),C.default.createElement(O.Text,{className:q.desc},p("wallet_extension_biometrics_desc_unlock")),C.default.createElement(T.Box,{className:q.list},C.default.createElement(eo,{...Fo})),C.default.createElement(ge.FooterActions,null,d?C.default.createElement(zt,{className:q.forgot,strong:!0}):C.default.createElement(k,{block:!0,category:k.CATEGORY.fill,type:k.TYPE.highlight,size:k.SIZE.lg,loading:Uo,onClick:()=>{Oo()}},p("commonall_button_text_next")))))}export{Qt as a,fo as b,yo as c,go as d,Co as e,w as f,Jo as g};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-Z475AMKL.js.map
