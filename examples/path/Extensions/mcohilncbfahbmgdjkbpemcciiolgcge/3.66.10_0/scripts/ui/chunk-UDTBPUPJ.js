import{l as st}from"./chunk-QJYNTF2A.js";import{a as Q}from"./chunk-TW4KQJBW.js";import{a as $}from"./chunk-7DDBBEVP.js";import{a as ct}from"./chunk-RF6MZE6O.js";import{b as at}from"./chunk-HPJHY2AY.js";import{a as J}from"./chunk-CK7Z2DAQ.js";import{a as N}from"./chunk-OQZ6UOCK.js";import{h as uo,q as _o,r as yo}from"./chunk-TEVAE4SY.js";import{a as it}from"./chunk-V2QGBG3D.js";import{c as tt}from"./chunk-5TLDWKXV.js";import{a as E}from"./chunk-7GRDW7ZD.js";import{f as fo,g as et,h as rt,i as nt}from"./chunk-J3K74NCM.js";import{a as S,d as K}from"./chunk-7X4DXTSI.js";import{a as b}from"./chunk-CIEH2J25.js";import{a as P,b as lo}from"./chunk-64LKONIY.js";import{l as u}from"./chunk-NKIUEXOA.js";import{a as po}from"./chunk-4ZGOJDNI.js";import{a as eo}from"./chunk-NWY3GPDX.js";import{c as Vo}from"./chunk-36PYO4PJ.js";import{e as Zo}from"./chunk-636UWIUZ.js";import{a as ot}from"./chunk-T4RFDN7D.js";import{d as $o,i as Qo}from"./chunk-MKDQBVRZ.js";import{k as Ro}from"./chunk-KDVER5QK.js";import{a as j}from"./chunk-Y5K5NJ6U.js";import{a as Z}from"./chunk-Q7FGM7BT.js";import{b as Ao}from"./chunk-TKE74ERX.js";import{d as Xo}from"./chunk-MONRGJFN.js";import{n as Ko,q as Jo,r as H}from"./chunk-WGVA2GGS.js";import{o as no}from"./chunk-XP3TNE3R.js";import{Db as Uo,jc as V,pb as to,zb as Ho}from"./chunk-QRHYK2TW.js";import{j as B,p as mo}from"./chunk-Q4YLD24R.js";import{c as zo,e as Ot}from"./chunk-AS4Z3FNS.js";import{a as vo}from"./chunk-2FDQIA7D.js";import{c as T}from"./chunk-62ZAND24.js";import{a as jo}from"./chunk-SIITVWZR.js";import{D as q,I as Po,Pd as Gt,S as Go,gc as so,ia as Lt,od as qo,pd as co}from"./chunk-QHXUL3YM.js";import{H as v,y as s}from"./chunk-MOTAOJVG.js";import{G as Eo,d as bo,e as Yo}from"./chunk-XR4SQWL7.js";import{e as Lo,ra as Wt}from"./chunk-CYTB2B6Q.js";import{aa as Oo,ka as O}from"./chunk-6M3PZK2X.js";import{b as A}from"./chunk-OL67KS7C.js";import{f,o as c,q as m}from"./chunk-SHG7TIBL.js";c();m();var h=f(A()),mt=f(no());v();Po();var Yt=({unapproved:o})=>{let[t,{cancel:e,approve:n}]=st(o),r=N(t),{rpcNetworks:a}=Zo(),i=a.find(I=>I.rpcUrl===t.rpcUrl),{loading:l,onClick:p}=b(e),w=(0,h.useMemo)(()=>({actionType:u.ACTION_TYPE.CANCEL,onClick:p,loading:l}),[l,p]),_=(0,mt.useMemoizedFn)(async()=>{await n(),Eo.success({duration:1.5,title:s("developer_mode_home_toast_added"),placement:Eo.DIRECTION.top})}),{loading:C,onClick:y}=b(_),D=(0,h.useMemo)(()=>({loading:C,disabled:!!i,actionType:u.ACTION_TYPE.CONFIRM,btnText:s("developer_mode_add_network_btn_approve"),onClick:y}),[i,C,y]),M=[w,D];return h.default.createElement(T.Container,null,h.default.createElement(j,{title:s("developer_mode_add_network_maintitle_add_network"),backable:!1,closeable:!1}),h.default.createElement(S,null,h.default.createElement(J,{...r})),h.default.createElement(S,{bordered:!1},h.default.createElement(P,{title:s("developer_mode_add_network_title_network_name"),tooltip:s("wallet_dapp_conncetion_add_network_subtitle_network_name_tips")},t.type||t.chainName),t.switchType===q.ADD_ETHEREUM_CHAIN&&[h.default.createElement(P,{title:s("developer_mode_add_network_title_networkurl"),tooltip:s("wallet_dapp_conncetion_add_network_subtitle_network_url_tips")},t.rpcUrl),h.default.createElement(P,{title:s("developer_mode_add_network_title_chainid"),tooltip:s("wallet_dapp_conncetion_add_network_subtitle_chain_id_tips")},t.chainIdToDisplay),h.default.createElement(P,{title:s("developer_mode_add_network_title_currency_symbol"),tooltip:s("wallet_dapp_conncetion_add_network_subtitle_currency_symbol_tips")},t.ticker),h.default.createElement(P,{title:s("developer_mode_add_network_title_block_explorerurl"),tooltip:s("wallet_dapp_conncetion_add_network_subtitle_explorer_url_tips")},t.explorers||t.blockExplorerUrl)]),h.default.createElement(Z,{placeholder:!0,offsetBottom:0,borderTop:!0},h.default.createElement(K,{type:i?bo.TYPE.error:bo.TYPE.warn,message:i?s("developer_mode_infor_errortip_used_network",{network:i.name}):s("developer_mode_add_network_errortip_risk_aware")}),h.default.createElement(u,{buttonGroup:M})))},Te=Yt;c();m();var ko=f(A());Po();c();m();var X=f(A()),ut=f(V());Wt();Po();qo();c();m();var io=f(A());var qt=o=>{let[t,e]=(0,io.useState)(null),[n,r]=(0,io.useState)(!1),a=eo();return(0,io.useEffect)(()=>{if(a?.length){let i=a.find(l=>l.realChainIdHex===o);i?(e(i?.chainId),r(!1)):(e(+vo(o)),r(!0))}},[a,o]),{chainIndex:t,isRpcChain:n}},go=qt;c();m();var ao=f(V());Gt();var F=(o,t)=>{let e=(0,ao.useSelector)(Uo),n=(0,ao.useSelector)($o),r=(0,ao.useSelector)(Ho),a=(0,ao.useSelector)(p=>Qo(p,o)),i=p=>({...p,address:t});if(n[o]?.includes(r)&&e[r]?.account[co]===t)return i(e[r]||{});if(n[o]?.includes(a)&&e[a]?.account[co]===t)return i(e[a]);let l=n[o]?.find(p=>e[p]?.account[co]===t);return l?i(e[l]):{}};c();m();var So=f(V());mo();c();m();var pt=f(V());Lt();var zt=o=>{let t=(0,pt.useSelector)(to),e=ot(),n=(r,a)=>e.find(i=>i.localType===a||Go(i.chainId,r))||{};return o?n(o):n(t.chainId,t.type)},W=zt;var lt=o=>{let t=(0,So.useDispatch)(),e=Q(),{walletId:n}=F(o.origin,o.msgParams?.from),r=E(n),a=W(o?.chainId);return async()=>{r({all_confirmation:"cancel",trade:"sign",dapp_url:o.origin,network:a?.chainName});let{id:i}=o;await e({id:i}),await B(t)}},Ht=o=>{let t=(0,So.useDispatch)(),e=$(),n=lt(o),{walletId:r}=F(o.origin,o.msgParams?.from),a=fo({walletId:r}),i=E(r),l=W(o?.chainId);return async()=>{let{id:p,msgParams:w,type:_}=o;try{if(i({all_confirmation:"confirm",trade:"sign",dapp_url:o.origin,network:l?.chainName}),!await po({walletId:r,callback:async()=>{await n(),await B(t)}}))return;let y=await a({msgParams:w,baseChain:o.localType,type:_});await e({id:p,result:y}),await B(t)}catch(C){e({id:p,error:C?.message||"Failed"})}}},Ut=({unapproved:o,preExecInfo:t={}})=>{let e=lt(o),{loading:n,onClick:r}=b(e),a={actionType:u.ACTION_TYPE.CANCEL,onClick:r,loading:n},i=Ht(o),{loading:l,onClick:p}=b(i),w={actionType:u.ACTION_TYPE.CONFIRM,disabled:t?.canConfirm===!1,onClick:p,loading:l};return{buttonGroup:[a,w],handleCancel:e}},ft=Ut;var vt=({unapproved:o={}})=>{let[t,e]=(0,X.useState)({}),n=N(o),{buttonGroup:r,handleCancel:a}=ft({unapproved:o,preExecInfo:t}),{type:i,msgParams:l,chainId:p}=o,{chainId:w}=(0,ut.useSelector)(to),_=p||w,{from:C,isSilentSign:y}=l,D=(0,X.useMemo)(()=>{let G=o.msgParams?.data,U={[q.ETH_SIGN](){return[{value:G}]},[q.PERSONAL_SIGN](){return[{value:Vo(G)}]},[q.ETH_SIGN_TYPED_DATA](){return G}};return Lo(U[i])?U[i]():[]},[i,o.msgParams?.data]),M=F(o.origin,C)||{},I=go(_),L=(0,X.useMemo)(()=>({method:i,dappData:JSON.stringify(l),dappInfo:n,from:C,message:D,...I}),[I?.chainIndex]),[x={}]=eo({chainId:I?.chainIndex})||[];return X.default.createElement(yo,{needPreExecFn:({method:G})=>G!==q.PERSONAL_SIGN,txType:_o.signMessage,handleCancel:a,preExecParams:L,walletAccount:M,buttonGroup:r,localType:so,onUpdatePreExecInfo:e,networkFeeProps:{network:x},slot:{bottom:!!y&&X.default.createElement(uo,null)}})},dt=vt;c();m();var R=f(A()),ht=f(V());qo();c();m();var g=f(A());v();c();m();var No=f(A()),_t=f(V());mo();var Vt=({unapproved:o,walletAccount:t,preExecInfo:e={}})=>{let n=(0,_t.useDispatch)(),{walletId:r}=t,a=E(r),i=W(o.chainId),l=$(),p=Q(),w=fo({walletId:r}),_=(0,No.useCallback)(async()=>{let{id:U}=o;a({trade:"sign",all_confirmation:"cancel",network:i?.chainName,dapp_url:o?.origin}),await p({id:U}),await B(n)},[i?.chainName,p,a,n,o]),C=(0,No.useCallback)(async()=>{let{msgParams:U,id:Fo,localType:Mt,type:Bt}=o;try{if(a({trade:"sign",all_confirmation:"confirm",network:i?.chainName,dapp_url:o?.origin}),!await po({walletId:r,callback:async()=>{await _()}}))return;let Ft=await w({msgParams:U,baseChain:Mt,type:Bt});await l({id:Fo,result:Ft}),await B(n)}catch(Wo){l({id:Fo,error:Wo?.message||"Failed"})}},[o,a,r,n,_,i?.chainName,w,l]),{loading:y,onClick:D}=b(_),M={actionType:u.ACTION_TYPE.CANCEL,onClick:D,loading:y},{loading:I,onClick:L}=b(C),x={actionType:u.ACTION_TYPE.CONFIRM,type:O.TYPE.highlight,disabled:e?.canConfirm===!1,onClick:L,loading:I};return{buttonGroup:[M,x],handleCancel:_}},Co=Vt;c();m();var ho=f(A());c();m();var wo={root:"_root_szca8_1",icon:"_icon_szca8_5",showValue:"_showValue_szca8_11"};var Zt=({icon:o,amount:t,symbol:e})=>ho.default.createElement(T.Box,{className:wo.root},ho.default.createElement(Yo,{src:o,className:wo.icon}),ho.default.createElement(H.AdaptiveText,{autoSize:at,ellipsis:{tooltip:!0},className:wo.showValue},"- ",t," ",e)),yt=Zt;c();m();var xo=f(A()),gt=f(jo()),Ct=f(no());c();m();var Io={root:"_root_1wji9_1",price:"_price_1wji9_4",switchIcon:"_switchIcon_1wji9_11"};var jt=({fromSymbol:o,toSymbol:t,price:e,reversePrice:n})=>{let[r,{toggle:a}]=(0,Ct.useBoolean)(!1),i=r?t:o,l=r?o:t,p=r?n:e;return xo.default.createElement(T.FlexBox,{className:Io.root},xo.default.createElement(H.Text,{size:H.SIZE.sm,ellipsis:{tooltip:!0},className:Io.price},"1 ",i," = ",p," ",l),xo.default.createElement(Ao,{size:Ao.SIZE.xs,className:(0,gt.default)("okx-wallet-plugin-switch",Io.switchIcon),onClick:a}))},Do=jt;var Kt={CREATE:"10",REVOCATION:"20"},Jt=({unapproved:o={}})=>{let t=W(o.chainId),{dexExtraData:e}=JSON.parse(o.msgParams.data),n=N(o),r=F(o.origin,o.msgParams?.from),{buttonGroup:a}=Co({unapproved:o,walletAccount:r}),{expiration:i,order:l,predictPriceFormat:p,reversePredictPrice:w,sellTokenAmountFormat:_,sellTokenImage:C,sellTokenSymbol:y,type:D}=e,M={icon:C,symbol:y,amount:_},{fromSymbol:I,toSymbol:L,priceFormat:x,reversePrice:G}=l,U=E(r.walletId);return g.default.createElement(T.Container,null,g.default.createElement(j,{title:D===Kt.CREATE?s("swaptrade_limit_title_place_limit_order"):s("swaptrade_limit_title_cancel_limit_order"),closeable:!1,backable:!1}),g.default.createElement(S,null,g.default.createElement(P,{title:s("extension_contract_interaction_maintitle_asset_changes"),tooltip:s("extension_infor_tooltip_asset_changestips")},g.default.createElement(yt,{...M})),g.default.createElement(J,{...n})),g.default.createElement(S,null,g.default.createElement(lo,{title:s("wallet_extension_network_address_title_walletused"),address:r.address,walletId:r.walletId,onCopyCallback:()=>{U({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}})),g.default.createElement(S,{bordered:!1},g.default.createElement(P,{title:s("swaptrade_limit_text_limit_price")},g.default.createElement(Do,{toSymbol:L,price:x,fromSymbol:I,reversePrice:G})),g.default.createElement(P,{title:s("swaptrade_limit_text_est_execution_price"),tooltip:s("swaptrade_limit_tooltip_estimated_price")},g.default.createElement(Do,{toSymbol:L,fromSymbol:I,price:p,reversePrice:w})),g.default.createElement(P,{title:s("swaptrade_limit_text_expiry_time")},g.default.createElement(Jo,{size:Ko.sm,dateTime:i,format:"yyyyMMddHHmm"})),g.default.createElement(ct,{coinId:t?.coinId})),g.default.createElement(Z,{placeholder:!0,offsetBottom:0,borderTop:!0},g.default.createElement(u,{buttonGroup:a})))},wt=Jt;var $t=({unapproved:o})=>{let[t,e]=(0,R.useState)({}),{chainId:n,msgParams:{version:r,data:a,from:i,isSilentSign:l}}=o,{chainId:p}=(0,ht.useSelector)(to),_=go(n||p),C=N(o),y=F(o.origin,i)||{},{buttonGroup:D,handleCancel:M}=Co({unapproved:o,preExecInfo:t,walletAccount:y}),I=(0,R.useMemo)(()=>({dappInfo:C,dappData:JSON.stringify(o?.msgParams),from:i,method:`eth_signTypedData_${r.toLowerCase()}`,..._}),[_?.chainIndex]),[L={}]=eo({chainId:_?.chainIndex})||[];if(r==="V4"){let x={};try{x=JSON.parse(a)}catch(G){console.log(G)}if(x.dexExtraData)return R.default.createElement(wt,{unapproved:o})}return R.default.createElement(yo,{txType:_o.signTypedData,handleCancel:M,preExecParams:I,walletAccount:y,buttonGroup:D,localType:so,onUpdatePreExecInfo:e,networkFeeProps:{network:L},slot:{bottom:!!l&&R.default.createElement(uo,null)}})},It=$t;c();m();var Y=f(A());v();c();m();var oo=f(A());v();var Qt=({walletAccount:o,children:t,chainId:e})=>{let[n]=Xo(),{walletAsset:r}=Ro(o.walletId),a=E(o.walletId),i=W(e);return it(i?.coinId,o.walletId),oo.default.createElement(oo.default.Fragment,null,oo.default.createElement(S,null,oo.default.createElement(lo,{title:s("wallet_extension_network_address_title_walletused"),address:o.address,walletId:o.walletId,onCopyCallback:()=>{a({trade:"contract_interaction",all_confirmation:"wallet_used_address"})}})),oo.default.createElement(S,{bordered:!1},oo.default.createElement(P,{title:s("wallet_dapp_connection_subtitle_balance")},oo.default.createElement(H.DisplayAmount,{ellipsis:!0,size:H.SIZE.sm,mode:H.LEGAL,useApproximate:!1,hidden:n?"***":!1},r)),t))},To=Qt;c();m();var k=f(A()),xt=f(jo());v();c();m();var ro={root:"_root_1xv1e_1",msgWrap:"_msgWrap_1xv1e_12",decrypted:"_decrypted_1xv1e_20",copyMsg:"_copyMsg_1xv1e_23",decryptMsg:"_decryptMsg_1xv1e_28"};var Xt=({rawData:o})=>{let t=tt({showDesc:!1});return k.default.createElement(O,{rect:!0,size:O.SIZE.xxs,type:O.TYPE.primary,category:O.CATEGORY.outline,className:ro.copyMsg,onClick:()=>{t(o)}},k.default.createElement(Oo,{className:"okx-wallet-plugin-copy"}),k.default.createElement(T.Box,null,s("wallet_extension_encrypted_text_copy")))},Rt=({unapproved:o,decryptCb:t})=>{let e=rt(),n=(0,k.useCallback)(async()=>{let{msgParams:r}=o,a=await e(r);t(a)},[t,e,o]);return k.default.createElement(O,{className:ro.decryptMsg,size:O.SIZE.sm,type:O.TYPE.primary,category:O.CATEGORY.outline,icon:"okds-locked",iconType:O.ICON_POSITION.leading,onClick:n},s("wallet_dapp_conncetion_subtitle_decrypt_metamask_information"))},oe=({unapproved:o={}})=>{let[t,e]=(0,k.useState)(!1),[n,r]=(0,k.useState)(o.msgParams?.data),[a,i]=(0,k.useState)(!1),l=p=>{p.error?(i(!0),r(s("wallet_dapp_conncetion_errortip_decrypt_error",{errorMessage:p.error}))):r(p.rawData),e(!0)};return k.default.createElement(P,{title:s("wallet_extension_encrypted_text_encrypted_message")},k.default.createElement(T.Box,{className:ro.root},k.default.createElement(T.Box,{className:(0,xt.default)(ro.msgWrap,{[ro.decrypted]:t})},n),t?!a&&k.default.createElement(Xt,{rawData:n}):k.default.createElement(Rt,{unapproved:o,decryptCb:l})))},Tt=oe;c();m();var kt=f(V()),Mo=f(no());v();mo();var te=(o,t)=>{let{id:e}=o,n=(0,kt.useDispatch)(),r=E(t?.walletId),a=W(),i=Q(),l=(0,Mo.useMemoizedFn)(async()=>{r({all_confirmation:"cancel",trade:"decrypt_message",dapp_url:o.origin,network:a?.chainName}),await i({id:e}),await B(n)}),{loading:p,onClick:w}=b(l),_={loading:p,actionType:u.ACTION_TYPE.CANCEL,btnText:s("wallet_dapp_connection_btn_reject"),onClick:w},C=nt(),y=$(),D=(0,Mo.useMemoizedFn)(async()=>{try{r({all_confirmation:"confirm",trade:"decrypt_message",dapp_url:o.origin,network:a?.chainName});let{msgParams:x}=o,G=await C(x);await y({id:e,result:G}),await B(n)}catch(x){console.log(x),y({id:e,error:"Failed"})}}),{loading:M,onClick:I}=b(D),L={loading:M,actionType:u.ACTION_TYPE.CONFIRM,onClick:I};return[_,L]},Pt=te;var ee=({unapproved:o})=>{let t=N(o),e=F(o.origin,o.msgParams?.from),n=N(o),r=Pt(o,e),a=(0,Y.useMemo)(()=>({type:K.TIP_TYPE.NORMAL,message:s("wallet_dapp_conncetion_notify_decrypt_message",{siteName:n.name||n.host})}),[n]);return Y.default.createElement(T.Container,null,Y.default.createElement(j,{title:s("wallet_dapp_conncetion_subtitle_decrypt_request"),closeable:!1,backable:!1}),Y.default.createElement(S,null,Y.default.createElement(J,{...t})),Y.default.createElement(To,{walletAccount:e,chainId:o.chainId},Y.default.createElement(Tt,{unapproved:o})),Y.default.createElement(Z,{placeholder:!0,offsetBottom:0,borderTop:!0},Y.default.createElement(K,{...a}),Y.default.createElement(u,{buttonGroup:r})))},bt=ee;c();m();var z=f(A()),St=f(no());v();c();m();var Et=f(V()),Bo=f(no());v();mo();var re=(o,t)=>{let{id:e}=o,n=(0,Et.useDispatch)(),r=E(t?.walletId),a=W(),i=Q(),l=(0,Bo.useMemoizedFn)(async()=>{r({all_confirmation:"cancel",trade:"get_public_key",dapp_url:o?.origin,network:a?.chainName}),await i({id:e}),await B(n)}),{loading:p,onClick:w}=b(l),_={actionType:u.ACTION_TYPE.CANCEL,btnText:s("wallet_dapp_connection_btn_reject"),onClick:w,loading:p},C=et(),y=$(),D=(0,Bo.useMemoizedFn)(async()=>{try{r({all_confirmation:"confirm",trade:"get_public_key",dapp_url:o?.origin,network:a?.chainName});let x=await C(o.msgParams);y({id:e,result:x}),await B(n)}catch(x){console.log(x),y({id:e,error:"Failed"})}}),{loading:M,onClick:I}=b(D),L={actionType:u.ACTION_TYPE.CONFIRM,btnText:s("wallet_dapp_conncetion_btn_provide"),onClick:I,loading:M};return[_,L]},At=re;var ne=({unapproved:o})=>{let t=F(o.origin,o.msgParams),e=At(o,t),n=N(o),r=N(o),a=E(t?.walletId);(0,St.useMount)(()=>{a({all_confirmation:"confirm",trade:"get_public_key",dapp_url:o?.origin})});let i=(0,z.useMemo)(()=>({type:K.TIP_TYPE.NORMAL,message:s("wallet_dapp_conncetion_notify_public_key_notice",{siteName:r.name||r.host})}),[r]);return z.default.createElement(T.Container,null,z.default.createElement(j,{title:s("wallet_dapp_conncetion_notify_public_key_request"),closeable:!1,backable:!1}),z.default.createElement(S,null,z.default.createElement(J,{...n})),z.default.createElement(To,{walletAccount:t,chainId:o.chainId}),z.default.createElement(Z,{placeholder:!0,offsetBottom:0,borderTop:!0},z.default.createElement(K,{...i}),z.default.createElement(u,{buttonGroup:e})))},Nt=ne;var ie=o=>{let{msgParams:{version:t},type:e}=o;return e===q.ETH_GET_ENCRYPTION_PUBLIC_KEY?Nt:e===q.ETH_DECRYPT?bt:e===q.ETH_SIGN_TYPED_DATA&&["V3","V4"].includes(t)?It:dt},ae=(0,ko.memo)(o=>{let{unapproved:t={}}=o,e=ie(t);return ko.default.createElement(e,{unapproved:t})}),xa=ae;c();m();var Dt=f(A());Ot();var se=()=>(0,Dt.useCallback)(async(o,t)=>{await zo().handleErc20Token(o,t)},[]),Ea=se;export{Te as a,Ea as b,F as c,W as d,xa as e};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-UDTBPUPJ.js.map
