import{a as G,b as z}from"./chunk-5CHE7P4E.js";import{a as w}from"./chunk-PD44C7EF.js";import{c as L,d as O}from"./chunk-6K6UF6OE.js";import{b as F,c as D}from"./chunk-OKXHAJNT.js";import{b as N}from"./chunk-67F2WFQO.js";import{d as ie}from"./chunk-QYDRYMWS.js";import{e as M,h as q}from"./chunk-AZNX5TUC.js";import{b as R,c as _}from"./chunk-MONRGJFN.js";import{o as be}from"./chunk-XP3TNE3R.js";import{Kb as ce,jc as ue}from"./chunk-QRHYK2TW.js";import{a as Be}from"./chunk-QO4JMOUQ.js";import{k as se,l as Me}from"./chunk-ZDOH3CEJ.js";import{c as I,e as Se}from"./chunk-AS4Z3FNS.js";import{J as Y,Jb as we,K as ne,L as x,Na as ge,Pd as Ne,Zd as ae,aa as oe,db as g,ia as $,ib as re,oe as Pe,pd as v}from"./chunk-QHXUL3YM.js";import{C as b,I as K,q as te,ra as U}from"./chunk-CYTB2B6Q.js";import{b as k}from"./chunk-OL67KS7C.js";import{f as C,o as l,q as m}from"./chunk-SHG7TIBL.js";l();m();l();m();var le=C(k());var ve=e=>{let[o]=_(R.showNftAmount),t=q(e),n=L(),r=F(),s=D(r);return(0,le.useMemo)(()=>{let{walletAccountsWidthBalance:a}=O({walletAccounts:[t],showNftAmount:o,rpcData:null,selectedCurrency:s,assetsMap:n});return a[0]},[t,o,s,n])},Ie=ve;l();m();var j=C(k()),xe=C(ue());U();l();m();var S=C(k()),h=C(ue()),E=C(be()),X=C(Be());U();l();m();var pe=C(k());l();m();re();var H={},Re=async e=>{let{ethers:o}=await g(),t=new o.JsonRpcProvider(e);return H[e]=t,t},me=async e=>H[e]?H[e]:await Re(e);var P=(e="",o=null)=>{let{extensionConfig:t}=w("rpc_info"),n=o||t;return(0,pe.useCallback)(async()=>{let r=e||n?.rpcUrl;return r?await me(r):{}},[e,n])};l();m();var fe=C(k());function V(e,o,t){let n=fe.default.useRef({});return(!("value"in n.current)||t(n.current.condition,o))&&(n.current.value=e(),n.current.condition=o),n.current.value}re();Pe();Ne();ge();we();$();l();m();$();var Fe=6,de=(e,o=Fe)=>{if(!Number(e))return"0";let t=e?.toString();return(e.split(".")[1]||"")?.length>o?oe(t,o&&Number(o)):t},Ae=(e,o)=>{let{rpcUrl:t,chainId:n,account:r,existAccounts:s,isDeleted:a}=o;return Array.isArray(e)?e.filter(i=>{let c=!0;return n&&(c=c&&i.chainId===n),r&&(c=c&&i.account===r),Array.isArray(s)&&!!s?.length&&(c=c&&s?.includes(i.account)),a!==void 0&&(c=c&&(i.isDeleted||!1)===a),i.address||(c=c&&i.rpcUrl===t),c}):[]},he=(e,o={})=>{let{symbol:t,usdToThisRate:n,chainTokenPrice:r,chainTokenBalance:s}=o;return Array.isArray(e)?e.map(a=>{let i,c,{chainId:u,decimals:d}=a,f=t;a.address?(i=r?.[u]?.[a.address]||0,c=s?.[a.account]?.[u]?.[a.address]||0):(i=r?.[u]?.price||0,c=s?.[a.account]?.[u]?.balance||0);let p=de(c&&ne(c,10**d)),T=de(Y(p,Y(i,n)));return{price:i,balance:p,balanceInt:c,...a,moneySymbol:f,marketValue:T}}):[]};l();m();Me();Se();l();m();U();l();m();var Ce="rpc",B={MANAGE_NET:"manageNet",EVM:"evm"},Te={[B.MANAGE_NET]:"ManageNet",[B.EVM]:"Evm"};var Ee=te((e,o)=>{let t=Te[e];if(!t)throw new Error("rpc type must in maps");if(!(typeof o=="string"&&/^[0-9a-zA-Z]+$/g.test(o)))throw new Error("scope name is invalid");return`${Ce}${t}${o}`}),Pt=Ee(B.MANAGE_NET),ye=Ee(B.EVM),Bt={"MNEMONIC WALLET":"seed_phrase","PRIVATE KEY WALLET":"private_key","MPC WALLET":"mpc","HARDWARE WALLET":"hardware"};var De="Token",Le=ye(De),Oe={chainTokens:[],chainTokenPrice:{},chainTokenBalance:{}},J=e=>e.metamask.rpcEvmChainTokens||[],We=e=>e.metamask.rpcEvmChainTokenBalance||{},Ve=se({name:Le,initialState:Oe,reducers:{}}),{reducer:Ke}=Ve,ke=e=>async()=>{await I().addChainToken(e)},Z=e=>async()=>{await I().updateChainToken(e)},Q=e=>async()=>{await I().updateChainTokenBalance(e)},Ft=Ke;var y=(e,o,t=!0,n=null)=>{let{extensionConfig:r}=w("rpc_info"),s=n||r,{chainId:a,rpcUrl:i}=s,c=(0,h.useSelector)(J),u=(0,h.useSelector)(We),{symbol:d,usdToThisRate:f}=(0,h.useSelector)(ce),p=G(),T=z(void 0,v),W=(0,S.useMemo)(()=>Ae(c,{chainId:a,rpcUrl:i,existAccounts:T,account:t?p:void 0,isDeleted:o?void 0:!1}),[a,p,T,c]);return(0,S.useMemo)(()=>e?W:he(W,{symbol:d,usdToThisRate:f,chainTokenBalance:u}),[d,W,f,u,e])},sn=(e,o,t)=>{let n=y(o,void 0,void 0,t);return(0,S.useMemo)(()=>n.find(r=>r.address===(e||void 0))||{},[e,n])};var Ue=(e,o)=>{let t=P(e,o);return(0,E.useMemoizedFn)(async n=>{let r=await t(),{ethers:s}=await g(),a=new s.Contract(n,X.default,r),i=await a.symbol(),c=(await a.decimals()).toString();return{name:await a.name(),symbol:i,decimals:c}},[t])},Ye=e=>{let o=P(void 0,e),t=N();return(0,E.useMemoizedFn)(async(n,r,s)=>{let a,i=s||await o(),c=r||t;if(!n)a=await i.getBalance(c,"latest"),a=a.toString();else{let{ethers:u}=await g();a=await new u.Contract(n,X.default,i).balanceOf(c),a=a.toString()}return a},[o,t])};var an=()=>{let e=P(),o=(0,h.useDispatch)();return(0,E.useMemoizedFn)(async({chainId:t,injectProvider:n,wallets:r=[]})=>{let s=n||await e(),a=r.map(async i=>{let c=await s.getBalance(i,"latest");c=c.toString(),o(Q({chainId:t,balance:c,account:i}))});await Promise.all(a)})},$e=()=>{let e=(0,h.useDispatch)(),o=N(),t=Ye();return(0,E.useMemoizedFn)(async({chainId:n,address:r,injectAccount:s,injectProvider:a})=>{let i=await t(r,s,a);return e(Q({chainId:n,balance:i,address:r,account:s||o})),!0},[t,o])},cn=e=>{let o=N(),{extensionConfig:t}=w("rpc_info"),n=e||t,{chainId:r}=n,s=y(!0,!1,!1,e);return V(()=>({chainId:r,chainTokens:s}),{chainId:r,account:o,needPollChainTokens:s},(a,i)=>!K(a,i))},qe=18,Ge=()=>{let e=(0,h.useDispatch)(),o=(0,h.useSelector)(J),t=N();return(0,E.useMemoizedFn)((n,r,s)=>{if(!n&&!t&&!s?.account)return!1;let{rpcUrl:a}=s,i=o.find(u=>{let d=u.chainId===n&&u.address===r&&u.account===(s?.account||t);return r||(d=d&&u.rpcUrl===a),d});if(i){if(i.isDeleted===!0){let u={...i,...s,chainId:n,address:r,isDeleted:!1};return e(Z(u)),!0}return!1}let c={chainId:n,address:r,isDeleted:!1,account:t,decimals:qe};return s&&typeof s=="object"&&Object.assign(c,s),e(ke(c)),!0},[o,t])},un=e=>{let o=P(e),t=Ge(),n=Ue(e),r=$e();return async(s,a)=>{let i=await n(a);if(t(s,a,i)){let u=await o();await r(s,a,u)}}},ze=(e={})=>{let o=M(e);return V(()=>o.reduce((t,n)=>{if(n.keyringIdentityType===ae.MNEMONIC)t.push(n);else{let r=n.walletIdentities.filter(s=>Boolean(s.account[v]));r.length&&t.push({...n,walletIdentities:r})}return t},[]),o,(t,n)=>!K(t,n))},ln=(e={})=>{let o=ze(e),t=y(!1,!1,!1);return(0,S.useMemo)(()=>{let n=b(t||[],"account");return o?.map(r=>{let s="",a=r.walletIdentities?.map(c=>{let u=c?.account?.[v],{balance:d,symbol:f}=n[u]?.filter(({address:p})=>!p)[0]||{};return s=f,{...c,balance:d,symbol:f}}),i=a.reduce((c,u)=>x(c,u.balance),0);return{...r,marketValue:i,marketValueSymbol:s,walletIdentities:a}})||[]},[t,o])},mn=()=>{let e=(0,h.useDispatch)(),o=y(!0,!1,!1);return t=>{o?.filter(({chainId:n,rpcUrl:r,address:s})=>!s&&n===t.chainId&&r===t.rpcUrl)?.forEach(({chainId:n,account:r})=>{e(Z({chainId:n,account:r,...t}))})}};$();var He=e=>{let o=M(e),[t]=_(R.showNftAmount),n=F(),r=D(n),{isRpcMode:s}=(0,xe.useSelector)(ie),a=y(!1,!1,!1),i=b(a||[],"account"),c=L(),u=(0,j.useMemo)(()=>o.map(f=>{let{walletIdentities:p}=f,{walletAccountsWidthBalance:T,walletAsset:W,platformAsset:ee}=O({walletAccounts:p,showNftAmount:t,rpcData:s?{chainTokensAccountMap:i}:null,selectedCurrency:r,assetsMap:c});return{...f,walletAsset:W,platformAsset:ee,walletIdentities:T}}),[o,t,i,s,r,c]);return[(0,j.useMemo)(()=>u?.reduce((f,p)=>({walletAsset:x(f.walletAsset,p.walletAsset==="--"?"0":p.walletAsset),platformAsset:x(f.platformAsset,p.platformAsset==="--"?"0":p.platformAsset),rpcModeCoinSymbol:f.rpcModeCoinSymbol||p?.rpcModeCoinSymbol}),{walletAsset:"0",platformAsset:"0",rpcModeCoinSymbol:""}),[u]),u]},Je=He;export{Re as a,me as b,Pt as c,ye as d,Bt as e,Le as f,J as g,Z as h,Q as i,Ft as j,Ie as k,P as l,V as m,y as n,sn as o,Ue as p,Ye as q,an as r,$e as s,cn as t,Ge as u,un as v,ze as w,ln as x,mn as y,Je as z};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=chunk-KDVER5QK.js.map
