import{b as Ut}from"./chunk-A52G67PA.js";import{c as Re}from"./chunk-GHMG2Y4A.js";import{a as Le,b as qe}from"./chunk-Q4BJZ4WV.js";import{a as Oe}from"./chunk-CK7Z2DAQ.js";import{a as Me}from"./chunk-V2QGBG3D.js";import{a as Pe}from"./chunk-IFQLVQH6.js";import"./chunk-5TLDWKXV.js";import{a as at}from"./chunk-7GRDW7ZD.js";import{a as k,d as P}from"./chunk-7X4DXTSI.js";import{a as it}from"./chunk-CIEH2J25.js";import{a as Ne,b as kt}from"./chunk-64LKONIY.js";import{l as M}from"./chunk-NKIUEXOA.js";import"./chunk-EP23RRSK.js";import"./chunk-CGFS6AE4.js";import"./chunk-DDT324RS.js";import"./chunk-2TQXMDYZ.js";import"./chunk-RNMISV22.js";import"./chunk-A267SEFJ.js";import"./chunk-VR7OPIR6.js";import{a as be,b as We}from"./chunk-U2LZ7AZA.js";import{a as ve,c as Et,d as De}from"./chunk-7A4GWZDF.js";import"./chunk-HBWTVKRO.js";import"./chunk-ZPQXBUKT.js";import{e as xe}from"./chunk-35Y7QMWN.js";import"./chunk-VIT5MDY4.js";import{a as Ie}from"./chunk-RH6WPBEZ.js";import"./chunk-CDNJY7Z3.js";import"./chunk-DBWXHHZT.js";import"./chunk-VVKAQ7K5.js";import"./chunk-7JSJY3SQ.js";import"./chunk-NWY3GPDX.js";import"./chunk-6JEFG7DQ.js";import"./chunk-B6YXJZUF.js";import"./chunk-4I2JSOYJ.js";import"./chunk-GTN3RCGH.js";import"./chunk-3VKPY2QL.js";import"./chunk-AOSRFQ4E.js";import"./chunk-ULL77AIR.js";import"./chunk-PJYSMRRW.js";import"./chunk-GKQQDLVP.js";import"./chunk-7YKP5374.js";import"./chunk-KGG7DXMS.js";import"./chunk-FGIHS4ZF.js";import"./chunk-U65R4NF3.js";import"./chunk-OTUJWRS5.js";import"./chunk-WIW5JVRP.js";import"./chunk-7CXUJS4C.js";import"./chunk-ULXZERAJ.js";import"./chunk-PJ5X5CUU.js";import"./chunk-TSVRDRPO.js";import"./chunk-PPTAKQQT.js";import"./chunk-IFQDHP3Z.js";import"./chunk-DA5RJYYW.js";import"./chunk-HUC3JPS2.js";import"./chunk-MYNDXPHU.js";import"./chunk-ZTIVM5ML.js";import"./chunk-2E2OBQTS.js";import"./chunk-VICEBZ4G.js";import"./chunk-WO6OHGU2.js";import"./chunk-3S4BGA37.js";import"./chunk-POP3LIKS.js";import"./chunk-PMRTKWFS.js";import"./chunk-G44PPNNQ.js";import"./chunk-K2BSCLBF.js";import"./chunk-PZY7HRHV.js";import"./chunk-Z2L2F5M5.js";import"./chunk-IPLOJJIA.js";import"./chunk-RLPRDJ34.js";import"./chunk-2ASICJQL.js";import"./chunk-TQWSBAXG.js";import"./chunk-6JVCYB7O.js";import"./chunk-GR42TVIZ.js";import"./chunk-QMSSDBOR.js";import{b as Bt}from"./chunk-B3SXRDEQ.js";import{a as Ce,b as he}from"./chunk-7HRNNJBX.js";import{c as Te}from"./chunk-F6UVHIJV.js";import"./chunk-5TNLDTW5.js";import"./chunk-34JXWTF5.js";import"./chunk-JSOLAK4X.js";import{e as S,g as yt}from"./chunk-R7LZSAVU.js";import"./chunk-LTLRDXME.js";import"./chunk-RMI6BAM3.js";import"./chunk-AADHEW4J.js";import"./chunk-OK4242CI.js";import"./chunk-6MVL4I6V.js";import"./chunk-E7MGN3V4.js";import"./chunk-YGIVEMKT.js";import"./chunk-T4RFDN7D.js";import{L as pe,b as me}from"./chunk-NQAVUB4Q.js";import"./chunk-IEGAVAV7.js";import"./chunk-V4P2E4SN.js";import"./chunk-DYL77QBO.js";import"./chunk-5A3RJQCM.js";import"./chunk-MN3UHDTX.js";import"./chunk-IJW6HFV5.js";import"./chunk-N2MMFEEK.js";import{i as we}from"./chunk-MKDQBVRZ.js";import"./chunk-DA2FCNEZ.js";import"./chunk-TLZRRG7J.js";import"./chunk-ZFFAX2YS.js";import"./chunk-7UDMBSMI.js";import"./chunk-KJWX5V23.js";import"./chunk-KDVER5QK.js";import"./chunk-5CHE7P4E.js";import"./chunk-PD44C7EF.js";import"./chunk-6K6UF6OE.js";import"./chunk-OKXHAJNT.js";import"./chunk-CBHKW7LL.js";import"./chunk-67F2WFQO.js";import"./chunk-QYDRYMWS.js";import{e as Ae,g as St,i as Se}from"./chunk-AZNX5TUC.js";import"./chunk-JU4HVVJ2.js";import"./chunk-NKWTNXAD.js";import"./chunk-XZE3C5KK.js";import"./chunk-XZE3L7K7.js";import{h as ue}from"./chunk-QTKQMZ5K.js";import{a as Ee}from"./chunk-Y5K5NJ6U.js";import"./chunk-JABAEAEN.js";import"./chunk-VY2VK2OT.js";import{a as ye}from"./chunk-Q7FGM7BT.js";import"./chunk-TKE74ERX.js";import"./chunk-MONRGJFN.js";import"./chunk-RYT7JDQV.js";import"./chunk-CZZFLX67.js";import"./chunk-IK72BO4I.js";import{a as Rt,b as de,i as b,ib as _e,k as B}from"./chunk-QMENNGDH.js";import"./chunk-KANXVZ35.js";import"./chunk-WGVA2GGS.js";import"./chunk-APGT6UVG.js";import"./chunk-V34MB2FG.js";import{o as wt}from"./chunk-XP3TNE3R.js";import{Bb as ae,Rb as ce,Wa as ie,jc as x,zb as j}from"./chunk-QRHYK2TW.js";import"./chunk-PODZSVO7.js";import"./chunk-QO4JMOUQ.js";import"./chunk-7N263AYH.js";import{a as At}from"./chunk-532YJKK4.js";import{j as R,n as le,p as ht}from"./chunk-Q4YLD24R.js";import"./chunk-K5ZGZULR.js";import"./chunk-M6J3OOFH.js";import{s as Ct,u as qo}from"./chunk-ZDOH3CEJ.js";import{c as nt,e as se}from"./chunk-AS4Z3FNS.js";import"./chunk-KW2XDOEY.js";import"./chunk-2FDQIA7D.js";import"./chunk-L524QXHA.js";import"./chunk-ZFTHPYIG.js";import"./chunk-N6DAHVYW.js";import{f as fe}from"./chunk-YCFHPQAJ.js";import{B as ne}from"./chunk-4EIUGT5A.js";import"./chunk-7FRDKLRJ.js";import"./chunk-P7VKC6DQ.js";import"./chunk-D7FW64MN.js";import"./chunk-6ZZOO2CD.js";import"./chunk-JPTLCZ2Y.js";import"./chunk-COS5CL3D.js";import"./chunk-VL2YBSHB.js";import{d as ge}from"./chunk-AVC4ODUV.js";import"./chunk-RJ3YTAFM.js";import"./chunk-OCAFSBNZ.js";import{c as st}from"./chunk-62ZAND24.js";import{a as Ro}from"./chunk-SIITVWZR.js";import{Bb as Xt,Ec as q,I as vo,Jb as Lo,Oa as zt,Qb as Jt,S as _t,Yd as ee,Zd as oe,ad as Tt,cc as Zt,ec as Qt,fc as te,ia as Vt,la as gt,od as rt,oe as re,ra as Do,u as dt}from"./chunk-QHXUL3YM.js";import{H as L,y as _}from"./chunk-MOTAOJVG.js";import"./chunk-FYTT4U7M.js";import{H as Kt,d as jt,f as Ht}from"./chunk-XR4SQWL7.js";import"./chunk-NCGYY6X6.js";import"./chunk-LMBQGBLO.js";import"./chunk-QWIXUG3W.js";import"./chunk-Z3JMRMVO.js";import{L as ft,f as ut,ra as Lt}from"./chunk-CYTB2B6Q.js";import"./chunk-CAFKDDXA.js";import"./chunk-CTOTVO2J.js";import"./chunk-T2ETCKOI.js";import"./chunk-6P63CWAB.js";import"./chunk-RJPAKY6O.js";import"./chunk-ZCK5UHUS.js";import"./chunk-ANUO2YYF.js";import{fa as qt}from"./chunk-6M3PZK2X.js";import"./chunk-TPIKSUHH.js";import{b as w}from"./chunk-OL67KS7C.js";import"./chunk-TVBFJITU.js";import"./chunk-D2YP6KBJ.js";import"./chunk-2EEW2VNF.js";import"./chunk-TLR6EQX6.js";import"./chunk-S5ACFHVS.js";import"./chunk-FQLRWF7X.js";import"./chunk-NLMDM2WF.js";import"./chunk-BJAL3374.js";import"./chunk-KDUIZVRC.js";import"./chunk-VYKQ62AB.js";import"./chunk-263G66VF.js";import"./chunk-SUANL2KV.js";import"./chunk-KTFU3F6C.js";import"./chunk-2OVRHWIW.js";import"./chunk-32ZJ4F2J.js";import"./chunk-WIP2REO7.js";import"./chunk-JBHIVXO6.js";import"./chunk-LECESFCD.js";import"./chunk-NW4HKKTQ.js";import"./chunk-EBMX24YQ.js";import"./chunk-3C4MEE67.js";import"./chunk-R4BHRBC7.js";import{f as p,n as process,o as e,q as o}from"./chunk-SHG7TIBL.js";e();o();var v=p(w()),tt=p(x()),D=p(At()),Po=p(wt());ht();Do();vo();e();o();var Be=p(w()),ke=(0,Be.lazy)(()=>import("./Comp-OUMSRUMU.js"));e();o();var W=p(w());te();e();o();var Xe=p(w());zt();e();o();var N=p(w()),$e=p(x()),Fe=p(At());L();re();e();o();var E=p(w()),Ue=p(At());Lt();L();te();zt();e();o();var It={root:"_root_oli0p_1",multiAccount:"_multiAccount_oli0p_4",count:"_count_oli0p_9"};var ko="account-selector",Uo=t=>{let r=(0,Ue.useHistory)(),{permissionsRequestId:n,request:s,dappSelectAccount:a,walletInfo:i={},connectable:c=!0,hiddenAddress:m=!1,disableSelectAccount:f=!1}=t,{method:d,provider:g,status:T}=Et({dappUrl:s?.metadata?.origin}),l=()=>{r.push({pathname:`${b}/${n}${B}`})},h=(0,E.useMemo)(()=>m?"":s?.providerType===Jt?_("wallet_extension_cosmos_text_cosmos_network"):i.address,[m,s?.providerType,i.address]),C=ve({provider:g,method:d}),A=()=>a.length<=1?C?E.default.createElement(k,{bordered:!1},E.default.createElement(kt,{onClick:f?void 0:ut,hiddenAddress:m,copyable:!1,title:_("wallet_dapp_conncetion_requesr_subtitle_current_account"),walletId:i.walletId,address:_("wallet_extension_expand_all_networks"),show7702Tag:!0})):E.default.createElement(k,{bordered:!1},E.default.createElement(kt,{onClick:f?void 0:ut,copyable:!1,title:_("wallet_dapp_conncetion_requesr_subtitle_current_account"),walletId:i.walletId,address:h,hiddenAddress:m,connectable:c,show7702Tag:!0})):E.default.createElement(k,{bordered:!1},E.default.createElement(Ne,{title:_("wallet_dapp_conncetion_requesr_subtitle_current_account")},E.default.createElement(st.Box,{className:It.multiAccount},E.default.createElement(st.Box,{className:It.count},_("wallet_extension_mid_text_accounts",{num:a.length})),E.default.createElement(Ut,{className:`${ko}__info-arrow`,side:Ut.SIDE.RIGHT}))));return E.default.createElement("div",{className:It.root,onClick:f?ut:l},T!=="PENDING"&&A())},Ge=Uo;function Go({targetDomainMetadata:t,permissionsRequestId:r,request:n,walletInfo:s,connectable:a,tipMessage:i,buttonGroup:c,hiddenAddress:m,disableSelectAccount:f,RequestedNetworks:d,children:g,title:T}){let l=(0,Fe.useHistory)(),h=(0,$e.useSelector)(S),C=Ae();return N.default.createElement(st.Container,null,N.default.createElement(Ee,{backable:!1,closeable:!1,title:T??_("wallet_dapp_conncetion_maintitle_conncet_account")}),N.default.createElement(k,null,N.default.createElement(Oe,{...t})),N.default.createElement(Ge,{targetDomainMetadata:t,permissionsRequestId:r,request:n,dappSelectAccount:h,walletInfo:s,disableSelectAccount:f,hiddenAddress:m,connectable:a}),d&&N.default.createElement(d,{request:n}),g,N.default.createElement(ye,{placeholder:!0,offsetBottom:0,borderTop:!0},N.default.createElement(P,{...i}),N.default.createElement(M,{buttonGroup:c})),s?.keyringIdentityType===oe.MPC&&N.default.createElement(Le,{keyringId:s.keyringId,customConfig:C?.length===1?{confirmText:_("wallet_extension_btn_general_gotit")}:{},actionMap:{["RECOVER"]:()=>{l.push(`${_e}?action=${Ie.RECOVER}&walletId=${s.walletId}`)},["SWITCH_WALLET"]:async()=>C?.length===1?(await c[0]?.onClick(),l.push(de)):l.push({pathname:`${b}/${r}${B}`})}}))}var H=Go;e();o();var Ye=p(x());function $o(t){let r=St(),s=(0,Ye.useSelector)(S)[0]||r,{walletInfo:a,connectable:i,chainName:c,status:m}=De({dappUrl:t,walletId:s}),f=qe(s);return{targetWalletId:s,walletInfo:a,connectable:i,chainName:c,mpcConnectable:f,status:m}}var K=$o;e();o();var z=p(x()),Ve=p(At()),Gt=p(wt());L();ht();function $t({disabled:t,request:r,targetDomainMetadata:n,cancelPermissionsRequest:s,approvePermissionsRequest:a,connectSource:i,connectChains:c}){let m=(0,z.useDispatch)(),f=n?.origin,d=at(),g=(0,z.useSelector)(S),T=Et({dappUrl:f});return async()=>{if(t)return;d({trade:"connect_wallet",all_confirmation:"confirm"});let h={...r,permissions:{...r.permissions}};if(Object.keys(h.permissions).length>0){if(await a(h,g),g.length===1&&await m(ue(g[0],!0)),pe({dapp_url:f}),T?.dappUrl&&T?.provider){let C={dappurl:T.dappUrl,connect_method:i||T.provider,dappname:n?.name,full_url:n?.url,version:process.env.APP_VERSION};c&&(C.chain=c),me(C)}}else await s(h.metadata.id);await R(m)}}var Fo=({props:t,isMpcError:r,connectable:n,confirmBtnText:s,onConfirm:a,onCancel:i,connectSource:c,connectChains:m,disabledConfirmBtn:f=!1})=>{let d=(0,z.useDispatch)(),g=(0,Ve.useHistory)(),T=(0,z.useSelector)(S),{permissionsRequestId:l,targetDomainMetadata:h,cancelPermissionsRequest:C,approvePermissionsRequest:A,request:U}=t,G=at(),I=(0,Gt.useMemoizedFn)(async()=>{G({trade:"connect_wallet",all_confirmation:"cancel"}),i?await i(l):await C(l),await R(d)}),{loading:et,onClick:ot}=it(I),Y={actionType:M.ACTION_TYPE.CANCEL,onClick:ot,loading:et},$=$t({request:U,targetDomainMetadata:h,approvePermissionsRequest:A,cancelPermissionsRequest:C,connectSource:c,connectChains:m}),V=(0,Gt.useMemoizedFn)(async()=>{n?a?await a():await $():g.push({pathname:`${b}/${l}${B}`})}),{loading:vt,onClick:lt}=it(V),Dt={actionType:M.ACTION_TYPE.CONFIRM,disabled:f||n&&(T.length===0||r),btnText:n?s||_("wallet_extension_connect_btn_connect"):_("wallet_extension_connect_btn_switch_wallet"),onClick:lt,loading:vt};return[Y,Dt]},X=Fo;e();o();var je=p(w());var xt=p(x());function Yo(t,r){let n=(0,xt.useDispatch)(),s=(0,xt.useSelector)(S),{connectable:a,mpcConnectable:i}=t;(0,je.useEffect)(()=>{if(!s.length&&a&&i&&r){let c=Array.isArray(r)?r:[r];n(yt.setSelectAccounts(c))}},[s,a,i,r])}var J=Yo;e();o();var He=p(w());L();function Vo({isMpcError:t,connectable:r,chainName:n}){return(0,He.useMemo)(()=>t?{type:P.TIP_TYPE.COMMON_ERROR,message:_("extension_wallet_error_toast_not_supported")}:r?{type:P.TIP_TYPE.NORMAL,message:_("wallet_dapp_conncetion_notify_conncet_permission")}:{type:P.TIP_TYPE.COMMON_WARN,message:_("wallet_extension_connect_alert_text_doesnt_support_network",{network:n})},[t,r,n])}var Nt=Vo;e();o();var ze=p(w()),Ft=p(x());re();e();o();var Mt=p(w());var Ke=(t,r)=>{let[n,s]=(0,Mt.useState)(!1);return(0,Mt.useEffect)(()=>{(async()=>{if(t&&r){let{data:a}=await xe({dappUrl:t});s(a.result)}})()},[t,r]),n};function jo(t){let r=(0,Ft.useSelector)(S),n=(0,Ft.useSelector)(ae),s=(0,ze.useMemo)(()=>r.some(i=>n.find(c=>c.walletId===i)?.initialType===ee.MPC_KEYRING),[r,n]),a=Ke(t?.host,s);return s&&!a}var Z=jo;function Ho(t){let{targetDomainMetadata:r,permissionsRequestId:n,request:s}=t,a=St(),i=K(r?.origin),{walletInfo:c,connectable:m,chainName:f,status:d}=i,g=Z(r),T=Nt({isMpcError:g,connectable:m,chainName:f}),l=X({props:t,isMpcError:g,connectable:m});return J(i,a),d==="PENDING"?null:Xe.default.createElement(H,{targetDomainMetadata:r,permissionsRequestId:n,request:s,walletInfo:c,connectable:m,tipMessage:T,buttonGroup:l})}var Je=Ho;e();o();var eo=p(w()),oo=p(x());rt();e();o();Lt();rt();Vt();var Ko=({props:t,isMpcError:r,connectable:n,walletInfo:s={},nearAmount:a})=>{let{walletId:i,address:c}=s,m=X({props:t,isMpcError:r,connectable:n});return!ft(a)&&_t(a,0)&&(m[1]={actionType:M.ACTION_TYPE.FILL_UP,coinId:Tt,walletId:i,address:c,receiveOnly:!0}),m},Ze=Ko;e();o();var Qe=p(w());Lt();L();Vt();function zo({nearAmount:t,isMpcError:r,connectable:n,chainName:s}){return(0,Qe.useMemo)(()=>!ft(t)&&_t(t,0)?{type:jt.TYPE.warn,message:_("wallet_extension_conncetion_alert_add_more")}:r?{type:P.TIP_TYPE.COMMON_ERROR,message:_("extension_wallet_error_toast_not_supported")}:n?{type:P.TIP_TYPE.NORMAL,message:_("wallet_extension_conncetion_alert_check_balance")}:{type:P.TIP_TYPE.COMMON_WARN,message:_("wallet_extension_connect_alert_text_doesnt_support_network",{network:s})},[t,r,n,s])}var to=zo;var Xo=t=>{let{targetDomainMetadata:r,permissionsRequestId:n,request:s}=t,a=(0,oo.useSelector)(j),i=K(r?.origin),{walletInfo:c,connectable:m,chainName:f,targetWalletId:d}=i,g=Z(r),T=Me(Tt,d)?.coinAmountInt,l=to({targetWalletId:d,isMpcError:g,connectable:m,chainName:f,nearAmount:T}),h=Ze({props:t,isMpcError:g,connectable:m,walletInfo:c,nearAmount:T});return J(i,a),eo.default.createElement(H,{targetDomainMetadata:r,permissionsRequestId:n,request:s,walletInfo:c,connectable:m,tipMessage:l,buttonGroup:h})},ro=Xo;e();o();e();o();var Jo=()=>null,no=Jo;var so=no;e();o();var pt=p(w());L();e();o();var ct=p(w()),ao=p(Ro());e();o();var io={item:"_item_11fx7_1"};function Zo({className:t,message:r}){return ct.default.createElement(ct.default.Fragment,null,ct.default.createElement(k,{bordered:!1,className:(0,ao.default)(io.item,t)},ct.default.createElement(Pe,{message:r})))}var co=Zo;e();o();var go=p(w());L();se();rt();qo();e();o();var mo=p(x()),po=p(wt());ht();function Qo({disabledSubmit:t,confirmBtnLoading:r,permissionsRequestId:n,cancelPermissionsRequest:s,request:a,targetDomainMetadata:i,approvePermissionsRequest:c}){let m=(0,mo.useDispatch)(),f=at(),d=(0,po.useMemoizedFn)(async()=>{f({trade:"connect_wallet",all_confirmation:"cancel"}),await s(n),await R(m)}),{loading:g,onClick:T}=it(d),l={loading:g,actionType:M.ACTION_TYPE.CANCEL,onClick:T},h=$t({request:a,targetDomainMetadata:i,approvePermissionsRequest:c,cancelPermissionsRequest:s}),C={loading:r,disabled:t,actionType:M.ACTION_TYPE.CONFIRM,onClick:h};return[l,C]}var lo=Qo;e();o();var Pt=p(w()),uo=p(wt());rt();Lo();function tr(t,r){let n=(0,Pt.useRef)(r?.origin),a=(t?.providersExts?.[q]??t?.exts)?.message?.manifestUrl,[i,c]=(0,Pt.useState)(!0);return(0,uo.useMount)(()=>{(async()=>{if(a)try{let f=await Xt(a);if(f?.status===200){let d=f.data;typeof d?.url=="string"&&(n.current=d.url)}}finally{c(!1)}else c(!1)})()}),{loading:i,domain:n.current}}var fo=tr;e();o();var bt=p(w()),Ot=p(x());function er(t){let r=(0,Ot.useSelector)(j),n=(0,Ot.useSelector)(S),s=(0,Ot.useSelector)(c=>we(c,t?.origin)),[a,i]=(0,bt.useState)(null);return(0,bt.useEffect)(()=>{(async()=>{r&&n.includes(r)?i(r):s&&n.includes(s)?i(s):i(n[0])})()},[r,n,s]),a}var _o=er;var or=({request:t,targetDomainMetadata:r,permissionsRequestId:n,approvePermissionsRequest:s,cancelPermissionsRequest:a,isSilentConnected:i})=>{let c=_o(r),{loading:m,domain:f}=fo(t,r),d=Se(c,q),l=((t?.providersExts?.[q]??t?.exts)?.message?.items||[]).filter(({name:A})=>A===ie.TON_PROOF),h=l.length===1?`${l[0].payload||""}`:l.map(({payload:A})=>({value:A}));(0,go.useEffect)(()=>{Ct("Sign Ton Proof UI",{tonAddress:d})},[d]);let C=lo({disabledSubmit:m,permissionsRequestId:n,request:t,targetDomainMetadata:r,approvePermissionsRequest:async(A,U,G)=>{try{let I=Math.round(Date.now()/1e3),et=new URL(f).host,ot=await Promise.all(l.map(async({payload:Y})=>{let $;try{Ct("Call Sign Ton Proof",{tonAddress:d}),$=await nt().signTonProof({proof:{timestamp:I,domain:et,payload:Y}},d,c)}catch(V){throw Ct("Error Sign Ton Proof",{tonAddress:d,isReject:V?.message===ne}),V}return{payload:Y,signature:$}}));A.resultParams={domain:f,timestamp:I,signatures:ot}}catch{return Kt.error({title:_("wallet_extension_ton_error_signature_support")}),null}return s(A,U,G,!i)},cancelPermissionsRequest:a});return{tonProofs:l,message:h,buttonGroup:C}},To=or;e();o();var mt=p(w()),Co=p(x());se();rt();function rr({targetDomainMetadata:t,dappMetadata:r,alwaysNeedProof:n}){let s=(0,Co.useSelector)(j),[a,i]=(0,mt.useState)(null),[c,m]=(0,mt.useState)(!0);return(0,mt.useEffect)(()=>{(async()=>{if(!n){m(!1);return}try{(await nt().getPermittedWallets(t?.origin,q,!1)).length>0&&i(await nt().getPermittedWallets(t?.origin,q,!0))}finally{m(!1)}})()},[n]),J(r,c?null:a||s),{loading:c,isSilentConnected:!!a}}var ho=rr;e();o();var wo={loading:"_loading_po7pc_1"};function nr(t){let{alwaysNeedProof:r,targetDomainMetadata:n,permissionsRequestId:s,request:a}=t,i=K(n?.origin),{walletInfo:c,connectable:m,chainName:f}=i,d=Z(n),g=Nt({isMpcError:d,connectable:m,chainName:f}),T={props:t,isMpcError:d,connectable:m,connectSource:a?.exts?.connectSource},l=X(T),{loading:h,isSilentConnected:C}=ho({targetDomainMetadata:n,dappMetadata:i,alwaysNeedProof:r}),{tonProofs:A,message:U,buttonGroup:G}=To({...t,isSilentConnected:C}),I=A?.length>0;return h?pt.default.createElement("div",{className:wo.loading},pt.default.createElement(qt.Circle,{size:qt.SIZE.lg})):pt.default.createElement(H,{targetDomainMetadata:{...n,host:n.origin||n.host},permissionsRequestId:s,request:a,walletInfo:c,connectable:m,tipMessage:g,buttonGroup:I?G:l,title:I?_("wallet_extension_header_connect_sign"):void 0},pt.default.createElement(co,{message:U}))}var yo=nr;e();o();e();o();var sr=()=>null,Ao=sr;var So=Ao;e();o();var Q=p(w());L();e();o();var Wt={root:"_root_h6iyb_1",animation:"_animation_h6iyb_14",text:"_text_h6iyb_17"};var ir=({onComplete:t})=>{let[r,n]=(0,Q.useState)(!1),s=ge({dark:"/static/images/dapp/success-dark.json",light:"/static/images/dapp/success-light.json"});return Q.default.createElement("div",{className:Wt.root},Q.default.createElement(Ht,{className:Wt.animation,path:s,loop:!1,onDataReady:()=>{n(!0)},onComplete:t}),r?Q.default.createElement("span",{className:Wt.text},_("wallet_home_foot_dapp_connceted")):null)},Eo=ir;var Io=({chooseAccountProps:t,showAni:r})=>{let n=t?.request?.providerTypes,s=t?.request?.providersExts,a=t?.request?.exts?.alwaysNeedProof,i=t?.request?.providerType,c=!!n,m=t?.request?.exts?.isShowWalletConnect;return W.default.createElement(W.default.Fragment,null,(()=>{switch(!0){case m:return W.default.createElement(So,{providerTypes:n,providersExts:s,...t});case c:return W.default.createElement(so,{providerTypes:n,providersExts:s,...t});case(i===Zt&&a):return W.default.createElement(ro,{...t});case i===Qt:return W.default.createElement(yo,{alwaysNeedProof:a,...t});default:return W.default.createElement(Je,{...t})}})(),r&&W.default.createElement(Eo,{onComplete:()=>{t?.onComplete()}}))};e();o();e();o();var xo=p(x());ht();function No(){let t=(0,xo.useDispatch)();return()=>t(le())}var Mo=No;e();o();var ar=({environmentType:t,history:r})=>{t!==dt&&r.push(Rt)},oc=()=>{let t=(0,tt.useDispatch)(),r=(0,D.useHistory)(),s=(0,D.useRouteMatch)().params.id,i=(0,tt.useSelector)(Te).find(y=>y.metadata.id===s),c=i?.providerTypes,[m,f]=(0,v.useState)(!1),d=(0,tt.useSelector)(he),g=(0,tt.useSelector)(ce),{metadata:T={}}=i||{},{origin:l,url:h}=T,C=null;if(l)if(g[l])C={...g[l],origin:l,url:h},C.icon??=fe;else{let y=new URL(l);C={host:y.host,name:y.hostname,origin:l,url:h}}let A=`${b}/${s}`,U=`${b}/${s}${B}`,G=async(y,O,F)=>{await t(be(y,O,F))},I=async(y,O,F)=>{await t(We(y,O,F)),await t(Bt())},et=()=>t(Re()),ot=Mo(),Y=()=>t(yt.setSelectAccounts([])),$=()=>{s&&d===Ce.connect&&I(s,l)},V=()=>{gt()===dt&&window.addEventListener("beforeunload",$)},vt=()=>{gt()===dt&&window.removeEventListener("beforeunload",$)},lt=()=>{vt();let y=gt();return ar({environmentType:y,history:r}),null},Dt=async(y,O)=>{y&&(await I(y,l,O),await R(t),lt())},Yt=()=>{f(!1),lt(),t(Bt())};(0,Po.useMount)(()=>{if(ot(),et(),!i){r.push(Rt);return}V(),Y()});let Oo=c;return v.default.createElement("div",{className:"page-container permissions-connect"},v.default.createElement(D.Switch,null,v.default.createElement(D.Route,{path:U,exact:!0,render:()=>v.default.createElement(ke,{request:i||{},multi:!Oo})}),v.default.createElement(D.Route,{path:A,exact:!0,render:()=>v.default.createElement(Io,{chooseAccountProps:{request:i||{},cancelPermissionsRequest:(O,F)=>Dt(O,F),permissionsRequestId:s,targetDomainMetadata:C,onComplete:Yt,approvePermissionsRequest:async(O,F,bo,Wo=!0)=>{await G(O,F,bo),await R(t),Wo?f(!0):Yt()}},showAni:m})})))};export{oc as default};

window.inOKXExtension = true;
window.inMiniApp = false;
window.ASSETS_BUILD_TYPE = "publish";

//# sourceMappingURL=PermissionsConnect-Y5EZ3KLU.js.map
